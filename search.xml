<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>éšç¬”</title>
    <url>/2019-12-28/</url>
    <content><![CDATA[<p>åˆšè€ƒç ”ç»“æŸï¼Œå…¶ä»–ä¸‰é—¨è¿˜è¡Œï¼Œæ•°å­¦æ„Ÿè§‰è¦ç‚¸äº†ã€‚</p>
<p>æ¯•è®¾ä¹Ÿæ‡’å¾—åšï¼ŒæŠŠä»¥å‰çš„ç½‘ç«™é‡æ–°æ­å»ºèµ·æ¥ï¼Œç°åœ¨å·®ä¸å¤šå°±è¿™æ ·å§ã€‚</p>
<p>è€ƒç ”ç»“æŸçœŸè§‰å¾—æ˜¯ä¸ªåºŸäººäº†ã€‚</p>
<p>æœ€ååç­‰Switchåˆ°ã€‚</p>
]]></content>
      <categories>
        <category>éšç¬”</category>
      </categories>
  </entry>
  <entry>
    <title>éšç¬”</title>
    <url>/2019-12-29/</url>
    <content><![CDATA[<p>ä»Šå¤©åˆèµ–åºŠåˆ°10ç‚¹äº†ï¼Œemmmã€‚</p>
<p>èµ·æ¥çœ‹ä¸€ä¼šè§†é¢‘ï¼Œåƒä¸ªé¥­å»æ‹¿é£æ‰‡å’Œæˆ‘ç­‰äº†ä¸ƒå¤©çš„switchï¼Œå¼€å¿ƒğŸ˜Šã€‚</p>
<p>é£æ‰‡è¿™ä¸œè¥¿ï¼Œå¥½åƒæ˜¯æˆ‘è¿™å°ç”µè„‘çš„é€šç—…ï¼Œæ€»æ˜¯åœ¨é—­åˆæƒ…å†µä¸‹æ‰“å¼€ç”µè„‘æ—¶ï¼Œé£æ‰‡æ€»ä¼šå‘å‡ºé—´æ–­æ€§çš„å™ªå£°ï¼Œæœ¬æ¥ä»¥ä¸ºæˆ‘æ˜¯ä»¥ä¸ºæ˜¯é£æ‰‡èƒ½å¤Ÿæ£€æµ‹å¤–ä¾§éœ‡åŠ¨ï¼Œä»è€Œä¿æŠ¤è‡ªå·±çš„ä¸€ç§æªæ–½ï¼Œæ²¡æƒ³è¿™ç©æ„å¤±æ§ï¼Œå™ªå£°ç›¸å½“éš¾å¿å—ã€‚</p>
<p>æ‹†æœºå›¾:<br><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/2019-12-29-mi-pro.jpg" alt=""></p>
<p>é£æ‰‡ï¼š<br><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/2019-12-29-fan.jpg" alt=""></p>
<p>switchåˆ°äº†ï¼Œç­‰å¾…æ›´æ–°ä¸­ï¼š<br><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/2019-12-29-switch.jpg" alt=""></p>
<p>è¿™æ˜¯æˆ‘æ˜¯PDDï¼Œ2279(æ¸¯ç‰ˆä¸»æœºåŠ å¡å°”è¾¾)ï¼ŒçœŸçš„å¤ªé¦™äº†ã€‚å¯æƒœåªæœ‰å•ç‹¬ä¸»æœºï¼Œè½¬æ¥å¤´ã€é—ªå­˜ã€ä¿æŠ¤åŒ…è¿˜è¦å¦å¤–ä¹°ã€‚</p>
<p>å…¶ä»–ä¸œè¥¿è¿˜åœ¨è·¯ä¸Šï¼Œä¸çŸ¥é“è¿˜è¦ä¸è¦ä¹°ä¸ªproæ‰‹æŸ„ã€‚</p>
<p>ä»Šå¤©å°±å…ˆè¿™æ ·äº†å§ã€‚</p>
]]></content>
      <categories>
        <category>éšç¬”</category>
      </categories>
  </entry>
  <entry>
    <title>2019å†¬å­£PATè€ƒè¯•</title>
    <url>/2019-winter-PAT-advanced/</url>
    <content><![CDATA[<h3 id="æ„Ÿæƒ³"><a href="#æ„Ÿæƒ³" class="headerlink" title="æ„Ÿæƒ³"></a>æ„Ÿæƒ³</h3><p>ç¬¬ä¸€æ¬¡æ‹¿100ï¼Œç•™ä¸ªçºªå¿µã€‚</p>
<p>è¿™æ˜¯ç¬¬äºŒæ¬¡è€ƒäº†ï¼Œ ç¬¬ä¸€æ¬¡9æœˆä»½è€ƒçš„ï¼Œå‡†å¤‡ä½œä¸ºè€ƒç ”æœºè¯•ã€‚è€ƒå‰å‡†å¤‡å¤ä¹ äº†åå‡ ä¸ªå°æ—¶å°±ä¸Šè€ƒåœºäº†</p>
<p>ç¬¬ä¸€è€ƒçš„æ—¶å€™å¿ƒæ€ä¸å¤ªå¥½ï¼Œçœ‹åˆ°ç¬¬ä¸€é¢˜ï¼Œå¿ƒæ€å´©äº†ï¼Œæäº†å¥½ä¹…ä¸€ä¸ªåŠå°æ—¶ä¸€åˆ†æ²¡æ‹¿ï¼Œåæ¥å¿ƒæ€å›äº†ç‚¹ï¼ŒæŠŠåé¢ä¸‰é¢˜å†™å®Œäº†ï¼Œ æœ€åæ²¡æ—¶é—´å†™ç¬¬ä¸€é¢˜äº†ã€‚</p>
<p>ç¬¬äºŒæ¬¡è€ƒçš„æ—¶å€™ï¼Œå¿ƒæ€ç¨å¾®å¥½äº†ä¸€ç‚¹ï¼Œçœ‹åˆ°ç¬¬ä¸€é¢˜ï¼Œæ²¡çœ‹æ‡‚ï¼Œå¿ƒæ€æœ‰ç‚¹å¾®å´©ã€‚ ç›´æ¥åšåé¢ä¸‰é¢˜ï¼Œè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚å›è¿‡æ¥åšç¬¬ä¸€ä¸ªï¼Œå…¶å®ä¹Ÿå°±æ˜¯ä¸ªæ ¼å¼æ§åˆ¶ï¼ŒåŠå°æ—¶å†™å®Œå‡ºè€ƒåœºäº†ã€‚</p>
<p>æœ¬æ¥ä»¥ä¸ºä¼šè€ƒAVLå’Œæœ€çŸ­è·¯å¾„æˆ–è€…é›†åˆçš„ï¼Œç»“æœæ²¡è€ƒï¼Œç´§å¼ æ­»äº†ã€‚</p>
<h3 id="7-1-Good-in-C-20åˆ†"><a href="#7-1-Good-in-C-20åˆ†" class="headerlink" title="7-1 Good in C (20åˆ†)"></a>7-1 Good in C (20åˆ†)</h3><p>When your interviewer asks you to write â€œHello Worldâ€ using C, can you do as the following figure shows?</p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/2019-winter-PAT-advanced-HWC.jpg" alt="HWC.jpg"></p>
<h4 id="Input-Specification"><a href="#Input-Specification" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each case, the first part gives the 26 capital English letters A-Z, each in a 7Ã—5 matrix of Câ€™s and .â€™s. Then a sentence is given in a line, ended by a return. The sentence is formed by several words (no more than 10 continuous capital English letters each), and the words are separated by any characters other than capital English letters.</p>
<p>It is guaranteed that there is at least one word given.</p>
<h4 id="Output-Specification"><a href="#Output-Specification" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each word, print the matrix form of each of its letters in a line, and the letters must be separated by exactly one column of space. There must be no extra space at the beginning or the end of the word.</p>
<p>Between two adjacent words, there must be a single empty line to separate them. There must be no extra line at the beginning or the end of the output.</p>
<h4 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><a id="more"></a>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">..C..</span><br><span class="line">.C.C.</span><br><span class="line">C...C</span><br><span class="line">CCCCC</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">CCCC.</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">CCCC.</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">CCCC.</span><br><span class="line">.CCC.</span><br><span class="line">C...C</span><br><span class="line">C....</span><br><span class="line">C....</span><br><span class="line">C....</span><br><span class="line">C...C</span><br><span class="line">.CCC.</span><br><span class="line">CCCC.</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">CCCC.</span><br><span class="line">CCCCC</span><br><span class="line">C....</span><br><span class="line">C....</span><br><span class="line">CCCC.</span><br><span class="line">C....</span><br><span class="line">C....</span><br><span class="line">CCCCC</span><br><span class="line">CCCCC</span><br><span class="line">C....</span><br><span class="line">C....</span><br><span class="line">CCCC.</span><br><span class="line">C....</span><br><span class="line">C....</span><br><span class="line">C....</span><br><span class="line">CCCC.</span><br><span class="line">C...C</span><br><span class="line">C....</span><br><span class="line">C.CCC</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">CCCC.</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">CCCCC</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">CCCCC</span><br><span class="line">..C..</span><br><span class="line">..C..</span><br><span class="line">..C..</span><br><span class="line">..C..</span><br><span class="line">..C..</span><br><span class="line">CCCCC</span><br><span class="line">CCCCC</span><br><span class="line">....C</span><br><span class="line">....C</span><br><span class="line">....C</span><br><span class="line">....C</span><br><span class="line">C...C</span><br><span class="line">.CCC.</span><br><span class="line">C...C</span><br><span class="line">C..C.</span><br><span class="line">C.C..</span><br><span class="line">CC...</span><br><span class="line">C.C..</span><br><span class="line">C..C.</span><br><span class="line">C...C</span><br><span class="line">C....</span><br><span class="line">C....</span><br><span class="line">C....</span><br><span class="line">C....</span><br><span class="line">C....</span><br><span class="line">C....</span><br><span class="line">CCCCC</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">CC.CC</span><br><span class="line">C.C.C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">CC..C</span><br><span class="line">C.C.C</span><br><span class="line">C..CC</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">.CCC.</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">.CCC.</span><br><span class="line">CCCC.</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">CCCC.</span><br><span class="line">C....</span><br><span class="line">C....</span><br><span class="line">C....</span><br><span class="line">.CCC.</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C.C.C</span><br><span class="line">C..CC</span><br><span class="line">.CCC.</span><br><span class="line">CCCC.</span><br><span class="line">C...C</span><br><span class="line">CCCC.</span><br><span class="line">CC...</span><br><span class="line">C.C..</span><br><span class="line">C..C.</span><br><span class="line">C...C</span><br><span class="line">.CCC.</span><br><span class="line">C...C</span><br><span class="line">C....</span><br><span class="line">.CCC.</span><br><span class="line">....C</span><br><span class="line">C...C</span><br><span class="line">.CCC.</span><br><span class="line">CCCCC</span><br><span class="line">..C..</span><br><span class="line">..C..</span><br><span class="line">..C..</span><br><span class="line">..C..</span><br><span class="line">..C..</span><br><span class="line">..C..</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">.CCC.</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">.C.C.</span><br><span class="line">..C..</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C.C.C</span><br><span class="line">CC.CC</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">.C.C.</span><br><span class="line">..C..</span><br><span class="line">.C.C.</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">C...C</span><br><span class="line">.C.C.</span><br><span class="line">..C..</span><br><span class="line">..C..</span><br><span class="line">..C..</span><br><span class="line">..C..</span><br><span class="line">CCCCC</span><br><span class="line">....C</span><br><span class="line">...C.</span><br><span class="line">..C..</span><br><span class="line">.C...</span><br><span class="line">C....</span><br><span class="line">CCCCC</span><br><span class="line">HELLO~WORLD!</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">C...C CCCCC C.... C.... .CCC.</span><br><span class="line">C...C C.... C.... C.... C...C</span><br><span class="line">C...C C.... C.... C.... C...C</span><br><span class="line">CCCCC CCCC. C.... C.... C...C</span><br><span class="line">C...C C.... C.... C.... C...C</span><br><span class="line">C...C C.... C.... C.... C...C</span><br><span class="line">C...C CCCCC CCCCC CCCCC .CCC.</span><br><span class="line"></span><br><span class="line">C...C .CCC. CCCC. C.... CCCC.</span><br><span class="line">C...C C...C C...C C.... C...C</span><br><span class="line">C...C C...C CCCC. C.... C...C</span><br><span class="line">C.C.C C...C CC... C.... C...C</span><br><span class="line">CC.CC C...C C.C.. C.... C...C</span><br><span class="line">C...C C...C C..C. C.... C...C</span><br><span class="line">C...C .CCC. C...C CCCCC CCCC.</span><br></pre></td></tr></table></figure>
<h4 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h4><p>è¿™é¢˜ï¼Œå®ƒç»™äº†26ä¸ªå•è¯çš„7Ã—5çŸ©é˜µçš„å­—ç¬¦è¡¨ç¤ºå½¢å¼ï¼Œè¦æ±‚æŠŠæŠŠæœ€åçš„å­—ç¬¦ä¸²çš„å¤§å†™å•è¯åˆ†åˆ«è¡¨å‡ºæ¥ã€‚  </p>
<p>è¿™é¢˜å‘ç‚¹å°±æ˜¯ä¸¥æ ¼çš„æ ¼å¼ã€‚é¦–å…ˆå¾ˆè‡ªç„¶çš„ä¼šç”¨ä¸€ä¸ªæ•°ç»„å‚¨å­˜å•è¯çš„è¡¨ç¤ºå½¢å¼ï¼Œæ‰€ä»¥æˆ‘ç”¨äº†ä¸€ä¸ª<code>data[26][7][5]</code>æ•°ç»„å­˜ï¼Œæ³¨æ„ä¸è¦å°†ç»“å°¾çš„å›è½¦å­˜å…¥ã€‚ä½¿ç”¨<code>getline</code>è·å¾—ä¸€æ•´è¡Œå­—ç¬¦ä¸²ï¼Œç„¶åå°†å­—ç¬¦ä¸²éå†ï¼Œå°†å°äº10ä¸ªå­—ç¬¦é•¿åº¦çš„å…¨å¤§å†™è¿ç»­çš„å•è¯å­˜èµ·æ¥ï¼Œç”¨ä½œç»“æœè¾“å‡ºã€‚ç„¶åæŒ‰è¡Œè¾“å‡ºï¼Œå¯ä»¥çœ‹å‡ºæ¯ä¸€ä¸ªå•è¯éƒ½æ˜¯ä¸ƒè¡Œï¼Œç„¶åæ ¹æ®æ¯ä¸ªå•è¯ï¼Œè¾“å‡ºå¯¹åº”è¡Œï¼Œå°±å¯ä»¥äº†ï¼Œæ ¼å¼æ³¨æ„ä¸€ä¸‹å°±å¥½äº†ã€‚</p>
<h4 id="Solutionï¼š"><a href="#Solutionï¼š" class="headerlink" title="Solutionï¼š"></a>Solutionï¼š</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> data[<span class="number">26</span>][<span class="number">7</span>][<span class="number">5</span>], ch;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i) &#123; <span class="comment">//å­˜æ•°æ®</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">7</span>; ++j) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">5</span>; ++k) &#123;</span><br><span class="line">				<span class="built_in">scanf</span>(<span class="string">"%c"</span>, &amp;ch);</span><br><span class="line">				<span class="keyword">if</span>(ch == <span class="string">'\n'</span>) k--; <span class="comment">//è·³è¿‡å›è½¦</span></span><br><span class="line">				<span class="keyword">else</span> data[i][j][k] = ch;	</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	getchar(); <span class="comment">// å­—ç¬¦ä¸²å¤„ç†</span></span><br><span class="line">	<span class="built_in">string</span> s, s1 = <span class="string">""</span>;</span><br><span class="line">	getline(<span class="built_in">cin</span>, s);</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; result;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="string">'A'</span> &lt;= s[i] &amp;&amp; s[i] &lt;= <span class="string">'Z'</span>) &#123;</span><br><span class="line">			s1 += s[i];</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(s1 != <span class="string">""</span> &amp;&amp; s1.length() &lt;= <span class="number">10</span>)</span><br><span class="line">				result.push_back(s1);</span><br><span class="line">			s1 = <span class="string">""</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(s1 != <span class="string">""</span>) result.push_back(s1);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; result.<span class="built_in">size</span>(); ++i) &#123; <span class="comment">// è¾“å‡ºæ¨¡å—</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">7</span>; ++j) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; result[i].<span class="built_in">size</span>(); ++k) &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> l = <span class="number">0</span>; l &lt; <span class="number">5</span>; ++l) &#123;</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">"%c"</span>, data[result[i][k]- <span class="string">'A'</span>][j][l]);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(k != result[i].<span class="built_in">size</span>() - <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">" "</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(i != result.<span class="built_in">size</span>() - <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7-2-Block-Reversing-25åˆ†"><a href="#7-2-Block-Reversing-25åˆ†" class="headerlink" title="7-2 Block Reversing (25åˆ†)"></a>7-2 Block Reversing (25åˆ†)</h3><p>Given a singly linked list L. Let us consider every K nodes as a <code>block</code> (if there are less than K nodes at the end of the list, the rest of the nodes are still considered as a block). Your job is to reverse all the blocks in L. For example, given L as 1â†’2â†’3â†’4â†’5â†’6â†’7â†’8 and K as 3, your output must be 7â†’8â†’4â†’5â†’6â†’1â†’2â†’3.</p>
<h4 id="Input-Specification-1"><a href="#Input-Specification-1" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each case, the first line contains the address of the first node, a positive N (â‰¤$10^5$) which is the total number of nodes, and a positive K (â‰¤N) which is the size of a block. The address of a node is a 5-digit nonnegative integer, and NULL is represented by âˆ’1.</p>
<p>Then N lines follow, each describes a node in the format:</p>
<blockquote>
<p>Address Data Next</p>
</blockquote>
<p>where Address is the position of the node, Data is an integer, and Next is the position of the next node.</p>
<h4 id="Output-Specification-1"><a href="#Output-Specification-1" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each case, output the resulting ordered linked list. Each node occupies a line, and is printed in the same format as in the input.</p>
<h4 id="Sample-Input-1"><a href="#Sample-Input-1" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">00100 8 3</span><br><span class="line">71120 7 88666</span><br><span class="line">00000 4 99999</span><br><span class="line">00100 1 12309</span><br><span class="line">68237 6 71120</span><br><span class="line">33218 3 00000</span><br><span class="line">99999 5 68237</span><br><span class="line">88666 8 -1</span><br><span class="line">12309 2 33218</span><br></pre></td></tr></table></figure>
<h4 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output:"></a>Sample Output:</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">71120 7 88666</span><br><span class="line">88666 8 00000</span><br><span class="line">00000 4 99999</span><br><span class="line">99999 5 68237</span><br><span class="line">68237 6 00100</span><br><span class="line">00100 1 12309</span><br><span class="line">12309 2 33218</span><br><span class="line">33218 3 -1</span><br></pre></td></tr></table></figure>
<h4 id="è§£æ-1"><a href="#è§£æ-1" class="headerlink" title="è§£æ"></a>è§£æ</h4><p>å¸¸è§„çš„é“¾è¡¨é¢˜ï¼Œå°±æ˜¯å°†æ¯Kä¸ªæ•°æ®ç¼–æˆä¸€ç»„ï¼Œç„¶åå°†è¿™å‡ ä¸ªç»„é€†ç½®ã€‚ä¸ºäº†ç¨³å¦¥èµ·è§ï¼Œä½¿ç”¨ç»“æ„ä½“æ•°ç»„å­˜é“¾å¼å…³ç³»ï¼Œç„¶åä»å¼€å¤´éå†ï¼Œæ¯kä¸ªå­˜å…¥åŒä¸€ä¸ª<code>vecotr&lt;node&gt;</code>ï¼Œå†å°†è¿™ä¸ª<code>vector&lt;node&gt;</code>å­˜å…¥<code>vector&lt;vector&lt;node&gt;&gt;</code>ï¼Œç„¶åæ‹¼æ¥æˆä¸€ä¸ª<code>vector&lt;node&gt;</code>ï¼Œç„¶åéå†é‡æ–°æ”¹å†™nextå°±å¥½äº†ï¼Œæœ€ååœ¨æ³¨æ„ä¸€ä¸‹æ ¼å¼å°±è¡Œäº†ã€‚</p>
<h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution:"></a>Solution:</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> address;</span><br><span class="line">	<span class="keyword">int</span> key;</span><br><span class="line">	<span class="keyword">int</span> next;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">node <span class="built_in">list</span>[<span class="number">100100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> start, n, k;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; start &gt;&gt; n &gt;&gt; k;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> s, key, ne;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;s);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;<span class="built_in">list</span>[s].key, &amp;<span class="built_in">list</span>[s].next);</span><br><span class="line">		<span class="built_in">list</span>[s].address = s;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;node&gt;&gt; data;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(start != <span class="number">-1</span>) &#123;</span><br><span class="line">		<span class="keyword">int</span> count = k;</span><br><span class="line">		<span class="built_in">vector</span>&lt;node&gt; tmp;</span><br><span class="line">		<span class="keyword">while</span>(count-- &amp;&amp; start != <span class="number">-1</span>) &#123;</span><br><span class="line">			tmp.push_back(<span class="built_in">list</span>[start]);</span><br><span class="line">			start = <span class="built_in">list</span>[start].next;</span><br><span class="line">		&#125;</span><br><span class="line">		data.push_back(tmp);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">vector</span>&lt;node&gt; result;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = data.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">		result.insert(result.<span class="built_in">end</span>(), data[i].<span class="built_in">begin</span>(), data[i].<span class="built_in">end</span>());</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; result.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span>(i == result.<span class="built_in">size</span>() - <span class="number">1</span>) result[i].next = <span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">else</span> result[i].next = result[i+<span class="number">1</span>].address;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; result.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span>(i == result.<span class="built_in">size</span>() - <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%05d %d -1\n"</span>, result[i].address, result[i].key);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%05d %d %05d\n"</span>, result[i].address, result[i].key, result[i].next);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7-3-Summit-25åˆ†"><a href="#7-3-Summit-25åˆ†" class="headerlink" title="7-3 Summit (25åˆ†)"></a>7-3 Summit (25åˆ†)</h3><p>A summit (å³°ä¼š) is a meeting of heads of state or government. Arranging the rest areas for the summit is not a simple job. The ideal arrangement of one area is to invite those heads so that everyone is a direct friend of everyone.</p>
<p>Now given a set of tentative arrangements, your job is to tell the organizers whether or not each area is all set.</p>
<h4 id="Input-Specification-2"><a href="#Input-Specification-2" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. For each case, the first line gives two positive integers N (â‰¤ 200), the number of heads in the summit, and M, the number of friendship relations. Then M lines follow, each gives a pair of indices of the heads who are friends to each other. The heads are indexed from 1 to N.</p>
<p>Then there is another positive integer K (â‰¤ 100), and K lines of tentative arrangement of rest areas follow, each first gives a positive number L (â‰¤ N), then followed by a sequence of L distinct indices of the heads. All the numbers in a line are separated by a space.</p>
<h4 id="Output-Specification-2"><a href="#Output-Specification-2" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each of the K areas, print in a line your advice in the following format:</p>
<p>if in this area everyone is a direct friend of everyone, and no friend is missing (that is, no one else is a direct friend of everyone in this area), print Area X is OK..</p>
<p>if in this area everyone is a direct friend of everyone, yet there are some other heads who may also be invited without breaking the ideal arrangement, print Area X may invite more people, such as H. where H is the smallest index of the head who may be invited.</p>
<p>if in this area the arrangement is not an ideal one, then print Area X needs help. so the host can provide some special service to help the heads get to know each other.</p>
<p>Here X is the index of an area, starting from 1 to K.</p>
<h4 id="è§£æ-2"><a href="#è§£æ-2" class="headerlink" title="è§£æ"></a>è§£æ</h4><p><a href="https://pintia.cn/problem-sets/994805342720868352/problems/994805343979159552" target="_blank" rel="noopener">pat1142</a>åŸé¢˜è€ƒè¿‡ï¼Œä¸éš¾ï¼Œå°±æ˜¯åˆ¤æ–­ç»™å‡ºçš„è¿™å‡ ä¸ªäººæ˜¯å¦äº’ä¸ºæœ‹å‹ï¼Œå¦‚æœä¸ºæœ‹å‹ï¼Œæ˜¯å¦å­˜åœ¨ä¸€ä¸ªäººä¸åœ¨å…¶ä¸­ï¼Œç¼ºä¸å…¶ä»–äººéƒ½æ˜¯æœ‹å‹å…³ç³»ã€‚è¿™é¢˜å¯ä»¥è®¾ç½®ä¸¤ä¸ªåˆ¤æ–­ã€‚ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œåˆ¤æ–­äººæ˜¯å¦ç›¸äº’ä¸ºæœ‹å‹ï¼Œæš´åŠ›æœä¸¤ä¸ªäººä¹‹é—´æ˜¯å¦æœ‰å…³ç³»ã€‚ç¬¬äºŒä¸ªåˆ¤æ–­ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰è¿™æ ·çš„ä¸€ä¸ªäººï¼Œæš´åŠ›æœä¸åœ¨å…¶ä¸­çš„äººçš„äººé™…å…³ç³»ã€‚</p>
<h4 id="Sample-Input-2"><a href="#Sample-Input-2" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">8 10</span><br><span class="line">5 6</span><br><span class="line">7 8</span><br><span class="line">6 4</span><br><span class="line">3 6</span><br><span class="line">4 5</span><br><span class="line">2 3</span><br><span class="line">8 2</span><br><span class="line">2 7</span><br><span class="line">5 3</span><br><span class="line">3 4</span><br><span class="line">6</span><br><span class="line">4 5 4 3 6</span><br><span class="line">3 2 8 7</span><br><span class="line">2 2 3</span><br><span class="line">1 1</span><br><span class="line">2 4 6</span><br><span class="line">3 3 2 1</span><br></pre></td></tr></table></figure>
<h4 id="Sample-Output-1"><a href="#Sample-Output-1" class="headerlink" title="Sample Output:"></a>Sample Output:</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Area 1 is OK.</span><br><span class="line">Area 2 is OK.</span><br><span class="line">Area 3 is OK.</span><br><span class="line">Area 4 is OK.</span><br><span class="line">Area 5 may invite more people, such as 3.</span><br><span class="line">Area 6 needs help.</span><br></pre></td></tr></table></figure>
<h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution:"></a>Solution:</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> e[<span class="number">210</span>][<span class="number">210</span>];</span><br><span class="line"><span class="keyword">bool</span> vis[<span class="number">210</span>];</span><br><span class="line"><span class="keyword">int</span> person = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, a, b;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">judge1</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;data)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; data.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; data.<span class="built_in">size</span>(); ++j) &#123;</span><br><span class="line">			<span class="keyword">if</span>(!e[data[i]][data[j]]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">judge2</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;data)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span>(!vis[i]) &#123;</span><br><span class="line">			<span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span>(; j &lt; data.<span class="built_in">size</span>(); ++j) &#123;</span><br><span class="line">				<span class="keyword">if</span>(!e[i][data[j]]) <span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(j == data.<span class="built_in">size</span>()) &#123;</span><br><span class="line">				person = i;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;a, &amp;b);</span><br><span class="line">		e[a][b] = <span class="number">1</span>;</span><br><span class="line">		e[b][a] = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> k;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; k;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= k; ++j) &#123;</span><br><span class="line">		<span class="keyword">int</span> l;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; l;</span><br><span class="line">		<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; data;</span><br><span class="line">		<span class="built_in">fill</span>(vis, vis + <span class="number">210</span>, <span class="literal">false</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; l; ++i) &#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a);</span><br><span class="line">			data.push_back(a);</span><br><span class="line">			vis[a] = <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(!judge1(data)) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"Area %d needs help.\n"</span>, j);</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span>(judge2(data))&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"Area %d is OK.\n"</span>, j);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"Area %d may invite more people, such as %d.\n"</span>, j, person);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7-4-Cartesian-Tree-30åˆ†"><a href="#7-4-Cartesian-Tree-30åˆ†" class="headerlink" title="7-4 Cartesian Tree (30åˆ†)"></a>7-4 Cartesian Tree (30åˆ†)</h3><p>A Cartesian tree is a binary tree constructed from a sequence of distinct numbers. The tree is heap-ordered, and an inorder traversal returns the original sequence. For example, given the sequence { 8, 15, 3, 4, 1, 5, 12, 10, 18, 6 }, the min-heap Cartesian tree is shown by the figure.</p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/2019-winter-PAT-advanced-CTree.jpg" alt="CTree.jpg"></p>
<p>Your job is to output the level-order traversal sequence of the min-heap Cartesian tree.</p>
<h4 id="Input-Specification-3"><a href="#Input-Specification-3" class="headerlink" title="Input Specification:"></a>Input Specification:</h4><p>Each input file contains one test case. Each case starts from giving a positive integer N (â‰¤30), and then N distinct numbers in the next line, separated by a space. All the numbers are in the range of int.</p>
<h4 id="Output-Specification-3"><a href="#Output-Specification-3" class="headerlink" title="Output Specification:"></a>Output Specification:</h4><p>For each test case, print in a line the level-order traversal sequence of the min-heap Cartesian tree. All the numbers in a line must be separated by exactly one space, and there must be no extra space at the beginning or the end of the line.</p>
<h4 id="Sample-Input-3"><a href="#Sample-Input-3" class="headerlink" title="Sample Input:"></a>Sample Input:</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">10</span><br><span class="line">8 15 3 4 1 5 12 10 18 6</span><br></pre></td></tr></table></figure>
<h4 id="Sample-Output-2"><a href="#Sample-Output-2" class="headerlink" title="Sample Output:"></a>Sample Output:</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1 3 5 8 4 6 15 10 12 18</span><br></pre></td></tr></table></figure>
<h4 id="è§£æ-3"><a href="#è§£æ-3" class="headerlink" title="è§£æ"></a>è§£æ</h4><p>è¿™é¢˜æ˜¯åˆ©ç”¨å †çš„ä¸€ä¸ªä¸­åºï¼Œç”Ÿæˆå †ï¼Œå¹¶ä¸”è¾“å‡ºå®ƒçš„å±‚åºéå†ç»“æœã€‚<br>è¿™é¢˜ä¹Ÿä¸éš¾ï¼Œå…¶å®å’Œå‰åºä¸­åºç”Ÿæˆæ ‘æˆ–è€…ä¸­åºååºç”Ÿæˆæ ‘å·®ä¸å¤šã€‚ä¸ºäº†é˜²æ­¢çˆ†æ•°ç»„ï¼Œæˆ‘æ˜¯ç”¨mapå……å½“æ•°ç»„çš„ä½œç”¨ï¼Œé€’å½’å»ºæ ‘ã€‚</p>
<h4 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; in;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; tree;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">createTree</span><span class="params">(<span class="keyword">int</span> ind, <span class="keyword">int</span> start, <span class="keyword">int</span> <span class="built_in">end</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(start &gt; <span class="built_in">end</span>) <span class="keyword">return</span> ;</span><br><span class="line">	<span class="keyword">int</span> index = start;</span><br><span class="line">	<span class="keyword">int</span> key = in[start];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = start; i &lt;= <span class="built_in">end</span>; ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span>(key &gt; in[i]) &#123;</span><br><span class="line">			key = in[i];</span><br><span class="line">			index = i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	tree[ind] = key;</span><br><span class="line">	createTree(ind * <span class="number">2</span>, start, index - <span class="number">1</span>);</span><br><span class="line">	createTree(ind * <span class="number">2</span> + <span class="number">1</span>, index + <span class="number">1</span>, <span class="built_in">end</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n, num;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;num);</span><br><span class="line">		in.push_back(num);</span><br><span class="line">	&#125;</span><br><span class="line">	createTree(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">auto</span> a = tree.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>, a-&gt;second);</span><br><span class="line">	a++;</span><br><span class="line">	<span class="keyword">for</span>(; a != tree.<span class="built_in">end</span>(); ++a) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">" %d"</span>, a-&gt;second);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>DS</category>
      </categories>
      <tags>
        <tag>PAT</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>éšç¬”</title>
    <url>/2020-01-14/</url>
    <content><![CDATA[<p>å¿™äº†ä¸€æ˜ŸæœŸï¼Œå‡†å¤‡åœ¨å¹´å‰å®Œæˆå®ä¹ ç”Ÿå·¥ä½œçš„å¯»æ‰¾ï¼Œç°åœ¨å·²ç»å…¥èŒä¸¤å¤©äº†ã€‚è¿™è¿˜æ˜¯å¾ˆç´§è¦çš„ï¼Œæ¯•ç«Ÿæˆ‘ä»¬å­¦æ ¡æœ‰4ä¸ªå®ä¹ çš„å¿…ä¿®å­¦åˆ†ï¼Œå®ä¹ æœŸå¿…é¡»æ»¡3ä¸ªæœˆã€‚</p>
<p>æ‰¾å·¥ä½œå”¯ä¸€çš„æ„Ÿè§‰ï¼Œå°±æ˜¯æ„Ÿè§‰å­¦çš„ä¸å¤Ÿæ·±å…¥ï¼Œè™½ç„¶æ¥è§¦äº†å¤§éƒ¨åˆ†ä¸œè¥¿ï¼Œä½†å¤§éƒ¨åˆ†éƒ½æ˜¯æµ…å°è¾„æ­¢ã€‚éƒ½è¯´ä»Šå¹´æ˜¯äº’è”ç½‘ä¼ä¸šçš„å¯’å†¬ï¼Œä½†æ˜¯è¿™æ ·ä¹Ÿå¾—ç¡¬ç€å¤´çš®ä¸Šäº†ã€‚å¦‚æœå®åœ¨æ‰¾ä¸åˆ°çš„è¯ï¼Œå°±åœ¨è€å¸ˆçš„æ‰‹ä¸‹åšå®ä¹ ç”Ÿå§ã€‚</p>
<p>å¿˜äº†è¯´æˆ‘çš„è¿›çš„æ˜¯è™¹è½¯ç§‘æŠ€ï¼Œæµ‹è¯•å¼€å‘å®ä¹ ç”Ÿï¼Œå¯æƒœæ²¡æœ‰å¼€å‘å²—ä½äº†ã€‚</p>
<p>å·²ç»å®ä¹ ä¸¤å¤©äº†ï¼Œæ„Ÿè§‰è¿˜ä¸é”™ï¼Œå…¬å¸æ°›å›´æŒºå¥½çš„ï¼Œå…¶ä»–çš„ä»¥åå†è¯´è¯´å§ã€‚</p>
]]></content>
      <categories>
        <category>éšç¬”</category>
      </categories>
  </entry>
  <entry>
    <title>éšç¬”</title>
    <url>/2020-01-24/</url>
    <content><![CDATA[<p>å¤§å®¶æ–°å¹´å¿«ä¹ã€‚</p>
<p>19å·åçš„çš„åŠ¨è½¦å›æ¥ï¼Œè¿˜å¥½æ²¡èµ¶ä¸Šç–«æƒ…çˆ†å‘çš„æ—¶å€™ã€‚</p>
<p>è¿™å‡ å¤©èˆ†è®ºå‘é…µçš„å‰å®³ï¼Œå…¶å®ä¹Ÿæ²¡å¿…è¦è¿‡åº¦æƒŠæ…Œï¼Œæ­¦æ±‰1000å¤šä¸‡äººï¼Œå°±ç®—å®é™…æ„ŸæŸ“çš„äººæ•°æœ‰å‡ åƒäººï¼Œå…¶å®ä¸­å¥–å‡ ç‡ä¹Ÿå°±æ˜¯ä¸‡åˆ†ä¹‹ä¸€ã€‚ä½†æ˜¯ä¹Ÿä¸èƒ½è¿‡åº¦æ”¾æ¾ã€‚å¿…è¦çš„å¸¦å¸¦å£ç½©ï¼Œå‹¤æ´—æ‰‹å…¶å®å°±å¤Ÿäº†ã€‚</p>
<p>å¸Œæœ›ä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥ã€‚</p>
]]></content>
      <categories>
        <category>éšç¬”</category>
      </categories>
      <tags>
        <tag>æ–°å¹´</tag>
      </tags>
  </entry>
  <entry>
    <title>éšç¬”</title>
    <url>/2020-02-26/</url>
    <content><![CDATA[<p>ä¸å¥½æ„æ€ï¼Œå·®ä¸å¤šä¸€ä¸ªå¤šæœˆæ²¡æœ‰æ›´æ–°äº†ã€‚</p>
<p>å› ä¸ºç–«æƒ…ï¼Œæ²¡æ³•å›æ­å·äº†ã€‚å½“ç„¶æˆ‘è¿™è¾¹å·²ç»å¼€å§‹è¿œç¨‹åŠå…¬äº†ï¼Œä»2æœˆåˆå°±å¼€å§‹äº†ï¼Œå¼€å§‹äº†å·®ä¸éƒ½ä¸‰æ˜ŸæœŸäº†ã€‚</p>
<p>åŸºæœ¬ä¸Šæ¯å¤©æ—©ä¸Š9ç‚¹èµ·æ¥ï¼Œåƒä¸ªæ—©é¤ï¼Œå¼€å§‹å·¥ä½œã€‚æ™šä¸Šæ‰“éº»å°†ï¼Œç„¶åswitch 1-2å°æ—¶ã€‚æ¯•è®¾æ ¹æœ¬ä¸æƒ³åŠ¨â€¦â€¦</p>
<p>è€ƒç ”æˆç»©ä¹Ÿå·²ç»å‡ºäº†ï¼Œè€ƒçš„æ¯”è¾ƒä¸€èˆ¬å§ï¼Œè¿˜æ˜¯æœ‰æœºä¼šè¿›å¤è¯•çš„ï¼Œç°åœ¨å¥½å¥½å‡†å¤‡å¤è¯•å§ã€‚ä¹‹åç­‰å¤è¯•ç»“æŸï¼Œå½•å–åå•å‡ºäº†ï¼Œå†æ€»ç»“ä¸€ä¸‹è€ƒç ”å†ç¨‹å§ã€‚</p>
<p>å†™è¿™ç¯‡éšç¬”çš„ç›®çš„ï¼Œä¸»è¦æ˜¯å‡†å¤‡è½¬æ¢ç”Ÿæ´»æ–¹å¼äº†ã€‚</p>
<p>ä»Šå¹´ä¸ŠåŠå¹´çš„çš„ä¸‰åº§å¤§å±±ï¼š</p>
<ul>
<li>ç ”ç©¶ç”Ÿå¤è¯•</li>
<li>æ¯•è®¾</li>
<li>å®ä¹ </li>
</ul>
<p>å¸Œæœ›è¿™ä¸‰ä¸ªéƒ½èƒ½å¥½å¥½çš„å®Œæˆã€‚</p>
<p>å°±åˆ°è¿™é‡Œå§ã€‚</p>
]]></content>
      <categories>
        <category>éšç¬”</category>
      </categories>
  </entry>
  <entry>
    <title>éšç¬”</title>
    <url>/2020-03-29/</url>
    <content><![CDATA[<p>ä¸å¥½æ„æ€å¥½ä¹…æ²¡æ›´æ–°äº†ã€‚</p>
<p>æˆ‘ä¸‰æœˆä¸ƒå·å›çš„æ­å·ï¼Œåœ¨è‡ªå¦‚ä¸Šï¼Œåœ¨å…¬å¸æ—è¾¹ç§Ÿäº†å°æˆ¿å­ï¼Œè‡ªæˆ‘éš”ç¦»äº†ä¸ƒå¤©ã€‚</p>
<p>è¿˜ç®—æ˜¯æ¯”è¾ƒè´µï¼Œ6.4å¹³ã€å…¬å…±å¨æˆ¿ã€å…¬å…±å«ç”Ÿé—´ï¼Œä¸€å¤©60ã€‚ä¸è¿‡ä¹Ÿæ²¡åŠæ³•çŸ­ç§Ÿä¸å¤ªå¥½æ‰¾ï¼Œä¸€ä¸ªæœˆå·¥èµ„å…¨æ‹¿æ¥äº¤æˆ¿ç§Ÿäº†(éš¾å—</p>
<p>ä¸‰æœˆåå…­å·å¼€å§‹çœŸæ­£å›å…¬å¸ä¸Šç­ã€‚</p>
<p>å·¥ä½œçš„åŒæ—¶è¿˜ä¼´éšç€å®Œæˆæ¯•è®¾.. æ¯å¤©éƒ½å¾ˆç„¦èº. (ç–¯ç‹‚æ‹–å»¶ç—‡ï¼‰ï¼Œæ‹–ç€æ‹–ç€ä¸€å¤©å°±ç»“æŸäº†ï¼Œå•¥äº‹éƒ½æ²¡åšæˆï¼ˆéš¾å—ã€‚</p>
<p>å¤è¯•å¤§æ¦‚æ˜¯è¦æ‹–åˆ°äº”æœˆäº†ï¼Œåº”è¯¥è¿˜æœ‰æ—¶é—´å§ã€‚</p>
<p>ä»Šå¤©å°±åˆ°è¿™é‡Œå§ï¼Œå°½é‡æ¯ä¸ªæœˆéƒ½æ›´æ–°ä¸€ç‚¹ã€‚</p>
]]></content>
      <categories>
        <category>éšç¬”</category>
      </categories>
  </entry>
  <entry>
    <title>2021-è¾æ—§è¿æ–°</title>
    <url>/2020-new-year-brief-2021/</url>
    <content><![CDATA[<p>è¿™ç¯‡æ–‡ç« æœ¬æ¥åº”è¯¥æ˜¯åœ¨å¯’å‡åœ¨å®¶çš„æ—¶å€™å†™çš„ï¼Œå¯æƒœå› ä¸ºæŸäº›åŸå› æ‹–åˆ°ç°åœ¨ï¼Œæ‰ä¸æ˜¯å› ä¸ºæ‹–å»¶ç—‡ï¼ˆæ»‘ç¨½</p>
<p>å¯’å‡åœ¨å®¶åŸºæœ¬ä¸Šæ‰“é€šäº† Hades(é€šå…³80å¤šæ¬¡) å’Œ ç©ºæ´éª‘å£«(switch)ã€‚</p>
<p>ä¸å¾—ä¸è¯´ç©ºæ´éª‘å£«æ˜¯æˆ‘ä¹°è¿‡æœ€å€¼çš„æ¸¸æˆäº†ï¼Œå®ƒçš„æ¸¸æˆä½“é‡ã€å†…å®¹ã€å®Œæˆåº¦å’Œæ¸¸æˆä½“éªŒä¸é€Šè‰²ä¸€äº›3Aå¤§ä½œï¼Œå°±æ˜¯æ–°äººä¸å¤ªå‹å¥½ã€‚åç­‰ä¸ä¹‹æ­Œã€‚</p>
<p>hadesè¿™æ¸¸æˆä¹Ÿä¸é”™ä½œä¸ºä¸€ä¸ªrougelikeæ¸¸æˆï¼Œè™½ç„¶åªæœ‰å››å…³ï¼Œä½†æ˜¯æœ¬èº«å‰§æƒ…éå¸¸ä¸é”™ï¼Œé‡å¤å¯ç©æ€§éå¸¸é«˜ã€‚ä¸€å…±6ç§æ­¦å™¨ï¼Œæ¯ç§æ­¦å™¨4ç§å½¢æ€ã€‚ä¹Ÿå°±æ˜¯è¯´æœ‰24ç§æ­¦å™¨å¯ä»¥åˆ‡æ¢ã€‚éš¾åº¦æœ¬èº«å¹¶ä¸ä½ï¼Œç‰¹åˆ«æ˜¯å¼€äº†çƒ­åº¦ã€‚æˆ‘è§‰å¾—å¯ä»¥å†å‡ºä¸€ä¸ªDLCï¼Œæœ¬èº«çš„å†…å®¹è¿˜å¯ä»¥å†å……å®ä¸€ä¸‹ï¼Œä»·æ ¼ä¸­è§„ä¸­çŸ©ã€‚éŸ³ä¹éå¸¸ä¸é”™ï¼Œè¿™æ¸¸æˆåæ­£ä¹°äº†ä¸äºã€‚</p>
<p>åœ¨å®¶æœŸé—´ï¼Œä¸»åŠ¨å»å­¦ä¹ ä¸€äº›å…³äºå¥èº«çš„çŸ¥è¯†ï¼Œæˆ‘ä¹Ÿæƒ³æ”¹å˜ä¸€ä¸‹åå¹´åƒå•¥éƒ½ä¸é•¿è‚‰çš„ä½“å‹äº†ã€‚å»Bç«™æœåˆ°äº†å“å”ï¼Œæ‰«é™¤äº†æˆ‘ä¹‹å‰å¾ˆå¤šçš„å¥èº«è¯¯åŒºï¼Œåˆæ°é€¢æˆ‘å®¶ç¤¾åŒºå»ºè®¾äº†æ–°çš„å…è´¹çš„å¥èº«æˆ¿ã€‚æœ€ç»ˆè¸ä¸Šäº†å¥èº«ä¹‹æ—…ï¼Œå‰å‡ å¤©æµ‹äº†ä¸€ä¸‹ä½“é‡ï¼Œæ¶¨äº†10æ–¤ï¼ˆç‹‚å–œï¼‰</p>
<p>å‰é¢ç®€å•ä»‹ç»äº†ä¸€ä¸‹æˆ‘åœ¨å®¶çš„äº‹æƒ…ã€‚</p>
<p>2020å¹´æ˜¯ä¸€ä¸ªå¯¹æˆ‘æœ‰é‡å¤§å½±å“çš„ä¸€å¹´ï¼š</p>
<p>è€ƒç ”ç»“æŸ-&gt;æ‘¸ç€ç–«æƒ…ï¼Œä¸€äººåœ¨å¤–ç¬¬ä¸€æ¬¡ç§Ÿæˆ¿å®ä¹ -&gt;æ‘¸ç€å®ä¹ å†™æ¯•è®¾-&gt;ç ”ç©¶ç”Ÿå¤è¯•-&gt;æ¯•è®¾ç­”è¾©-&gt;ç®€å•æ¯•ä¸š-&gt;ç ”ç©¶ç”Ÿç”Ÿæ´»</p>
<p>è¿™å¤§æ¦‚æ˜¯æ¯ä¸ªå¤§å­¦ç”Ÿéƒ½è¦ç»å†çš„è¿‡ç¨‹å§ã€‚</p>
<p>å…¶å®çœ‹èµ·æ¥è¿˜å¥½ï¼Œåªæœ‰å½“è‡ªå·±å›é¡¾èµ·è‡ªå·±çš„ç»å†çš„æ‰ä¼šæ„Ÿæ…¨è‡ªå·±å½“æ—¶æ˜¯æ€ä¹ˆæ ·è¾¹å®ä¹ è¾¹æŠŠæ¯•è®¾å®Œæˆçš„ã€‚</p>
<p>æ„Ÿå¹ç•™ç»™è¿‡å»ï¼Œç€çœ¼æœªæ¥å¤§æ¦‚æ‰æ˜¯æˆ‘ä¸ä¼šåœæ­¢è„šæ­¥çš„åŸå› å§ã€‚</p>
<p>æ–°çš„ä¸€å¹´å¸Œæœ›è‡ªå·±èƒ½åœ¨ä¸“ä¸šé¢†åŸŸåˆ«å†è¿·èŒ«ï¼Œèƒ½æœ‰æ˜ç¡®çš„åŠªåŠ›æ–¹å‘ã€‚</p>
]]></content>
      <tags>
        <tag>éšç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>[DDIA][ç¬¬ä¸€ç« ]ï¼šå¯é æ€§ã€å¯æ‹“å±•æ€§ã€å¯ç»´æŠ¤æ€§</title>
    <url>/DDIA-ch1-reliability-scalability-maintainability/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¹…ä»°DDIAå¤§åï¼ŒåˆšæŠŠ<code>MIT 6.824</code>åšå®Œï¼Œä¹‹ååº”è¯¥ä¼šæŠŠDDIAçš„å†…å®¹åšä¸€ä¸ªæ‘˜å½•ï¼Œå…¶ä¸­ä¹Ÿä¼šå¤¹æ‚ç€<code>6.824</code>çš„è®ºæ–‡ç¿»è¯‘å’Œ<code>lab</code>è®°å½•çš„æ•´ç†</p>
<p>åŸä¹¦é“¾æ¥: <a href="https://vonng.gitbooks.io/ddia-cn/content/ch1.html" target="_blank" rel="noopener">Designing Data-Intensive Application</a></p>
<h1 id="ç¬¬ä¸€ç« "><a href="#ç¬¬ä¸€ç« " class="headerlink" title="ç¬¬ä¸€ç« "></a>ç¬¬ä¸€ç« </h1><h2 id="æ•°æ®ç³»ç»Ÿ"><a href="#æ•°æ®ç³»ç»Ÿ" class="headerlink" title="æ•°æ®ç³»ç»Ÿ"></a>æ•°æ®ç³»ç»Ÿ</h2><p>ç°ä»Šå¾ˆå¤šåº”ç”¨å±äºæ•°æ®å¯†é›†å‹ ï¼ˆdata-intensiveï¼‰ï¼Œè€Œéè®¡ç®—å¯†é›†å‹ï¼ˆcompute-intensiveï¼‰ã€‚ä¸»è¦çš„é—®é¢˜æ¥è‡ªæ•°æ®é‡ã€æ•°æ®çš„å¤æ‚æ€§ä»¥åŠæ•°æ®çš„å˜æ›´é€Ÿåº¦ã€‚</p>
<p>æ•°æ®å¯†é›†å‹åº”ç”¨é€šå¸¸éƒ½éœ€è¦ï¼š</p>
<ul>
<li>å­˜å‚¨æ•°æ®ï¼Œä»¥ä¾¿è‡ªå·±æˆ–å…¶ä»–åº”ç”¨ç¨‹åºä¹‹åèƒ½å†æ¬¡æ‰¾åˆ° ï¼ˆ<code>æ•°æ®åº“ï¼ˆdatabaseï¼‰</code>ï¼‰</li>
<li>è®°ä½å¼€é”€æ˜‚è´µæ“ä½œçš„ç»“æœï¼ŒåŠ å¿«è¯»å–é€Ÿåº¦ï¼ˆ<code>ç¼“å­˜ï¼ˆcacheï¼‰</code>ï¼‰</li>
<li>å…è®¸ç”¨æˆ·æŒ‰å…³é”®å­—æœç´¢æ•°æ®ï¼Œæˆ–ä»¥å„ç§æ–¹å¼å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤ï¼ˆ<code>æœç´¢ç´¢å¼•ï¼ˆsearch indexesï¼‰</code>ï¼‰</li>
<li>å‘å…¶ä»–è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼Œè¿›è¡Œå¼‚æ­¥å¤„ç†ï¼ˆ<code>æµå¤„ç†ï¼ˆstream processingï¼‰</code>ï¼‰</li>
<li>å®šæœŸå¤„ç†ç´¯ç§¯çš„å¤§æ‰¹é‡æ•°æ®ï¼ˆ<code>æ‰¹å¤„ç†ï¼ˆbatch processingï¼‰</code>ï¼‰</li>
</ul>
<p>è¿™äº›éƒ½å±äºæ•°æ®ç³»ç»Ÿï¼ˆdata-systemï¼‰ã€‚</p>
<p>å…¶ä¸­ä¸‰ä¸ªåœ¨å¤§å¤šæ•°è½¯ä»¶ç§éƒ½éå¸¸é‡è¦çš„é—®é¢˜ï¼š</p>
<ul>
<li><p>å¯é æ€§ï¼ˆReliabilityï¼‰</p>
<ul>
<li>ç³»ç»Ÿåœ¨å›°å¢ƒï¼ˆadversityï¼‰ï¼ˆç¡¬ä»¶æ•…éšœã€è½¯ä»¶æ•…éšœã€äººä¸ºé”™è¯¯ï¼‰ä¸­ä»å¯æ­£å¸¸å·¥ä½œï¼ˆæ­£ç¡®å®ŒæˆåŠŸèƒ½ï¼Œå¹¶èƒ½è¾¾åˆ°æœŸæœ›çš„æ€§èƒ½æ°´å‡†ï¼‰ã€‚</li>
</ul>
</li>
<li><p>å¯æ‰©å±•æ€§ï¼ˆScalabilityï¼‰<br>æœ‰åˆç†çš„åŠæ³•åº”å¯¹ç³»ç»Ÿçš„å¢é•¿ï¼ˆæ•°æ®é‡ã€æµé‡ã€å¤æ‚æ€§ï¼‰</p>
</li>
<li><p>å¯ç»´æŠ¤æ€§ï¼ˆMaintainabilityï¼‰</p>
<ul>
<li>è®¸å¤šä¸åŒçš„äººï¼ˆå·¥ç¨‹å¸ˆã€è¿ç»´ï¼‰åœ¨ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸï¼Œéƒ½èƒ½é«˜æ•ˆåœ°åœ¨ç³»ç»Ÿä¸Šå·¥ä½œï¼ˆä½¿ç³»ç»Ÿä¿æŒç°æœ‰è¡Œä¸ºï¼Œå¹¶é€‚åº”æ–°çš„åº”ç”¨åœºæ™¯ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h2 id="å¯é æ€§"><a href="#å¯é æ€§" class="headerlink" title="å¯é æ€§"></a>å¯é æ€§</h2><p>äººä»¬å¯¹å¯é è½¯ä»¶çš„å…¸å‹æœŸæœ›åŒ…æ‹¬ï¼š</p>
<ul>
<li>åº”ç”¨ç¨‹åºè¡¨ç°å‡ºç”¨æˆ·æ‰€æœŸæœ›çš„åŠŸèƒ½ã€‚  </li>
<li>å…è®¸ç”¨æˆ·çŠ¯é”™ï¼Œå…è®¸ç”¨æˆ·ä»¥å‡ºä¹æ„æ–™çš„æ–¹å¼ä½¿ç”¨è½¯ä»¶ã€‚  </li>
<li>åœ¨é¢„æœŸçš„è´Ÿè½½å’Œæ•°æ®é‡ä¸‹ï¼Œæ€§èƒ½æ»¡è¶³è¦æ±‚ã€‚  </li>
<li>ç³»ç»Ÿèƒ½é˜²æ­¢æœªç»æˆæƒçš„è®¿é—®å’Œæ»¥ç”¨ã€‚  </li>
</ul>
<p>ç®€å•çš„è¯´å¯ä»¥è®¤ä¸ºæ˜¯â€œå³ä½¿å‡ºç°é—®é¢˜ï¼Œç³»ç»Ÿä¹Ÿèƒ½ç»§ç»­æ­£ç¡®å·¥ä½œâ€</p>
<p><code>æ•…éšœ</code>ï¼ˆfaultï¼‰ï¼šé€ æˆé”™è¯¯çš„åŸå› <br><code>å®¹é”™</code>ï¼ˆfault-tolerantï¼‰ï¼šèƒ½é¢„æ–™å¹¶å¯¹åº”æ•…éšœçš„ç³»ç»Ÿç‰¹æ€§ï¼Œå®ƒæ˜¯ä¸€å®šèŒƒå›´å†…çš„å®¹å¿</p>
<p><code>æ•…éšœ</code>ï¼ˆfaultï¼‰ä¸åŒäº<code>å¤±æ•ˆ</code>ï¼ˆfailureï¼‰<br><code>æ•…éšœ</code>é€šå¸¸å®šä¹‰ä¸ºç³»ç»Ÿçš„ä¸€éƒ¨åˆ†çŠ¶æ€åç¦»å…¶æ ‡å‡†ï¼Œè€Œ<code>å¤±æ•ˆ</code>åˆ™æ˜¯ç³»ç»Ÿä½œä¸ºä¸€ä¸ªæ•´ä½“åœæ­¢å‘ç”¨æˆ·æä¾›æœåŠ¡ã€‚<code>æ•…éšœ</code>çš„æ¦‚ç‡ä¸å¯èƒ½é™åˆ°é›¶ï¼Œå› æ­¤æœ€å¥½è®¾è®¡å®¹é”™æœºåˆ¶ä»¥é˜²å› <code>æ•…éšœ</code>è€Œå¯¼è‡´<code>å¤±æ•ˆ</code></p>
<p>ç°åœ¨ä¼šé€šè¿‡æé«˜è§¦å‘æ•…éšœæ¥æé«˜ä¿éšœç‡ï¼Œå› ä¸ºå¯ä»¥é€šè¿‡æ•…æ„å¼•å‘æ•…éšœæ¥ç¡®ä¿å®¹é”™æœºåˆ¶çš„æ­£å¸¸è¿è¡Œã€‚</p>
<p>åŒæ—¶ç›¸æ¯”ç»„ç»‡é”™è¯¯ï¼Œé€šå¸¸å€¾å‘ä¸å®¹å¿é”™è¯¯ã€‚ä½†æ˜¯åœ¨æŸäº›ç¯å¢ƒä¸‹ï¼Œä¸å®¹å¿é”™è¯¯æ›´å¥½ã€‚ä¾‹ï¼šé“¶è¡Œç³»ç»Ÿä¸­çš„å‡ºé”™ä¸èƒ½å®¹å¿ï¼Œå¤šç§é”™è¯¯ç´¯è®¡å°†å¯¹è´¦å·é€ æˆä¸å¯é€†çš„ä¼¤å®³ï¼Œè¿™æ—¶å€™åº”è¯¥é€‰æ‹©ç›´æ¥åœæ­¢æœåŠ¡ã€‚</p>
<h3 id="ç¡¬ä»¶æ•…éšœ"><a href="#ç¡¬ä»¶æ•…éšœ" class="headerlink" title="ç¡¬ä»¶æ•…éšœ"></a>ç¡¬ä»¶æ•…éšœ</h3><p>ç¡¬ç›˜çš„<code>å¹³å‡æ— æ•…éšœæ—¶é—´</code>ï¼ˆMTTF mean time to failureï¼‰çº¦ä¸º10-50å¹´</p>
<p>é€šå¸¸æ˜¯å¢åŠ å•ä¸ªç¡¬ä»¶çš„å†—ä½™åº¦ï¼Œæ¯”å¦‚RAIDï¼ŒåŒè·¯ç”µæºï¼Œçƒ­æ’æ‹”CPUç­‰</p>
<p>äº‘å¹³å°çš„è®¾è®¡ä¼˜å…ˆè€ƒè™‘<code>çµæ´»æ€§</code>å’Œ<code>å¼¹æ€§</code> ï¼Œå› ä¸ºäº‘å¹³å°æœ‰å¤§é‡çš„æœºå™¨ï¼Œä¸€æ—¦ä¸€ä¸ªä¸»æœºå¤±æ•ˆï¼Œé‚£ä¹ˆä¸€èˆ¬æ˜¯ç§»åŠ¨å…¶ä»–æœºå™¨ä¸Šè¿è¡Œã€‚</p>
<h3 id="è½¯ä»¶é”™è¯¯"><a href="#è½¯ä»¶é”™è¯¯" class="headerlink" title="è½¯ä»¶é”™è¯¯"></a>è½¯ä»¶é”™è¯¯</h3><p>ç³»ç»Ÿæ€§é”™è¯¯ï¼š</p>
<ul>
<li>æ¥å—ç‰¹å®šçš„é”™è¯¯è¾“å…¥ï¼Œä¾¿å¯¼è‡´æ‰€æœ‰åº”ç”¨æœåŠ¡å™¨å®ä¾‹å´©æºƒçš„BUGã€‚ä¾‹å¦‚2012å¹´6æœˆ30æ—¥çš„é—°ç§’ï¼Œç”±äºLinuxå†…æ ¸ä¸­çš„ä¸€ä¸ªé”™è¯¯ï¼Œè®¸å¤šåº”ç”¨åŒæ—¶æŒ‚æ‰äº†ã€‚</li>
<li>å¤±æ§è¿›ç¨‹ä¼šå ç”¨ä¸€äº›å…±äº«èµ„æºï¼ŒåŒ…æ‹¬CPUæ—¶é—´ã€å†…å­˜ã€ç£ç›˜ç©ºé—´æˆ–ç½‘ç»œå¸¦å®½ã€‚</li>
<li>ç³»ç»Ÿä¾èµ–çš„æœåŠ¡å˜æ…¢ï¼Œæ²¡æœ‰å“åº”ï¼Œæˆ–è€…å¼€å§‹è¿”å›é”™è¯¯çš„å“åº”ã€‚</li>
<li>çº§è”æ•…éšœï¼Œä¸€ä¸ªç»„ä»¶ä¸­çš„å°æ•…éšœè§¦å‘å¦ä¸€ä¸ªç»„ä»¶ä¸­çš„æ•…éšœï¼Œè¿›è€Œè§¦å‘æ›´å¤šçš„æ•…éšœã€‚</li>
</ul>
<p>éœ€è¦ç³»ç»Ÿä¸æ–­è‡ªæ£€ï¼Œå‡ºç°å·®å¼‚æ—¶æŠ¥è­¦</p>
<h3 id="äººä¸ºé”™è¯¯"><a href="#äººä¸ºé”™è¯¯" class="headerlink" title="äººä¸ºé”™è¯¯"></a>äººä¸ºé”™è¯¯</h3><ul>
<li>ä»¥æœ€å°åŒ–çŠ¯é”™æœºä¼šçš„æ–¹å¼è®¾è®¡ç³»ç»Ÿã€‚ä¾‹å¦‚ï¼Œç²¾å¿ƒè®¾è®¡çš„æŠ½è±¡ã€APIå’Œç®¡ç†åå°</li>
<li>å°†äººä»¬æœ€å®¹æ˜“çŠ¯é”™çš„åœ°æ–¹ä¸å¯èƒ½å¯¼è‡´å¤±æ•ˆçš„åœ°æ–¹è§£è€¦ï¼ˆdecoupleï¼‰ã€‚</li>
<li>åœ¨å„ä¸ªå±‚æ¬¡è¿›è¡Œå½»åº•çš„æµ‹è¯•ï¼Œä»å•å…ƒæµ‹è¯•ã€å…¨ç³»ç»Ÿé›†æˆæµ‹è¯•åˆ°æ‰‹åŠ¨æµ‹è¯•ã€‚</li>
<li>å…è®¸ä»äººä¸ºé”™è¯¯ä¸­ç®€å•å¿«é€Ÿåœ°æ¢å¤ï¼Œä»¥æœ€å¤§é™åº¦åœ°å‡å°‘å¤±æ•ˆæƒ…å†µå¸¦æ¥çš„å½±å“ã€‚</li>
<li>é…ç½®è¯¦ç»†å’Œæ˜ç¡®çš„ç›‘æ§ï¼Œæ¯”å¦‚æ€§èƒ½æŒ‡æ ‡å’Œé”™è¯¯ç‡ã€‚</li>
<li>è‰¯å¥½çš„ç®¡ç†å®è·µä¸å……åˆ†çš„åŸ¹è®­â€”</li>
</ul>
<h2 id="å¯æ‹“å±•æ€§"><a href="#å¯æ‹“å±•æ€§" class="headerlink" title="å¯æ‹“å±•æ€§"></a>å¯æ‹“å±•æ€§</h2><p>â€‹ å¯æ‰©å±•æ€§ï¼ˆScalabilityï¼‰ æ˜¯ç”¨æ¥æè¿°ç³»ç»Ÿåº”å¯¹è´Ÿè½½å¢é•¿èƒ½åŠ›çš„æœ¯è¯­ã€‚</p>
<ul>
<li>è¯´â€œXå¯æ‰©å±•â€æˆ–â€œYä¸å¯æ‰©å±•â€. <code>X</code></li>
<li>â€œå¦‚æœç³»ç»Ÿä»¥ç‰¹å®šæ–¹å¼å¢é•¿ï¼Œæœ‰ä»€ä¹ˆé€‰é¡¹å¯ä»¥åº”å¯¹å¢é•¿ï¼Ÿâ€<code>âˆš</code></li>
<li>â€œå¦‚ä½•å¢åŠ è®¡ç®—èµ„æºæ¥å¤„ç†é¢å¤–çš„è´Ÿè½½ï¼Ÿâ€ç­‰é—®é¢˜ã€‚<code>âˆš</code></li>
</ul>
<h3 id="æè¿°è´Ÿè½½"><a href="#æè¿°è´Ÿè½½" class="headerlink" title="æè¿°è´Ÿè½½"></a>æè¿°è´Ÿè½½</h3><p>è´Ÿè½½å‚æ•°ï¼šä¾‹å¦‚ï¼šå‚æ•°çš„æœ€ä½³é€‰æ‹©å–å†³äºç³»ç»Ÿæ¶æ„ï¼Œå®ƒå¯èƒ½æ˜¯æ¯ç§’å‘WebæœåŠ¡å™¨å‘å‡ºçš„è¯·æ±‚ã€æ•°æ®åº“ä¸­çš„è¯»å†™æ¯”ç‡ã€èŠå¤©å®¤ä¸­åŒæ—¶æ´»è·ƒçš„ç”¨æˆ·æ•°é‡ã€ç¼“å­˜å‘½ä¸­ç‡æˆ–å…¶ä»–ä¸œè¥¿</p>
<p><code>fan-out</code>: æ‰‡å‡ºï¼šä»ç”µå­å·¥ç¨‹å­¦ä¸­å€Ÿç”¨çš„æœ¯è¯­ï¼Œå®ƒæè¿°äº†è¾“å…¥è¿æ¥åˆ°å¦ä¸€ä¸ªé—¨è¾“å‡ºçš„é€»è¾‘é—¨æ•°é‡ã€‚ è¾“å‡ºéœ€è¦æä¾›è¶³å¤Ÿçš„ç”µæµæ¥é©±åŠ¨æ‰€æœ‰è¿æ¥çš„è¾“å…¥ã€‚ åœ¨äº‹åŠ¡å¤„ç†ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒæ¥æè¿°ä¸ºäº†æœåŠ¡ä¸€ä¸ªä¼ å…¥è¯·æ±‚è€Œéœ€è¦æ‰§è¡Œå…¶ä»–æœåŠ¡çš„è¯·æ±‚æ•°é‡</p>
<h3 id="æè¿°æ€§èƒ½"><a href="#æè¿°æ€§èƒ½" class="headerlink" title="æè¿°æ€§èƒ½"></a>æè¿°æ€§èƒ½</h3><p><code>ååé‡ï¼ˆthroughputï¼‰</code>å³æ¯ç§’å¯ä»¥å¤„ç†çš„è®°å½•æ•°é‡ï¼Œæˆ–è€…åœ¨ç‰¹å®šè§„æ¨¡æ•°æ®é›†ä¸Šè¿è¡Œä½œä¸šçš„æ€»æ—¶é—´</p>
<p><code>å“åº”æ—¶é—´ï¼ˆresponse timeï¼‰</code>å³å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°æ¥æ”¶å“åº”ä¹‹é—´çš„æ—¶é—´ã€‚</p>
<blockquote>
<p><code>å»¶è¿Ÿï¼ˆlatencyï¼‰</code> å’Œ <code>å“åº”æ—¶é—´ï¼ˆresponse timeï¼‰</code> ç»å¸¸ç”¨ä½œåŒä¹‰è¯ï¼Œä½†å®é™…ä¸Šå®ƒä»¬å¹¶ä¸ä¸€æ ·ã€‚å“åº”æ—¶é—´æ˜¯å®¢æˆ·æ‰€çœ‹åˆ°çš„ï¼Œé™¤äº†å®é™…å¤„ç†è¯·æ±‚çš„æ—¶é—´ï¼ˆ <code>æœåŠ¡æ—¶é—´ï¼ˆservice timeï¼‰</code> ï¼‰ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬ç½‘ç»œå»¶è¿Ÿå’Œæ’é˜Ÿå»¶è¿Ÿã€‚å»¶è¿Ÿæ˜¯æŸä¸ªè¯·æ±‚ç­‰å¾…å¤„ç†çš„<code>æŒç»­æ—¶é•¿</code>ï¼Œåœ¨æ­¤æœŸé—´å®ƒå¤„äº <code>ä¼‘çœ ï¼ˆlatentï¼‰</code> çŠ¶æ€ï¼Œå¹¶ç­‰å¾…æœåŠ¡ã€‚</p>
</blockquote>
<p>ç™¾åˆ†ä½ç‚¹ï¼š<br>å¦‚æœæƒ³çŸ¥é“å…¸å‹åœºæ™¯ä¸‹ç”¨æˆ·éœ€è¦ç­‰å¾…å¤šé•¿æ—¶é—´ï¼Œé‚£ä¹ˆä¸­ä½æ•°æ˜¯ä¸€ä¸ªå¥½çš„åº¦é‡æ ‡å‡†ï¼šä¸€åŠç”¨æˆ·è¯·æ±‚çš„å“åº”æ—¶é—´å°‘äºå“åº”æ—¶é—´çš„ä¸­ä½æ•°ï¼Œå¦ä¸€åŠæœåŠ¡æ—¶é—´æ¯”ä¸­ä½æ•°é•¿ã€‚ä¸­ä½æ•°ä¹Ÿè¢«ç§°ä¸ºç¬¬50ç™¾åˆ†ä½ç‚¹ï¼Œæœ‰æ—¶ç¼©å†™ä¸ºp50ã€‚æ³¨æ„ä¸­ä½æ•°æ˜¯å…³äºå•ä¸ªè¯·æ±‚çš„ï¼›å¦‚æœç”¨æˆ·åŒæ—¶å‘å‡ºå‡ ä¸ªè¯·æ±‚ï¼ˆåœ¨ä¸€ä¸ªä¼šè¯è¿‡ç¨‹ä¸­ï¼Œæˆ–è€…ç”±äºä¸€ä¸ªé¡µé¢ä¸­åŒ…å«äº†å¤šä¸ªèµ„æºï¼‰ï¼Œåˆ™è‡³å°‘ä¸€ä¸ªè¯·æ±‚æ¯”ä¸­ä½æ•°æ…¢çš„æ¦‚ç‡è¿œå¤§äº50ï¼…ã€‚</p>
<p>â€‹ ç™¾åˆ†ä½ç‚¹é€šå¸¸ç”¨äº<code>æœåŠ¡çº§åˆ«ç›®æ ‡ï¼ˆSLO, service level objectivesï¼‰</code>å’Œ<code>æœåŠ¡çº§åˆ«åè®®ï¼ˆSLA, service level agreementsï¼‰</code>ï¼Œå³å®šä¹‰æœåŠ¡é¢„æœŸæ€§èƒ½å’Œå¯ç”¨æ€§çš„åˆåŒã€‚ SLAå¯èƒ½ä¼šå£°æ˜ï¼Œå¦‚æœæœåŠ¡å“åº”æ—¶é—´çš„ä¸­ä½æ•°å°äº200æ¯«ç§’ï¼Œä¸”99.9ç™¾åˆ†ä½ç‚¹ä½äº1ç§’ï¼Œåˆ™è®¤ä¸ºæœåŠ¡å·¥ä½œæ­£å¸¸ï¼ˆå¦‚æœå“åº”æ—¶é—´æ›´é•¿ï¼Œå°±è®¤ä¸ºæœåŠ¡ä¸è¾¾æ ‡ï¼‰ã€‚è¿™äº›æŒ‡æ ‡ä¸ºå®¢æˆ·è®¾å®šäº†æœŸæœ›å€¼ï¼Œå¹¶å…è®¸å®¢æˆ·åœ¨SLAæœªè¾¾æ ‡çš„æƒ…å†µä¸‹è¦æ±‚é€€æ¬¾ã€‚</p>
<p>åœ¨å¤šé‡è°ƒç”¨çš„åç«¯æœåŠ¡é‡Œï¼Œé«˜ç™¾åˆ†ä½æ•°å˜å¾—ç‰¹åˆ«é‡è¦ã€‚å³ä½¿å¹¶è¡Œè°ƒç”¨ï¼Œæœ€ç»ˆç”¨æˆ·è¯·æ±‚ä»ç„¶éœ€è¦ç­‰å¾…æœ€æ…¢çš„å¹¶è¡Œè°ƒç”¨å®Œæˆã€‚åªéœ€è¦ä¸€ä¸ªç¼“æ…¢çš„è°ƒç”¨å°±å¯ä»¥ä½¿æ•´ä¸ªæœ€ç»ˆç”¨æˆ·è¯·æ±‚å˜æ…¢ã€‚å³ä½¿åªæœ‰ä¸€å°éƒ¨åˆ†åç«¯è°ƒç”¨é€Ÿåº¦è¾ƒæ…¢ï¼Œå¦‚æœæœ€ç»ˆç”¨æˆ·è¯·æ±‚éœ€è¦å¤šä¸ªåç«¯è°ƒç”¨ï¼Œåˆ™è·å¾—è¾ƒæ…¢è°ƒç”¨çš„æœºä¼šä¹Ÿä¼šå¢åŠ ï¼Œå› æ­¤è¾ƒé«˜æ¯”ä¾‹çš„æœ€ç»ˆç”¨æˆ·è¯·æ±‚é€Ÿåº¦ä¼šå˜æ…¢ï¼ˆæ•ˆæœç§°ä¸ºå°¾éƒ¨å»¶è¿Ÿæ”¾å¤§ï¼‰ã€‚  </p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-chap1-reliability-scalability-maintainability-fig1-5.png" alt="fig1-5"></p>
<h3 id="åº”å¯¹è´Ÿè½½çš„æ–¹æ³•"><a href="#åº”å¯¹è´Ÿè½½çš„æ–¹æ³•" class="headerlink" title="åº”å¯¹è´Ÿè½½çš„æ–¹æ³•"></a>åº”å¯¹è´Ÿè½½çš„æ–¹æ³•</h3><p><code>çºµå‘æ‰©å±•ï¼ˆscaling upï¼‰</code>ï¼ˆ<code>å‚ç›´æ‰©å±•ï¼ˆvertical scalingï¼‰</code>): è½¬å‘æ›´å¼ºå¤§çš„æœºå™¨</p>
<p><code>æ¨ªå‘æ‰©å±•ï¼ˆscaling outï¼‰</code> ï¼ˆ<code>æ°´å¹³æ‰©å±•ï¼ˆhorizontal scalingï¼‰</code>):å°†è´Ÿè½½åˆ†å¸ƒåˆ°å¤šå°å°æœºå™¨ä¸Šä¹‹é—´çš„å¯¹ç«‹</p>
<p><code>å¼¹æ€§ï¼ˆelasticï¼‰</code> æ„å‘³ç€å¯ä»¥åœ¨æ£€æµ‹åˆ°è´Ÿè½½å¢åŠ æ—¶è‡ªåŠ¨å¢åŠ è®¡ç®—èµ„æºï¼Œè€Œå…¶ä»–ç³»ç»Ÿåˆ™æ˜¯æ‰‹åŠ¨æ‰©å±•ï¼ˆäººå·¥åˆ†æå®¹é‡å¹¶å†³å®šå‘ç³»ç»Ÿæ·»åŠ æ›´å¤šçš„æœºå™¨ï¼‰ã€‚å¦‚æœè´Ÿè½½æéš¾é¢„æµ‹ï¼ˆhighly unpredictableï¼‰ï¼Œåˆ™å¼¹æ€§ç³»ç»Ÿå¯èƒ½å¾ˆæœ‰ç”¨ï¼Œä½†æ‰‹åŠ¨æ‰©å±•ç³»ç»Ÿæ›´ç®€å•ï¼Œå¹¶ä¸”æ„å¤–æ“ä½œå¯èƒ½ä¼šæ›´å°‘</p>
<h2 id="å¯ç»´æŠ¤æ€§"><a href="#å¯ç»´æŠ¤æ€§" class="headerlink" title="å¯ç»´æŠ¤æ€§"></a>å¯ç»´æŠ¤æ€§</h2><p><code>å¯æ“ä½œæ€§ï¼ˆOperabilityï¼‰</code></p>
<p>â€‹ ä¾¿äºè¿ç»´å›¢é˜Ÿä¿æŒç³»ç»Ÿå¹³ç¨³è¿è¡Œã€‚</p>
<p><code>ç®€å•æ€§ï¼ˆSimplicityï¼‰</code></p>
<p>â€‹ ä»ç³»ç»Ÿä¸­æ¶ˆé™¤å°½å¯èƒ½å¤šçš„å¤æ‚åº¦ï¼ˆcomplexityï¼‰ï¼Œä½¿æ–°å·¥ç¨‹å¸ˆä¹Ÿèƒ½è½»æ¾ç†è§£ç³»ç»Ÿã€‚ï¼ˆæ³¨æ„è¿™å’Œç”¨æˆ·æ¥å£çš„ç®€å•æ€§ä¸ä¸€æ ·ã€‚ï¼‰</p>
<p><code>å¯æ¼”åŒ–æ€§ï¼ˆevolabilityï¼‰</code></p>
<p>â€‹ ä½¿å·¥ç¨‹å¸ˆåœ¨æœªæ¥èƒ½è½»æ¾åœ°å¯¹ç³»ç»Ÿè¿›è¡Œæ›´æ”¹ï¼Œå½“éœ€æ±‚å˜åŒ–æ—¶ä¸ºæ–°åº”ç”¨åœºæ™¯åšé€‚é…ã€‚ä¹Ÿç§°ä¸º<code>å¯æ‰©å±•æ€§ï¼ˆextensibilityï¼‰</code>ï¼Œ<code>å¯ä¿®æ”¹æ€§ï¼ˆmodifiabilityï¼‰</code>æˆ–<code>å¯å¡‘æ€§ï¼ˆplasticityï¼‰</code>ã€‚</p>
<h3 id="å¯æ“ä½œæ€§"><a href="#å¯æ“ä½œæ€§" class="headerlink" title="å¯æ“ä½œæ€§"></a>å¯æ“ä½œæ€§</h3><ul>
<li>é€šè¿‡è‰¯å¥½çš„ç›‘æ§ï¼Œæä¾›å¯¹ç³»ç»Ÿå†…éƒ¨çŠ¶æ€å’Œè¿è¡Œæ—¶è¡Œä¸ºçš„å¯è§æ€§ï¼ˆvisibilityï¼‰</li>
<li>ä¸ºè‡ªåŠ¨åŒ–æä¾›è‰¯å¥½æ”¯æŒï¼Œå°†ç³»ç»Ÿä¸æ ‡å‡†åŒ–å·¥å…·ç›¸é›†æˆ</li>
<li>é¿å…ä¾èµ–å•å°æœºå™¨ï¼ˆåœ¨æ•´ä¸ªç³»ç»Ÿç»§ç»­ä¸é—´æ–­è¿è¡Œçš„æƒ…å†µä¸‹å…è®¸æœºå™¨åœæœºç»´æŠ¤ï¼‰</li>
<li>æä¾›è‰¯å¥½çš„æ–‡æ¡£å’Œæ˜“äºç†è§£çš„æ“ä½œæ¨¡å‹ï¼ˆâ€œå¦‚æœåšXï¼Œä¼šå‘ç”ŸYâ€ï¼‰</li>
<li>æä¾›è‰¯å¥½çš„é»˜è®¤è¡Œä¸ºï¼Œä½†éœ€è¦æ—¶ä¹Ÿå…è®¸ç®¡ç†å‘˜è‡ªç”±è¦†ç›–é»˜è®¤å€¼</li>
<li>æœ‰æ¡ä»¶æ—¶è¿›è¡Œè‡ªæˆ‘ä¿®å¤ï¼Œä½†éœ€è¦æ—¶ä¹Ÿå…è®¸ç®¡ç†å‘˜æ‰‹åŠ¨æ§åˆ¶ç³»ç»ŸçŠ¶æ€</li>
<li>è¡Œä¸ºå¯é¢„æµ‹ï¼Œæœ€å¤§é™åº¦å‡å°‘æ„å¤–</li>
</ul>
<h3 id="ç®€å•æ€§ï¼šç®¡ç†å¤æ‚åº¦"><a href="#ç®€å•æ€§ï¼šç®¡ç†å¤æ‚åº¦" class="headerlink" title="ç®€å•æ€§ï¼šç®¡ç†å¤æ‚åº¦"></a>ç®€å•æ€§ï¼šç®¡ç†å¤æ‚åº¦</h3><p><code>å¤æ‚åº¦ï¼ˆcomplexityï¼‰</code> æœ‰å„ç§å¯èƒ½çš„ç—‡çŠ¶ï¼Œä¾‹å¦‚ï¼šçŠ¶æ€ç©ºé—´æ¿€å¢ã€æ¨¡å—é—´ç´§å¯†è€¦åˆã€çº ç»“çš„ä¾èµ–å…³ç³»ã€ä¸ä¸€è‡´çš„å‘½åå’Œæœ¯è¯­ã€è§£å†³æ€§èƒ½é—®é¢˜çš„Hackã€éœ€è¦ç»•å¼€çš„ç‰¹ä¾‹ç­‰ç­‰</p>
<p>â€‹ ç®€åŒ–ç³»ç»Ÿå¹¶ä¸ä¸€å®šæ„å‘³ç€å‡å°‘åŠŸèƒ½ï¼›å®ƒä¹Ÿå¯ä»¥æ„å‘³ç€æ¶ˆé™¤é¢å¤–çš„ï¼ˆaccidentalï¼‰çš„å¤æ‚åº¦ã€‚</p>
<p>ç”¨äºæ¶ˆé™¤é¢å¤–å¤æ‚åº¦çš„æœ€å¥½å·¥å…·ä¹‹ä¸€æ˜¯æŠ½è±¡ï¼ˆabstractionï¼‰ã€‚</p>
<h3 id="å¯æ¼”åŒ–æ€§ï¼šæ‹¥æŠ±å˜åŒ–"><a href="#å¯æ¼”åŒ–æ€§ï¼šæ‹¥æŠ±å˜åŒ–" class="headerlink" title="å¯æ¼”åŒ–æ€§ï¼šæ‹¥æŠ±å˜åŒ–"></a>å¯æ¼”åŒ–æ€§ï¼šæ‹¥æŠ±å˜åŒ–</h3><p>æ•æ·ï¼ˆagileï¼‰ å·¥ä½œæ¨¡å¼ä¸ºé€‚åº”å˜åŒ–æä¾›äº†ä¸€ä¸ªæ¡†æ¶</p>
<p>æ•æ·ç¤¾åŒºè¿˜å¼€å‘äº†å¯¹åœ¨é¢‘ç¹å˜åŒ–çš„ç¯å¢ƒä¸­å¼€å‘è½¯ä»¶å¾ˆæœ‰å¸®åŠ©çš„æŠ€æœ¯å·¥å…·å’Œæ¨¡å¼ï¼Œå¦‚ æµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDD, test-driven developmentï¼‰ å’Œ é‡æ„ï¼ˆrefactoringï¼‰ ã€‚</p>
]]></content>
      <categories>
        <category>DDIA</category>
      </categories>
      <tags>
        <tag>åˆ†å¸ƒå¼</tag>
        <tag>å¯é æ€§</tag>
        <tag>å¯æ‹“å±•æ€§</tag>
        <tag>å¯ç»´æŠ¤æ€§</tag>
      </tags>
  </entry>
  <entry>
    <title>[DDIA][ç¬¬äºŒç« ]ï¼šæ•°æ®æ¨¡å‹ä¸æŸ¥è¯¢è¯­è¨€</title>
    <url>/DDIA-ch2-data-model-and-search-language/</url>
    <content><![CDATA[<h1 id="ç¬¬äºŒç« "><a href="#ç¬¬äºŒç« " class="headerlink" title="ç¬¬äºŒç« "></a>ç¬¬äºŒç« </h1><h2 id="å…³ç³»æ¨¡å‹ä¸æ–‡æ¡£æ¨¡å‹"><a href="#å…³ç³»æ¨¡å‹ä¸æ–‡æ¡£æ¨¡å‹" class="headerlink" title="å…³ç³»æ¨¡å‹ä¸æ–‡æ¡£æ¨¡å‹"></a>å…³ç³»æ¨¡å‹ä¸æ–‡æ¡£æ¨¡å‹</h2><p>NoSQL(Not Only SQL)ï¼Œå‡ºç°çš„åŸå› ï¼š</p>
<ul>
<li>éœ€è¦æ¯”å…³ç³»æ•°æ®åº“æ›´å¥½çš„å¯æ‰©å±•æ€§ï¼ŒåŒ…æ‹¬éå¸¸å¤§çš„æ•°æ®é›†æˆ–éå¸¸é«˜çš„å†™å…¥ååé‡</li>
<li>ç›¸æ¯”å•†ä¸šæ•°æ®åº“äº§å“ï¼Œå…è´¹å’Œå¼€æºè½¯ä»¶æ›´å—åçˆ±ã€‚</li>
<li>å…³ç³»æ¨¡å‹ä¸èƒ½å¾ˆå¥½åœ°æ”¯æŒä¸€äº›ç‰¹æ®Šçš„æŸ¥è¯¢æ“ä½œ</li>
<li>å—æŒ«äºå…³ç³»æ¨¡å‹çš„é™åˆ¶æ€§ï¼Œæ¸´æœ›ä¸€ç§æ›´å…·å¤šåŠ¨æ€æ€§ä¸è¡¨ç°åŠ›çš„æ•°æ®æ¨¡å‹ã€‚</li>
</ul>
<p>å…³ç³»å‹æ•°æ®åº“ä¼šä¸å„ç§éå…³ç³»å‹æ•°æ®åº“ä¸€èµ·ä½¿ç”¨è¢«ç§°ä½œ<code>æ··åˆæŒä¹…åŒ–</code>ã€‚</p>
<h2 id="å¯¹è±¡å…³ç³»ä¸åŒ¹é…"><a href="#å¯¹è±¡å…³ç³»ä¸åŒ¹é…" class="headerlink" title="å¯¹è±¡å…³ç³»ä¸åŒ¹é…"></a>å¯¹è±¡å…³ç³»ä¸åŒ¹é…</h2><p>å¦‚æœæ•°æ®å­˜å‚¨åœ¨å…³ç³»è¡¨ä¸­ï¼Œé‚£ä¹ˆéœ€è¦ä¸€ä¸ªç¬¨æ‹™çš„è½¬æ¢å±‚ï¼Œå¤„äºåº”ç”¨ç¨‹åºä»£ç ä¸­çš„å¯¹è±¡å’Œè¡¨ï¼Œè¡Œï¼Œåˆ—çš„æ•°æ®åº“æ¨¡å‹ä¹‹é—´ã€‚æ¨¡å‹ä¹‹é—´çš„ä¸è¿è´¯æœ‰æ—¶è¢«ç§°ä¸ºé˜»æŠ—ä¸åŒ¹é…ï¼ˆimpedance mismatchï¼‰ã€‚</p>
<blockquote>
<p>ä¸€ä¸ªä»ç”µå­å­¦å€Ÿç”¨çš„æœ¯è¯­ã€‚æ¯ä¸ªç”µè·¯çš„è¾“å…¥å’Œè¾“å‡ºéƒ½æœ‰ä¸€å®šçš„é˜»æŠ—ï¼ˆäº¤æµç”µé˜»ï¼‰ã€‚å½“ä½ å°†ä¸€ä¸ªç”µè·¯çš„è¾“å‡ºè¿æ¥åˆ°å¦ä¸€ä¸ªç”µè·¯çš„è¾“å…¥æ—¶ï¼Œå¦‚æœä¸¤ä¸ªç”µè·¯çš„è¾“å‡ºå’Œè¾“å…¥é˜»æŠ—åŒ¹é…ï¼Œåˆ™è¿æ¥ä¸Šçš„åŠŸç‡ä¼ è¾“å°†è¢«æœ€å¤§åŒ–ã€‚é˜»æŠ—ä¸åŒ¹é…ä¼šå¯¼è‡´ä¿¡å·åå°„åŠå…¶ä»–é—®é¢˜ã€‚</p>
</blockquote>
<p><code>å¯¹è±¡å…³ç³»æ˜ å°„</code>ï¼ˆORM object-relational mappingï¼‰ æ¡†æ¶å¯ä»¥å‡å°‘è¿™ä¸ªè½¬æ¢å±‚æ‰€éœ€çš„æ ·æ¿ä»£ç çš„æ•°é‡ï¼Œä½†æ˜¯å®ƒä»¬ä¸èƒ½å®Œå…¨éšè—è¿™ä¸¤ä¸ªæ¨¡å‹ä¹‹é—´çš„å·®å¼‚ã€‚</p>
<h2 id="å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤š"><a href="#å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤š" class="headerlink" title="å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤š"></a>å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤š</h2><p>region_idå’Œindustry_idæ˜¯ä»¥IDï¼Œè€Œä¸æ˜¯çº¯å­—ç¬¦ä¸²â€œGreater Seattle Areaâ€å’Œâ€œPhilanthropyâ€çš„å½¢å¼ç»™å‡ºçš„ã€‚ä¸ºä»€ä¹ˆï¼Ÿ</p>
<p>å¦‚æœç”¨æˆ·ç•Œé¢ç”¨ä¸€ä¸ªè‡ªç”±æ–‡æœ¬å­—æ®µæ¥è¾“å…¥åŒºåŸŸå’Œè¡Œä¸šï¼Œé‚£ä¹ˆå°†ä»–ä»¬å­˜å‚¨ä¸ºçº¯æ–‡æœ¬å­—ç¬¦ä¸²æ˜¯åˆç†çš„ã€‚å¦ä¸€æ–¹å¼æ˜¯ç»™å‡ºåœ°ç†åŒºåŸŸå’Œè¡Œä¸šçš„æ ‡å‡†åŒ–çš„åˆ—è¡¨ï¼Œå¹¶è®©ç”¨æˆ·ä»ä¸‹æ‹‰åˆ—è¡¨æˆ–è‡ªåŠ¨å¡«å……å™¨ä¸­è¿›è¡Œé€‰æ‹©ï¼Œå…¶ä¼˜åŠ¿å¦‚ä¸‹ï¼š</p>
<ul>
<li>å„ä¸ªç®€ä»‹ä¹‹é—´æ ·å¼å’Œæ‹¼å†™ç»Ÿä¸€</li>
<li>é¿å…æ­§ä¹‰ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœæœ‰å‡ ä¸ªåŒåçš„åŸå¸‚ï¼‰</li>
<li>æ˜“äºæ›´æ–°â€”â€”åç§°åªå­˜å‚¨åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œå¦‚æœéœ€è¦æ›´æ”¹ï¼ˆä¾‹å¦‚ï¼Œç”±äºæ”¿æ²»äº‹ä»¶è€Œæ”¹å˜åŸå¸‚åç§°ï¼‰ï¼Œå¾ˆå®¹æ˜“è¿›è¡Œå…¨é¢æ›´æ–°ã€‚</li>
<li>æœ¬åœ°åŒ–æ”¯æŒâ€”â€”å½“ç½‘ç«™ç¿»è¯‘æˆå…¶ä»–è¯­è¨€æ—¶ï¼Œæ ‡å‡†åŒ–çš„åˆ—è¡¨å¯ä»¥è¢«æœ¬åœ°åŒ–ï¼Œä½¿å¾—åœ°åŒºå’Œè¡Œä¸šå¯ä»¥ä½¿ç”¨ç”¨æˆ·çš„è¯­è¨€æ¥æ˜¾ç¤º</li>
<li>æ›´å¥½çš„æœç´¢â€”â€”ä¾‹å¦‚ï¼Œæœç´¢åç››é¡¿å·çš„æ…ˆå–„å®¶å°±ä¼šåŒ¹é…è¿™ä»½ç®€ä»‹ï¼Œå› ä¸ºåœ°åŒºåˆ—è¡¨å¯ä»¥ç¼–ç è®°å½•è¥¿é›…å›¾åœ¨åç››é¡¿è¿™ä¸€äº‹å®</li>
</ul>
<p>ä½¿ç”¨IDçš„å¥½å¤„æ˜¯ï¼ŒIDå¯¹äººç±»æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå› è€Œæ°¸è¿œä¸éœ€è¦æ”¹å˜ï¼šIDå¯ä»¥ä¿æŒä¸å˜ï¼Œå³ä½¿å®ƒæ ‡è¯†çš„ä¿¡æ¯å‘ç”Ÿå˜åŒ–ã€‚ä»»ä½•å¯¹äººç±»æœ‰æ„ä¹‰çš„ä¸œè¥¿éƒ½å¯èƒ½éœ€è¦åœ¨å°†æ¥æŸä¸ªæ—¶å€™æ”¹å˜â€”â€”å¦‚æœè¿™äº›ä¿¡æ¯è¢«å¤åˆ¶ï¼Œæ‰€æœ‰çš„å†—ä½™å‰¯æœ¬éƒ½éœ€è¦æ›´æ–°ã€‚è¿™ä¼šå¯¼è‡´å†™å…¥å¼€é”€ï¼Œä¹Ÿå­˜åœ¨ä¸ä¸€è‡´çš„é£é™©ï¼ˆä¸€äº›å‰¯æœ¬è¢«æ›´æ–°äº†ï¼Œè¿˜æœ‰äº›å‰¯æœ¬æ²¡æœ‰è¢«æ›´æ–°ï¼‰ã€‚å»é™¤æ­¤ç±»é‡å¤æ˜¯æ•°æ®åº“ <code>è§„èŒƒåŒ–ï¼ˆnormalizationï¼‰</code> çš„å…³é”®æ€æƒ³ã€‚</p>
<blockquote>
<p>å…³äºå…³ç³»æ¨¡å‹çš„æ–‡çŒ®åŒºåˆ†äº†å‡ ç§ä¸åŒçš„è§„èŒƒå½¢å¼ï¼Œä½†è¿™äº›åŒºåˆ«å‡ ä¹æ²¡æœ‰å®é™…æ„ä¹‰ã€‚ä¸€ä¸ªç»éªŒæ³•åˆ™æ˜¯ï¼Œå¦‚æœé‡å¤å­˜å‚¨äº†å¯ä»¥å­˜å‚¨åœ¨ä¸€ä¸ªåœ°æ–¹çš„å€¼ï¼Œåˆ™æ¨¡å¼å°±ä¸æ˜¯è§„èŒƒåŒ–ï¼ˆnormalizedï¼‰çš„ã€‚</p>
</blockquote>
<h2 id="æ–‡æ¡£æ•°æ®åº“æ˜¯å¦åœ¨é‡è¹ˆè¦†è¾™ï¼Ÿ"><a href="#æ–‡æ¡£æ•°æ®åº“æ˜¯å¦åœ¨é‡è¹ˆè¦†è¾™ï¼Ÿ" class="headerlink" title="æ–‡æ¡£æ•°æ®åº“æ˜¯å¦åœ¨é‡è¹ˆè¦†è¾™ï¼Ÿ"></a>æ–‡æ¡£æ•°æ®åº“æ˜¯å¦åœ¨é‡è¹ˆè¦†è¾™ï¼Ÿ</h2><h3 id="å±‚æ¬¡æ¨¡å‹"><a href="#å±‚æ¬¡æ¨¡å‹" class="headerlink" title="å±‚æ¬¡æ¨¡å‹"></a>å±‚æ¬¡æ¨¡å‹</h3><ul>
<li>ï¼ˆ1ï¼‰æœ‰ä¸”åªæœ‰ä¸€ä¸ªç»“ç‚¹æ²¡æœ‰åŒäº²ç»“ç‚¹ï¼Œè¿™ä¸ªç»“ç‚¹ç§°ä¸ºæ ¹ç»“ç‚¹ï¼›</li>
<li>ï¼ˆ2ï¼‰æ ¹ä»¥å¤–çš„å…¶ä»–ç»“ç‚¹æœ‰ä¸”åªæœ‰ä¸€ä¸ªåŒäº²ç»“ç‚¹ä¸¤ä¸ªæ¡ä»¶çš„è®°å½•ä»¥åŠå®ƒä»¬ä¹‹é—´è”ç³»çš„é›†åˆä¸ºå±‚æ¬¡æ¨¡å‹</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch2-data-model-and-search-language-hierarchical-model.png" alt=""></p>
<p>å±‚æ¬¡æ¨¡å‹å®ƒä¸æ–‡æ¡£æ•°æ®åº“ä½¿ç”¨çš„JSONæ¨¡å‹æœ‰ç›¸ä¼¼ä¹‹å¤„ã€‚èƒ½è‰¯å¥½å¤„ç†å¥½ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œä½†æ˜¯å¾ˆéš¾åº”å¯¹å¤šå¯¹å¤šçš„å…³ç³»ï¼Œå¹¶ä¸”ä¸æ”¯æŒè¿æ¥ã€‚</p>
<p>ä¸ºäº†è§£å†³å±‚æ¬¡æ¨¡å‹çš„å±€é™æ€§ï¼Œæ¨å‡ºä¸¤ä¸ª<code>å…³ç³»æ¨¡å‹ï¼ˆrelational modelï¼‰</code>å’Œ<code>ç½‘ç»œæ¨¡å‹ï¼ˆnetwork model)</code></p>
<h3 id="ç½‘ç»œæ¨¡å‹"><a href="#ç½‘ç»œæ¨¡å‹" class="headerlink" title="ç½‘ç»œæ¨¡å‹"></a>ç½‘ç»œæ¨¡å‹</h3><p>ç½‘ç»œæ¨¡å‹ç”±ä¸€ä¸ªç§°ä¸ºæ•°æ®ç³»ç»Ÿè¯­è¨€ä¼šè®®ï¼ˆCODASYLï¼‰çš„å§”å‘˜ä¼šè¿›è¡Œäº†æ ‡å‡†åŒ–ï¼Œå¹¶è¢«æ•°ä¸ªä¸åŒçš„æ•°æ®åº“å•†å®ç°;å®ƒä¹Ÿè¢«ç§°ä¸ºCODASYLæ¨¡å‹ã€‚</p>
<p>CODASYLæ¨¡å‹æ˜¯å±‚æ¬¡æ¨¡å‹çš„æ¨å¹¿ã€‚åœ¨å±‚æ¬¡æ¨¡å‹çš„æ ‘ç»“æ„ä¸­ï¼Œæ¯æ¡è®°å½•åªæœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼›åœ¨ç½‘ç»œæ¨¡å¼ä¸­ï¼Œæ¯æ¡è®°å½•å¯èƒ½æœ‰å¤šä¸ªçˆ¶èŠ‚ç‚¹ã€‚</p>
<p>ç½‘ç»œæ¨¡å‹ä¸­è®°å½•ä¹‹é—´çš„é“¾æ¥ä¸æ˜¯å¤–é”®ï¼Œè€Œæ›´åƒç¼–ç¨‹è¯­è¨€ä¸­çš„æŒ‡é’ˆï¼ˆåŒæ—¶ä»ç„¶å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼‰ã€‚è®¿é—®è®°å½•çš„å”¯ä¸€æ–¹æ³•æ˜¯è·Ÿéšä»æ ¹è®°å½•èµ·æ²¿è¿™äº›é“¾è·¯æ‰€å½¢æˆçš„è·¯å¾„ã€‚è¿™è¢«ç§°ä¸º<code>è®¿é—®è·¯å¾„ï¼ˆaccess pathï¼‰</code>ã€‚</p>
<ul>
<li>æŸ¥è¯¢å’Œæ›´æ–°æ•°æ®åº“çš„ä»£ç å˜å¾—å¤æ‚ä¸çµæ´»</li>
<li>å¿…é¡»æµè§ˆå¤§é‡æ‰‹å†™æ•°æ®åº“æŸ¥è¯¢ä»£ç ï¼Œå¹¶é‡å†™æ¥å¤„ç†æ–°çš„è®¿é—®è·¯å¾„ã€‚</li>
<li>æ›´æ”¹åº”ç”¨ç¨‹åºçš„æ•°æ®æ¨¡å‹æ˜¯å¾ˆéš¾çš„ã€‚</li>
</ul>
<h3 id="å…³ç³»æ¨¡å‹"><a href="#å…³ç³»æ¨¡å‹" class="headerlink" title="å…³ç³»æ¨¡å‹"></a>å…³ç³»æ¨¡å‹</h3><p>ä¸€ä¸ª <code>å…³ç³»ï¼ˆè¡¨ï¼‰</code> åªæ˜¯ä¸€ä¸ª <code>å…ƒç»„ï¼ˆè¡Œï¼‰</code> çš„é›†åˆ</p>
<p>åœ¨å…³ç³»æ•°æ®åº“ä¸­ï¼ŒæŸ¥è¯¢ä¼˜åŒ–å™¨è‡ªåŠ¨å†³å®šæŸ¥è¯¢çš„å“ªäº›éƒ¨åˆ†ä»¥å“ªä¸ªé¡ºåºæ‰§è¡Œï¼Œä»¥åŠä½¿ç”¨å“ªäº›ç´¢å¼•</p>
<h2 id="å…³ç³»å‹æ•°æ®åº“ä¸æ–‡æ¡£æ•°æ®åº“å¯¹æ¯”"><a href="#å…³ç³»å‹æ•°æ®åº“ä¸æ–‡æ¡£æ•°æ®åº“å¯¹æ¯”" class="headerlink" title="å…³ç³»å‹æ•°æ®åº“ä¸æ–‡æ¡£æ•°æ®åº“å¯¹æ¯”"></a>å…³ç³»å‹æ•°æ®åº“ä¸æ–‡æ¡£æ•°æ®åº“å¯¹æ¯”</h2><ul>
<li>ç¤ºå¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„å…³ç³»æ—¶ï¼Œå…³ç³»æ•°æ®åº“å’Œæ–‡æ¡£æ•°æ®åº“å¹¶æ²¡æœ‰æ ¹æœ¬çš„ä¸åŒ</li>
<li>æ”¯æŒæ–‡æ¡£æ•°æ®æ¨¡å‹çš„ä¸»è¦è®ºæ®æ˜¯æ¶æ„çµæ´»æ€§ï¼Œå› å±€éƒ¨æ€§è€Œæ‹¥æœ‰æ›´å¥½çš„æ€§èƒ½ï¼Œä»¥åŠå¯¹äºæŸäº›åº”ç”¨ç¨‹åºè€Œè¨€æ›´æ¥è¿‘äºåº”ç”¨ç¨‹åºä½¿ç”¨çš„æ•°æ®ç»“æ„ã€‚</li>
<li>å…³ç³»æ¨¡å‹é€šè¿‡ä¸ºè¿æ¥æä¾›æ›´å¥½çš„æ”¯æŒä»¥åŠæ”¯æŒå¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„å…³ç³»æ¥åå‡»ã€‚</li>
</ul>
<p>å¦‚æœåº”ç”¨ç¨‹åºä¸­çš„æ•°æ®å…·æœ‰ç±»ä¼¼æ–‡æ¡£çš„ç»“æ„ï¼ˆå³ï¼Œä¸€å¯¹å¤šå…³ç³»æ ‘ï¼Œé€šå¸¸ä¸€æ¬¡æ€§åŠ è½½æ•´ä¸ªæ ‘ï¼‰ï¼Œé‚£ä¹ˆä½¿ç”¨æ–‡æ¡£æ¨¡å‹å¯èƒ½æ˜¯ä¸€ä¸ªå¥½ä¸»æ„</p>
<p>æ–‡æ¡£æ¨¡å‹æœ‰ä¸€å®šçš„å±€é™æ€§ï¼šä¾‹å¦‚ï¼Œä¸èƒ½ç›´æ¥å¼•ç”¨æ–‡æ¡£ä¸­çš„åµŒå¥—çš„é¡¹ç›®ï¼Œè€Œæ˜¯éœ€è¦è¯´â€œç”¨æˆ·251çš„ä½ç½®åˆ—è¡¨ä¸­çš„ç¬¬äºŒé¡¹â€ï¼ˆå¾ˆåƒåˆ†å±‚æ¨¡å‹ä¸­çš„è®¿é—®è·¯å¾„ï¼‰</p>
<h3 id="æ–‡æ¡£æ¨¡å‹çš„æ¶æ„çµæ´»æ€§"><a href="#æ–‡æ¡£æ¨¡å‹çš„æ¶æ„çµæ´»æ€§" class="headerlink" title="æ–‡æ¡£æ¨¡å‹çš„æ¶æ„çµæ´»æ€§"></a>æ–‡æ¡£æ¨¡å‹çš„æ¶æ„çµæ´»æ€§</h3><p>å¤§å¤šæ•°æ–‡æ¡£æ•°æ®åº“ä»¥åŠå…³ç³»æ•°æ®åº“ä¸­çš„JSONæ”¯æŒéƒ½ä¸ä¼šå¼ºåˆ¶æ–‡æ¡£ä¸­çš„æ•°æ®é‡‡ç”¨ä½•ç§æ¨¡å¼ã€‚å…³ç³»æ•°æ®åº“çš„XMLæ”¯æŒé€šå¸¸å¸¦æœ‰å¯é€‰çš„æ¨¡å¼éªŒè¯ã€‚æ²¡æœ‰æ¨¡å¼æ„å‘³ç€å¯ä»¥å°†ä»»æ„çš„é”®å’Œå€¼æ·»åŠ åˆ°æ–‡æ¡£ä¸­ï¼Œå¹¶ä¸”å½“è¯»å–æ—¶ï¼Œå®¢æˆ·ç«¯å¯¹æ— æ³•ä¿è¯æ–‡æ¡£å¯èƒ½åŒ…å«çš„å­—æ®µã€‚</p>
<p>æ–‡æ¡£æ•°æ®åº“æœ‰æ—¶ç§°ä¸º<code>æ— æ¨¡å¼ï¼ˆschemalessï¼‰</code>ï¼Œä½†è¿™å…·æœ‰è¯¯å¯¼æ€§ï¼Œå› ä¸ºè¯»å–æ•°æ®çš„ä»£ç é€šå¸¸å‡å®šæŸç§ç»“æ„â€”â€”å³å­˜åœ¨éšå¼æ¨¡å¼ï¼Œä½†ä¸ç”±æ•°æ®åº“å¼ºåˆ¶æ‰§è¡Œã€20ã€‘ã€‚ä¸€ä¸ªæ›´ç²¾ç¡®çš„æœ¯è¯­æ˜¯<code>è¯»æ—¶æ¨¡å¼ï¼ˆschema-on-readï¼‰</code>ï¼ˆæ•°æ®çš„ç»“æ„æ˜¯éšå«çš„ï¼Œåªæœ‰åœ¨æ•°æ®è¢«è¯»å–æ—¶æ‰è¢«è§£é‡Šï¼‰ï¼Œç›¸åº”çš„æ˜¯<code>å†™æ—¶æ¨¡å¼ï¼ˆschema-on-writeï¼‰</code>ï¼ˆä¼ ç»Ÿçš„å…³ç³»æ•°æ®åº“æ–¹æ³•ä¸­ï¼Œæ¨¡å¼æ˜ç¡®ï¼Œä¸”æ•°æ®åº“ç¡®ä¿æ‰€æœ‰çš„æ•°æ®éƒ½ç¬¦åˆå…¶æ¨¡å¼ï¼‰ã€‚</p>
<p>å¤§å¤šæ•°å…³ç³»æ•°æ®åº“ç³»ç»Ÿå¯åœ¨å‡ æ¯«ç§’å†…æ‰§è¡ŒALTER TABLEè¯­å¥ã€‚MySQLæ˜¯ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„ä¾‹å¤–ï¼Œå®ƒæ‰§è¡ŒALTER TABLEæ—¶ä¼šå¤åˆ¶æ•´ä¸ªè¡¨ï¼Œè¿™å¯èƒ½æ„å‘³ç€åœ¨æ›´æ”¹ä¸€ä¸ªå¤§å‹è¡¨æ—¶ä¼šèŠ±è´¹å‡ åˆ†é’Ÿç”šè‡³å‡ ä¸ªå°æ—¶çš„åœæœºæ—¶é—´</p>
<p>å¤§å‹è¡¨ä¸Šè¿è¡ŒUPDATEè¯­å¥åœ¨ä»»ä½•æ•°æ®åº“ä¸Šéƒ½å¯èƒ½ä¼šå¾ˆæ…¢ï¼Œå› ä¸ºæ¯ä¸€è¡Œéƒ½éœ€è¦é‡å†™ã€‚è¦æ˜¯ä¸å¯æ¥å—çš„è¯ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥å°†first_nameè®¾ç½®ä¸ºé»˜è®¤å€¼NULLï¼Œå¹¶åœ¨è¯»å–æ—¶å†å¡«å……ï¼Œå°±åƒä½¿ç”¨æ–‡æ¡£æ•°æ®åº“ä¸€æ ·ã€‚</p>
<h2 id="æ•°æ®æŸ¥è¯¢è¯­è¨€"><a href="#æ•°æ®æŸ¥è¯¢è¯­è¨€" class="headerlink" title="æ•°æ®æŸ¥è¯¢è¯­è¨€"></a>æ•°æ®æŸ¥è¯¢è¯­è¨€</h2><p>SQLæ˜¯ä¸€ç§ <code>å£°æ˜å¼</code> æŸ¥è¯¢è¯­è¨€ï¼Œè€ŒIMSå’ŒCODASYLä½¿ç”¨ <code>å‘½ä»¤å¼</code> ä»£ç æ¥æŸ¥è¯¢æ•°æ®åº“ã€‚</p>
<p>å‘½ä»¤å¼è¯­è¨€å‘Šè¯‰è®¡ç®—æœºä»¥ç‰¹å®šé¡ºåºæ‰§è¡ŒæŸäº›æ“ä½œã€‚å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œé€è¡Œåœ°éå†ä»£ç ï¼Œè¯„ä¼°æ¡ä»¶ï¼Œæ›´æ–°å˜é‡ï¼Œå¹¶å†³å®šæ˜¯å¦å†å¾ªç¯ä¸€éã€‚</p>
<p>åœ¨å£°æ˜å¼æŸ¥è¯¢è¯­è¨€ï¼ˆå¦‚SQLæˆ–å…³ç³»ä»£æ•°ï¼‰ä¸­ï¼Œä½ åªéœ€æŒ‡å®šæ‰€éœ€æ•°æ®çš„æ¨¡å¼ - ç»“æœå¿…é¡»ç¬¦åˆå“ªäº›æ¡ä»¶ï¼Œä»¥åŠå¦‚ä½•å°†æ•°æ®è½¬æ¢ï¼ˆä¾‹å¦‚ï¼Œæ’åºï¼Œåˆ†ç»„å’Œé›†åˆï¼‰ - ä½†ä¸æ˜¯å¦‚ä½•å®ç°è¿™ä¸€ç›®æ ‡ã€‚</p>
<p>å£°æ˜å¼è¯­è¨€æ›´å…·æœ‰å¹¶è¡Œæ‰§è¡Œçš„æ½œåŠ›ã€‚</p>
<h3 id="MapReduce"><a href="#MapReduce" class="headerlink" title="MapReduce"></a>MapReduce</h3><p>mapå’Œreduceå‡½æ•°åœ¨åŠŸèƒ½ä¸Šæœ‰æ‰€é™åˆ¶ï¼šå®ƒä»¬å¿…é¡»æ˜¯çº¯å‡½æ•°ï¼Œè¿™æ„å‘³ç€å®ƒä»¬åªä½¿ç”¨ä¼ é€’ç»™å®ƒä»¬çš„æ•°æ®ä½œä¸ºè¾“å…¥ï¼Œå®ƒä»¬ä¸èƒ½æ‰§è¡Œé¢å¤–çš„æ•°æ®åº“æŸ¥è¯¢ï¼Œä¹Ÿä¸èƒ½æœ‰ä»»ä½•å‰¯ä½œç”¨ã€‚è¿™äº›é™åˆ¶å…è®¸æ•°æ®åº“ä»¥ä»»ä½•é¡ºåºè¿è¡Œä»»ä½•åŠŸèƒ½ï¼Œå¹¶åœ¨å¤±è´¥æ—¶é‡æ–°è¿è¡Œå®ƒä»¬ã€‚ç„¶è€Œï¼Œmapå’Œreduceå‡½æ•°ä»ç„¶æ˜¯å¼ºå¤§çš„ï¼šå®ƒä»¬å¯ä»¥è§£æå­—ç¬¦ä¸²ï¼Œè°ƒç”¨åº“å‡½æ•°ï¼Œæ‰§è¡Œè®¡ç®—ç­‰ç­‰ã€‚</p>
<p>MapReduceæ˜¯ä¸€ä¸ªç›¸å½“åº•å±‚çš„ç¼–ç¨‹æ¨¡å‹ï¼Œç”¨äºè®¡ç®—æœºé›†ç¾¤ä¸Šçš„åˆ†å¸ƒå¼æ‰§è¡Œã€‚åƒSQLè¿™æ ·çš„æ›´é«˜çº§çš„æŸ¥è¯¢è¯­è¨€å¯ä»¥ç”¨ä¸€ç³»åˆ—çš„MapReduceæ“ä½œæ¥å®ç°ï¼ˆè§ç¬¬10ç« ï¼‰ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¾ˆå¤šä¸ä½¿ç”¨MapReduceçš„åˆ†å¸ƒå¼SQLå®ç°ã€‚è¯·æ³¨æ„ï¼ŒSQLä¸­æ²¡æœ‰ä»»ä½•å†…å®¹é™åˆ¶å®ƒåœ¨å•ä¸ªæœºå™¨ä¸Šè¿è¡Œï¼Œè€ŒMapReduceåœ¨åˆ†å¸ƒå¼æŸ¥è¯¢æ‰§è¡Œä¸Šæ²¡æœ‰å„æ–­æƒã€‚</p>
<h2 id="å›¾æ•°æ®åº“"><a href="#å›¾æ•°æ®åº“" class="headerlink" title="å›¾æ•°æ®åº“"></a>å›¾æ•°æ®åº“</h2><p>å›¾æ•°æ®åº“ç”¨æ¥å¤„ç†å¤šå¯¹å¤šå…³ç³»</p>
<p>ä¸€ä¸ªå›¾ç”±ä¸¤ç§å¯¹è±¡ç»„æˆï¼š<code>é¡¶ç‚¹ï¼ˆverticesï¼‰</code>ï¼ˆä¹Ÿç§°ä¸º<code>èŠ‚ç‚¹ï¼ˆnodesï¼‰</code> æˆ–<code>å®ä½“ï¼ˆentitiesï¼‰</code>ï¼‰ï¼Œå’Œ<code>è¾¹ï¼ˆedgesï¼‰</code>ï¼ˆ ä¹Ÿç§°ä¸º<code>å…³ç³»ï¼ˆrelationshipsï¼‰</code>æˆ–<code>å¼§ ï¼ˆarcsï¼‰</code> ï¼‰ã€‚å¤šç§æ•°æ®å¯ä»¥è¢«å»ºæ¨¡ä¸ºä¸€ä¸ªå›¾å½¢ã€‚</p>
<h3 id="å±æ€§å›¾"><a href="#å±æ€§å›¾" class="headerlink" title="å±æ€§å›¾"></a>å±æ€§å›¾</h3><p>æ¯ä¸ªé¡¶ç‚¹ï¼ˆvertexï¼‰åŒ…æ‹¬ï¼š</p>
<ul>
<li>å”¯ä¸€çš„æ ‡è¯†ç¬¦</li>
<li>ä¸€ç»„ <code>å‡ºè¾¹ï¼ˆoutgoing edgesï¼‰</code></li>
<li>ä¸€ç»„ <code>å…¥è¾¹ï¼ˆingoing edgesï¼‰</code></li>
<li>ä¸€ç»„å±æ€§ï¼ˆé”®å€¼å¯¹ï¼‰</li>
</ul>
<p>æ¯æ¡ è¾¹ï¼ˆedgeï¼‰ åŒ…æ‹¬ï¼š</p>
<ul>
<li>å”¯ä¸€æ ‡è¯†ç¬¦</li>
<li>è¾¹çš„èµ·ç‚¹/å°¾éƒ¨é¡¶ç‚¹ï¼ˆtail vertexï¼‰</li>
<li>è¾¹çš„ç»ˆç‚¹/å¤´éƒ¨é¡¶ç‚¹ï¼ˆhead vertexï¼‰</li>
<li>æè¿°ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´å…³ç³»ç±»å‹çš„æ ‡ç­¾</li>
<li>ä¸€ç»„å±æ€§ï¼ˆé”®å€¼å¯¹ï¼‰</li>
</ul>
<h3 id="Cypher-æŸ¥è¯¢è¯­è¨€"><a href="#Cypher-æŸ¥è¯¢è¯­è¨€" class="headerlink" title="Cypher æŸ¥è¯¢è¯­è¨€"></a>Cypher æŸ¥è¯¢è¯­è¨€</h3><p>Cypheræ˜¯å±æ€§å›¾çš„å£°æ˜å¼æŸ¥è¯¢è¯­è¨€ï¼Œä¸ºNeo4jå›¾å½¢æ•°æ®åº“è€Œå‘æ˜</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE</span><br><span class="line">    (NAmerica:Location &#123;name:&#39;North America&#39;, type:&#39;continent&#39;&#125;),</span><br><span class="line">    (USA:Location      &#123;name:&#39;United States&#39;, type:&#39;country&#39;  &#125;),</span><br><span class="line">    (Idaho:Location    &#123;name:&#39;Idaho&#39;,         type:&#39;state&#39;    &#125;),</span><br><span class="line">    (Lucy:Person       &#123;name:&#39;Lucy&#39; &#125;),</span><br><span class="line">    (Idaho) -[:WITHIN]-&gt;  (USA)  -[:WITHIN]-&gt; (NAmerica),</span><br><span class="line">    (Lucy)  -[:BORN_IN]-&gt; (Idaho)</span><br></pre></td></tr></table></figure>
<p>ï¼ˆIdahoï¼‰ - [ï¼šWITHIN] -&gt;ï¼ˆUSAï¼‰åˆ›å»ºä¸€æ¡æ ‡è®°ä¸ºWITHINçš„è¾¹ï¼ŒIdahoä¸ºå°¾èŠ‚ç‚¹ï¼ŒUSAä¸ºå¤´èŠ‚ç‚¹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; æŸ¥æ‰¾æ‰€æœ‰ä»ç¾å›½ç§»æ°‘åˆ°æ¬§æ´²çš„äººçš„CypheræŸ¥è¯¢</span><br><span class="line">MATCH</span><br><span class="line">    (person) -[:BORN_IN]-&gt;  () -[:WITHIN*0..]-&gt; (us:Location &#123;name:&#39;United States&#39;&#125;),</span><br><span class="line">    (person) -[:LIVES_IN]-&gt; () -[:WITHIN*0..]-&gt; (eu:Location &#123;name:&#39;Europe&#39;&#125;)</span><br><span class="line">RETURN person.name</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä¾‹å­çš„æ„æ€æ˜¯ï¼Œ<br>æ‰¾åˆ°æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶çš„æ‰€æœ‰é¡¶ç‚¹ï¼ˆç§°ä¹‹ä¸ºpersoné¡¶ç‚¹ï¼‰ï¼š</p>
<ol>
<li><p>personé¡¶ç‚¹æ‹¥æœ‰ä¸€æ¡åˆ°æŸä¸ªé¡¶ç‚¹çš„BORN_INå‡ºè¾¹ã€‚ä»é‚£ä¸ªé¡¶ç‚¹å¼€å§‹ï¼Œæ²¿ç€ä¸€ç³»åˆ—WITHINå‡ºè¾¹æœ€ç»ˆåˆ°è¾¾ä¸€ä¸ªç±»å‹ä¸ºLocationï¼Œnameå±æ€§ä¸ºUnited Statesçš„é¡¶ç‚¹ã€‚</p>
</li>
<li><p>personé¡¶ç‚¹è¿˜æ‹¥æœ‰ä¸€æ¡LIVES_INå‡ºè¾¹ã€‚æ²¿ç€è¿™æ¡è¾¹ï¼Œå¯ä»¥é€šè¿‡ä¸€ç³»åˆ—WITHINå‡ºè¾¹æœ€ç»ˆåˆ°è¾¾ä¸€ä¸ªç±»å‹ä¸ºLocationï¼Œnameå±æ€§ä¸ºEuropeçš„é¡¶ç‚¹ã€‚</p>
</li>
</ol>
<p>å¯¹äºè¿™æ ·çš„Personé¡¶ç‚¹ï¼Œè¿”å›å…¶nameå±æ€§ã€‚</p>
<h2 id="ä¸‰å…ƒç»„å­˜å‚¨å’ŒSPARQL"><a href="#ä¸‰å…ƒç»„å­˜å‚¨å’ŒSPARQL" class="headerlink" title="ä¸‰å…ƒç»„å­˜å‚¨å’ŒSPARQL"></a>ä¸‰å…ƒç»„å­˜å‚¨å’ŒSPARQL</h2><p>ä¸‰å…ƒç»„å­˜å‚¨ä¸­ï¼Œæ‰€æœ‰ä¿¡æ¯éƒ½ä»¥éå¸¸ç®€å•çš„ä¸‰éƒ¨åˆ†è¡¨ç¤ºå½¢å¼å­˜å‚¨ï¼ˆä¸»è¯­ï¼Œè°“è¯­ï¼Œå®¾è¯­ï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸‰å…ƒç»„ (å‰å§†, å–œæ¬¢ ,é¦™è•‰) ä¸­ï¼Œå‰å§† æ˜¯ä¸»è¯­ï¼Œå–œæ¬¢ æ˜¯è°“è¯­ï¼ˆåŠ¨è¯ï¼‰ï¼Œé¦™è•‰ æ˜¯å¯¹è±¡ã€‚</p>
<ul>
<li>åŸå§‹æ•°æ®ç±»å‹ä¸­çš„å€¼ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²æˆ–æ•°å­—ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸‰å…ƒç»„çš„è°“è¯­å’Œå®¾è¯­ç›¸å½“äºä¸»è¯­é¡¶ç‚¹ä¸Šçš„å±æ€§çš„é”®å’Œå€¼ã€‚ä¾‹å¦‚ï¼Œ(lucy, age, 33)å°±åƒå±æ€§{â€œageâ€ï¼š33}çš„é¡¶ç‚¹lucyã€‚</li>
<li>å›¾ä¸­çš„å¦ä¸€ä¸ªé¡¶ç‚¹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè°“è¯­æ˜¯å›¾ä¸­çš„ä¸€æ¡è¾¹ï¼Œä¸»è¯­æ˜¯å…¶å°¾éƒ¨é¡¶ç‚¹ï¼Œè€Œå®¾è¯­æ˜¯å…¶å¤´éƒ¨é¡¶ç‚¹ã€‚ä¾‹å¦‚ï¼Œåœ¨(lucy, marriedTo, alain)ä¸­ä¸»è¯­å’Œå®¾è¯­lucyå’Œalainéƒ½æ˜¯é¡¶ç‚¹ï¼Œå¹¶ä¸”è°“è¯­marriedToæ˜¯è¿æ¥ä»–ä»¬çš„è¾¹çš„æ ‡ç­¾ã€‚</li>
</ul>
<h3 id="RDFæ•°æ®æ¨¡å‹"><a href="#RDFæ•°æ®æ¨¡å‹" class="headerlink" title="RDFæ•°æ®æ¨¡å‹"></a>RDFæ•°æ®æ¨¡å‹</h3><h3 id="SPARQLæŸ¥è¯¢è¯­è¨€"><a href="#SPARQLæŸ¥è¯¢è¯­è¨€" class="headerlink" title="SPARQLæŸ¥è¯¢è¯­è¨€"></a>SPARQLæŸ¥è¯¢è¯­è¨€</h3><p>SPARQLæ˜¯ä¸€ç§ç”¨äºä¸‰å…ƒç»„å­˜å‚¨çš„é¢å‘RDFæ•°æ®æ¨¡å‹çš„æŸ¥è¯¢è¯­è¨€ã€‚</p>
<h3 id="Datalog"><a href="#Datalog" class="headerlink" title="Datalog"></a>Datalog</h3><p>Datalogæ˜¯æ¯”SPARQLæˆ–Cypheræ›´å¤è€çš„è¯­è¨€</p>
<p>Datalogçš„æ•°æ®æ¨¡å‹ç±»ä¼¼äºä¸‰å…ƒç»„æ¨¡å¼ï¼Œä½†è¿›è¡Œäº†ä¸€ç‚¹æ³›åŒ–ã€‚æŠŠä¸‰å…ƒç»„å†™æˆè°“è¯­ï¼ˆä¸»è¯­ï¼Œå®¾è¯­ï¼‰ï¼Œè€Œä¸æ˜¯å†™ä¸‰å…ƒè¯­ï¼ˆä¸»è¯­ï¼Œè°“è¯­ï¼Œå®¾è¯­ï¼‰</p>
]]></content>
      <categories>
        <category>DDIA</category>
      </categories>
      <tags>
        <tag>åˆ†å¸ƒå¼</tag>
        <tag>æ•°æ®åº“</tag>
        <tag>æŸ¥è¯¢è¯­è¨€</tag>
      </tags>
  </entry>
  <entry>
    <title>[DDIA][ç¬¬ä¸‰ç« ]ï¼šå­˜å‚¨ä¸æ£€ç´¢</title>
    <url>/DDIA-ch3-storage-and-retrieval/</url>
    <content><![CDATA[<h1 id="ç¬¬ä¸‰ç« "><a href="#ç¬¬ä¸‰ç« " class="headerlink" title="ç¬¬ä¸‰ç« "></a>ç¬¬ä¸‰ç« </h1><p>è¿™é‡Œå°†ä¼šç ”ç©¶ä¸¤å¤§ç±»å­˜å‚¨å¼•æ“ï¼š<code>æ—¥å¿—ç»“æ„ï¼ˆlog-structredï¼‰</code>çš„å­˜å‚¨å¼•æ“ï¼Œä»¥åŠ<code>é¢å‘é¡µé¢ï¼ˆpage-orientedï¼‰</code>çš„å­˜å‚¨å¼•æ“ï¼ˆä¾‹å¦‚Bæ ‘ï¼‰ã€‚</p>
<h2 id="é©±åŠ¨æ•°æ®åº“çš„æ•°æ®ç»“æ„"><a href="#é©±åŠ¨æ•°æ®åº“çš„æ•°æ®ç»“æ„" class="headerlink" title="é©±åŠ¨æ•°æ®åº“çš„æ•°æ®ç»“æ„"></a>é©±åŠ¨æ•°æ®åº“çš„æ•°æ®ç»“æ„</h2><p>ä¸–ç•Œä¸Šæœ€ç®€å•çš„æ•°æ®åº“</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="function"><span class="title">db_set</span></span> () &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$1</span>,<span class="variable">$2</span>"</span> &gt;&gt; database</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">db_get</span></span> () &#123;</span><br><span class="line">    grep <span class="string">"^<span class="variable">$1</span>,"</span> database | sed -e <span class="string">"s/^<span class="variable">$1</span>,//"</span> | tail -n 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œ<code>db_set key value</code>ï¼Œä¼šå°†keyå’Œvalueå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚<br>è°ƒç”¨<code>db_get key</code>ï¼ŒæŸ¥è¯¢è¯¥keyå…³è”çš„value</p>
<p>åœ¨æ–‡ä»¶å°¾éƒ¨è¿½åŠ å†™å…¥é€šå¸¸æ˜¯éå¸¸é«˜æ•ˆçš„</p>
<p>å¦‚æœè¯¥æ•°æ®åº“ä¸­æœ‰å¤§é‡çš„è®°å½•ï¼Œé‚£ä¹ˆ<code>db_get</code>çš„æ•ˆç‡ä¼šéå¸¸ä½ï¼ŒæŸ¥æ‰¾çš„å¼€é”€ä¸º<code>O(n)</code>ã€‚æ‰€ä»¥ä¸ºäº†æé«˜æŸ¥æ‰¾æ•ˆç‡å¢åŠ äº†ä¸€ä¸ªæ–°çš„æ•°æ®ç»“æ„ï¼š<code>ç´¢å¼•ï¼ˆindexï¼‰</code>ã€‚</p>
<p>ç´¢å¼•çš„å¤§è‡´æ€æƒ³å°±æ˜¯ï¼šä¿å­˜ä¸€äº›é¢å¤–çš„å…ƒæ•°æ®ä½œä¸ºè·¯æ ‡ï¼Œå¸®åŠ©ä½ æ‰¾åˆ°æƒ³è¦çš„æ•°æ®ã€‚</p>
<p>ç´¢å¼•æ˜¯ä»ä¸»æ•°æ®è¡ç”Ÿçš„<code>é™„åŠ ï¼ˆadditionalï¼‰</code>ç»“æ„ã€‚è®¸å¤šæ•°æ®åº“å…è®¸æ·»åŠ ä¸åˆ é™¤ç´¢å¼•ï¼Œè¿™ä¸ä¼šå½±å“æ•°æ®çš„å†…å®¹ï¼Œå®ƒåªå½±å“æŸ¥è¯¢çš„æ€§èƒ½ã€‚ä»»ä½•ç±»å‹çš„ç´¢å¼•é€šå¸¸éƒ½ä¼šå‡æ…¢å†™å…¥é€Ÿåº¦ï¼Œå› ä¸ºæ¯æ¬¡å†™å…¥æ•°æ®æ—¶éƒ½éœ€è¦æ›´æ–°ç´¢å¼•ã€‚</p>
<p>è¿™æ˜¯å­˜å‚¨ç³»ç»Ÿä¸­ä¸€ä¸ªé‡è¦çš„æƒè¡¡ï¼š<code>ç²¾å¿ƒé€‰æ‹©çš„ç´¢å¼•åŠ å¿«äº†è¯»æŸ¥è¯¢çš„é€Ÿåº¦ï¼Œä½†æ˜¯æ¯ä¸ªç´¢å¼•éƒ½ä¼šæ‹–æ…¢å†™å…¥é€Ÿåº¦</code>ã€‚å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæ•°æ®åº“é»˜è®¤å¹¶ä¸ä¼šç´¢å¼•æ‰€æœ‰çš„å†…å®¹ï¼Œè€Œéœ€è¦ä½ ï¼ˆç¨‹åºå‘˜æˆ–DBAï¼‰é€šè¿‡å¯¹åº”ç”¨æŸ¥è¯¢æ¨¡å¼çš„äº†è§£æ¥æ‰‹åŠ¨é€‰æ‹©ç´¢å¼•ã€‚</p>
<h3 id="å“ˆå¸Œç´¢å¼•"><a href="#å“ˆå¸Œç´¢å¼•" class="headerlink" title="å“ˆå¸Œç´¢å¼•"></a>å“ˆå¸Œç´¢å¼•</h3><p>æœ€ç®€å•çš„ç´¢å¼•ç­–ç•¥å°±æ˜¯ï¼šä¿ç•™ä¸€ä¸ªå†…å­˜ä¸­çš„å“ˆå¸Œæ˜ å°„ï¼Œå…¶ä¸­æ¯ä¸ªé”®éƒ½æ˜ å°„åˆ°ä¸€ä¸ªæ•°æ®æ–‡ä»¶ä¸­çš„å­—èŠ‚åç§»é‡ï¼ŒæŒ‡æ˜äº†å¯ä»¥æ‰¾åˆ°å¯¹åº”å€¼çš„ä½ç½®</p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch3-3-1.png" alt="3-1"></p>
<p><a href="https://github.com/basho/bitcask" target="_blank" rel="noopener">Bitcask</a>æä¾›é«˜æ€§èƒ½çš„è¯»å–å’Œå†™å…¥æ“ä½œï¼Œä½†æ‰€æœ‰é”®å¿…é¡»èƒ½æ”¾å…¥å¯ç”¨å†…å­˜ä¸­ï¼Œå› ä¸ºå“ˆå¸Œæ˜ å°„å®Œå…¨ä¿ç•™åœ¨å†…å­˜ä¸­ã€‚è¿™äº›å€¼å¯ä»¥ä½¿ç”¨æ¯”å¯ç”¨å†…å­˜æ›´å¤šçš„ç©ºé—´ï¼Œå› ä¸ºå¯ä»¥ä»ç£ç›˜ä¸Šé€šè¿‡ä¸€æ¬¡seekåŠ è½½æ‰€éœ€éƒ¨åˆ†ï¼Œå¦‚æœæ•°æ®æ–‡ä»¶çš„é‚£éƒ¨åˆ†å·²ç»åœ¨æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ä¸­ï¼Œåˆ™è¯»å–æ ¹æœ¬ä¸éœ€è¦ä»»ä½•ç£ç›˜I/Oã€‚</p>
<p>é¿å…æœ€ç»ˆç”¨å®Œç£ç›˜ç©ºé—´ï¼šå°†æ—¥å¿—åˆ†ä¸ºç‰¹å®šå¤§å°çš„æ®µï¼Œå½“æ—¥å¿—å¢é•¿åˆ°ç‰¹å®šå°ºå¯¸æ—¶å…³é—­å½“å‰æ®µæ–‡ä»¶ï¼Œå¹¶å¼€å§‹å†™å…¥ä¸€ä¸ªæ–°çš„æ®µæ–‡ä»¶ã€‚ç„¶åï¼Œå°±å¯ä»¥å¯¹è¿™äº›æ®µè¿›è¡Œ<code>å‹ç¼©ï¼ˆcompactionï¼‰</code>å‹ç¼©æ„å‘³ç€åœ¨æ—¥å¿—ä¸­ä¸¢å¼ƒé‡å¤çš„é”®ï¼Œåªä¿ç•™æ¯ä¸ªé”®çš„æœ€è¿‘æ›´æ–°ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch3-3-2.png" alt="3-2"></p>
<p>è€Œä¸”ï¼Œç”±äºå‹ç¼©ç»å¸¸ä¼šä½¿å¾—æ®µå˜å¾—å¾ˆå°ï¼ˆå‡è®¾åœ¨ä¸€ä¸ªæ®µå†…é”®è¢«å¹³å‡é‡å†™äº†å¥½å‡ æ¬¡ï¼‰ï¼Œä¹Ÿå¯ä»¥åœ¨æ‰§è¡Œå‹ç¼©çš„åŒæ—¶å°†å¤šä¸ªæ®µåˆå¹¶åœ¨ä¸€èµ·ï¼Œå†»ç»“æ®µçš„åˆå¹¶å’Œå‹ç¼©å¯ä»¥åœ¨åå°çº¿ç¨‹ä¸­å®Œæˆï¼Œåœ¨è¿›è¡Œæ—¶ï¼Œä»ç„¶å¯ä»¥ç»§ç»­ä½¿ç”¨æ—§çš„æ®µæ–‡ä»¶æ¥æ­£å¸¸æä¾›è¯»å†™è¯·æ±‚ã€‚åˆå¹¶è¿‡ç¨‹å®Œæˆåï¼Œæˆ‘ä»¬å°†è¯»å–è¯·æ±‚è½¬æ¢ä¸ºä½¿ç”¨æ–°çš„åˆå¹¶æ®µï¼Œç„¶åå¯ä»¥åˆ é™¤æ—§çš„æ®µæ–‡ä»¶ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch3-3-3.png" alt="3-3"></p>
<p>æ¯ä¸ªæ®µç°åœ¨éƒ½æœ‰è‡ªå·±çš„å†…å­˜æ•£åˆ—è¡¨ï¼Œå°†é”®æ˜ å°„åˆ°æ–‡ä»¶åç§»é‡ã€‚ä¸ºäº†æ‰¾åˆ°ä¸€ä¸ªé”®çš„å€¼ï¼Œæˆ‘ä»¬é¦–å…ˆæ£€æŸ¥æœ€è¿‘æ®µçš„å“ˆå¸Œæ˜ å°„;å¦‚æœé”®ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬æ£€æŸ¥ç¬¬äºŒä¸ªæœ€è¿‘çš„æ®µï¼Œä¾æ­¤ç±»æ¨ã€‚ä¸è¿‡å…¶ä¸­æœ‰ä¸€äº›é—®é¢˜ï¼š</p>
<h4 id="æ–‡ä»¶æ ¼å¼"><a href="#æ–‡ä»¶æ ¼å¼" class="headerlink" title="æ–‡ä»¶æ ¼å¼"></a>æ–‡ä»¶æ ¼å¼</h4><p>â€‹CSVä¸æ˜¯æ—¥å¿—çš„æœ€ä½³æ ¼å¼ã€‚ä½¿ç”¨äºŒè¿›åˆ¶æ ¼å¼æ›´å¿«ï¼Œæ›´ç®€å•ï¼Œé¦–å…ˆä»¥å­—èŠ‚ä¸ºå•ä½å¯¹å­—ç¬¦ä¸²çš„é•¿åº¦è¿›è¡Œç¼–ç ï¼Œç„¶åä½¿ç”¨åŸå§‹å­—ç¬¦ä¸²ï¼ˆä¸éœ€è¦è½¬ä¹‰ï¼‰ã€‚</p>
<h4 id="åˆ é™¤è®°å½•"><a href="#åˆ é™¤è®°å½•" class="headerlink" title="åˆ é™¤è®°å½•"></a>åˆ é™¤è®°å½•</h4><p>å¦‚æœè¦åˆ é™¤ä¸€ä¸ªé”®åŠå…¶å…³è”çš„å€¼ï¼Œåˆ™å¿…é¡»åœ¨æ•°æ®æ–‡ä»¶ï¼ˆæœ‰æ—¶ç§°ä¸ºé€»è¾‘åˆ é™¤ï¼‰ä¸­é™„åŠ ä¸€ä¸ªç‰¹æ®Šçš„åˆ é™¤è®°å½•ã€‚å½“æ—¥å¿—æ®µè¢«åˆå¹¶æ—¶ï¼Œé€»è¾‘åˆ é™¤å‘Šè¯‰åˆå¹¶è¿‡ç¨‹æ”¾å¼ƒåˆ é™¤é”®çš„ä»»ä½•ä»¥å‰çš„å€¼ã€‚</p>
<h4 id="å´©æºƒè®°å½•"><a href="#å´©æºƒè®°å½•" class="headerlink" title="å´©æºƒè®°å½•"></a>å´©æºƒè®°å½•</h4><p>å¦‚æœæ•°æ®åº“é‡æ–°å¯åŠ¨ï¼Œåˆ™å†…å­˜æ•£åˆ—æ˜ å°„å°†ä¸¢å¤±ã€‚åŸåˆ™ä¸Šï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»å¤´åˆ°å°¾è¯»å–æ•´ä¸ªæ®µæ–‡ä»¶å¹¶åœ¨æ¯æ¬¡æŒ‰é”®æ—¶æ³¨æ„æ¯ä¸ªé”®çš„æœ€è¿‘å€¼çš„åç§»é‡æ¥æ¢å¤æ¯ä¸ªæ®µçš„å“ˆå¸Œæ˜ å°„ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ®µæ–‡ä»¶å¾ˆå¤§ï¼Œè¿™å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œè¿™å°†ä½¿æœåŠ¡å™¨é‡æ–°å¯åŠ¨ç—›è‹¦ã€‚ Bitcaské€šè¿‡å­˜å‚¨åŠ é€Ÿæ¢å¤ç£ç›˜ä¸Šæ¯ä¸ªæ®µçš„å“ˆå¸Œæ˜ å°„çš„å¿«ç…§ï¼Œå¯ä»¥æ›´å¿«åœ°åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</p>
<h4 id="éƒ¨åˆ†å†™å…¥è®°å½•"><a href="#éƒ¨åˆ†å†™å…¥è®°å½•" class="headerlink" title="éƒ¨åˆ†å†™å…¥è®°å½•"></a>éƒ¨åˆ†å†™å…¥è®°å½•</h4><p>æ•°æ®åº“å¯èƒ½éšæ—¶å´©æºƒï¼ŒåŒ…æ‹¬å°†è®°å½•é™„åŠ åˆ°æ—¥å¿—ä¸­é€”ã€‚ Bitcaskæ–‡ä»¶åŒ…å«æ ¡éªŒå’Œï¼Œå…è®¸æ£€æµ‹å’Œå¿½ç•¥æ—¥å¿—çš„è¿™äº›æŸåéƒ¨åˆ†ã€‚</p>
<h4 id="å¹¶å‘æ§åˆ¶"><a href="#å¹¶å‘æ§åˆ¶" class="headerlink" title="å¹¶å‘æ§åˆ¶"></a>å¹¶å‘æ§åˆ¶</h4><p>ç”±äºå†™æ“ä½œæ˜¯ä»¥ä¸¥æ ¼é¡ºåºçš„é¡ºåºé™„åŠ åˆ°æ—¥å¿—ä¸­çš„ï¼Œæ‰€ä»¥å¸¸è§çš„å®ç°é€‰æ‹©æ˜¯åªæœ‰ä¸€ä¸ªå†™å…¥å™¨çº¿ç¨‹ã€‚æ•°æ®æ–‡ä»¶æ®µæ˜¯é™„åŠ çš„ï¼Œæˆ–è€…æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥å®ƒä»¬å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å–ã€‚</p>
<p>ä¹ä¸€çœ‹ï¼Œåªæœ‰è¿½åŠ æ—¥å¿—çœ‹èµ·æ¥å¾ˆæµªè´¹ï¼šä¸ºä»€ä¹ˆä¸æ›´æ–°æ–‡ä»¶ï¼Œç”¨æ–°å€¼è¦†ç›–æ—§å€¼ï¼Ÿä½†æ˜¯åªèƒ½è¿½åŠ è®¾è®¡çš„åŸå› æœ‰å‡ ä¸ªï¼š</p>
<ul>
<li>è¿½åŠ å’Œåˆ†æ®µåˆå¹¶æ˜¯é¡ºåºå†™å…¥æ“ä½œï¼Œé€šå¸¸æ¯”éšæœºå†™å…¥å¿«å¾—å¤šï¼Œå°¤å…¶æ˜¯åœ¨ç£ç›˜æ—‹è½¬ç¡¬ç›˜ä¸Šã€‚åœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œé¡ºåºå†™å…¥åœ¨åŸºäºé—ªå­˜çš„ å›ºæ€ç¡¬ç›˜ï¼ˆSSDï¼‰ ä¸Šä¹Ÿæ˜¯ä¼˜é€‰çš„</li>
<li>å¦‚æœæ®µæ–‡ä»¶æ˜¯é™„åŠ çš„æˆ–ä¸å¯å˜çš„ï¼Œå¹¶å‘å’Œå´©æºƒæ¢å¤å°±ç®€å•å¤šäº†ã€‚ä¾‹å¦‚ï¼Œæ‚¨ä¸å¿…æ‹…å¿ƒåœ¨è¦†ç›–å€¼æ—¶å‘ç”Ÿå´©æºƒçš„æƒ…å†µï¼Œè€Œå°†åŒ…å«æ—§å€¼å’Œæ–°å€¼çš„ä¸€éƒ¨åˆ†çš„æ–‡ä»¶ä¿ç•™åœ¨ä¸€èµ·ã€‚</li>
<li>åˆå¹¶æ—§æ®µå¯ä»¥é¿å…æ•°æ®æ–‡ä»¶éšç€æ—¶é—´çš„æ¨ç§»è€Œåˆ†æ•£çš„é—®é¢˜ã€‚</li>
</ul>
<p>ä½†æ˜¯ï¼Œå“ˆå¸Œè¡¨ç´¢å¼•ä¹Ÿæœ‰å±€é™æ€§ï¼š</p>
<ul>
<li>æ•£åˆ—è¡¨å¿…é¡»èƒ½æ”¾è¿›å†…å­˜</li>
<li>å¦‚æœä½ æœ‰éå¸¸å¤šçš„é”®ï¼Œé‚£çœŸæ˜¯å€’éœ‰ã€‚åŸåˆ™ä¸Šå¯ä»¥åœ¨ç£ç›˜ä¸Šä¿ç•™ä¸€ä¸ªå“ˆå¸Œæ˜ å°„ï¼Œä¸å¹¸çš„æ˜¯ç£ç›˜å“ˆå¸Œæ˜ å°„å¾ˆéš¾è¡¨ç°ä¼˜ç§€ã€‚å®ƒéœ€è¦å¤§é‡çš„éšæœºè®¿é—®I/Oï¼Œå½“å®ƒå˜æ»¡æ—¶å¢é•¿æ˜¯å¾ˆæ˜‚è´µçš„ï¼Œå¹¶ä¸”æ•£åˆ—å†²çªéœ€è¦å¾ˆå¤šçš„é€»è¾‘ã€‚</li>
<li>èŒƒå›´æŸ¥è¯¢æ•ˆç‡ä¸é«˜ã€‚ä¾‹å¦‚ï¼Œæ— æ³•è½»æ¾æ‰«ækitty00000å’Œkitty99999ä¹‹é—´çš„æ‰€æœ‰é”®â€”â€”æ‚¨å¿…é¡»åœ¨æ•£åˆ—æ˜ å°„ä¸­å•ç‹¬æŸ¥æ‰¾æ¯ä¸ªé”®ã€‚</li>
</ul>
<h3 id="SSTableså’ŒLSMæ ‘"><a href="#SSTableså’ŒLSMæ ‘" class="headerlink" title="SSTableså’ŒLSMæ ‘"></a>SSTableså’ŒLSMæ ‘</h3><p>ä¹‹å‰çš„<code>Bitcask</code>ä¹‹ç±»çš„ï¼Œæ¯ä¸ªæ—¥å¿—ç»“æ„å­˜å‚¨æ®µéƒ½æ˜¯ä¸€ç³»åˆ—é”®å€¼å¯¹ã€‚è¿™äº›å¯¹æŒ‰ç…§å®ƒä»¬å†™å…¥çš„é¡ºåºå‡ºç°ï¼Œæ—¥å¿—ä¸­ç¨åçš„å€¼ä¼˜å…ˆäºæ—¥å¿—ä¸­è¾ƒæ—©çš„ç›¸åŒé”®çš„å€¼ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ–‡ä»¶ä¸­é”®å€¼å¯¹çš„é¡ºåºå¹¶ä¸é‡è¦ã€‚</p>
<p>SSTableï¼Œæ’åºå­—ç¬¦ä¸²è¡¨ï¼ˆSorted String Table)ï¼šé”®å€¼å¯¹çš„åºåˆ—æŒ‰é”®æ’åº</p>
<p>LSMæ ‘ï¼Œæ—¥å¿—ç»“æ„åˆå¹¶æ ‘ï¼ˆLog-Structured Merge-Treeï¼‰</p>
<p>SSTablesä¼˜åŠ¿ï¼š</p>
<ul>
<li><p>åˆå¹¶æ®µæ˜¯ç®€å•è€Œé«˜æ•ˆçš„ï¼Œå³ä½¿æ–‡ä»¶å¤§äºå¯ç”¨å†…å­˜ã€‚è¿™ç§æ–¹æ³•å°±åƒå½’å¹¶æ’åºç®—æ³•ä¸­ä½¿ç”¨çš„æ–¹æ³•ä¸€æ ·ï¼Œå¹¶æ’è¯»å–è¾“å…¥æ–‡ä»¶ï¼ŒæŸ¥çœ‹æ¯ä¸ªæ–‡ä»¶ä¸­çš„ç¬¬ä¸€ä¸ªé”®ï¼Œå¤åˆ¶æœ€ä½é”®ï¼ˆæ ¹æ®æ’åºé¡ºåºï¼‰åˆ°è¾“å‡ºæ–‡ä»¶ï¼Œå¹¶é‡å¤ã€‚è¿™äº§ç”Ÿä¸€ä¸ªæ–°çš„åˆå¹¶æ®µæ–‡ä»¶ï¼Œä¹ŸæŒ‰é”®æ’åºã€‚<br><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch3-3-4.png" alt="3-4"><br>å½“å¤šä¸ªæ®µåŒ…å«ç›¸åŒçš„é”®æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¿ç•™æœ€è¿‘æ®µçš„å€¼ï¼Œå¹¶ä¸¢å¼ƒæ—§æ®µä¸­çš„å€¼ã€‚</p>
</li>
<li><p>ä¸ºäº†åœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°ä¸€ä¸ªç‰¹å®šçš„é”®ï¼Œä½ ä¸å†éœ€è¦ä¿å­˜å†…å­˜ä¸­æ‰€æœ‰é”®çš„ç´¢å¼•ã€‚å‡è®¾ä½ æ­£åœ¨å†…å­˜ä¸­å¯»æ‰¾é”® handiworkï¼Œä½†æ˜¯ä½ ä¸çŸ¥é“æ®µæ–‡ä»¶ä¸­è¯¥å…³é”®å­—çš„ç¡®åˆ‡åç§»é‡ã€‚ç„¶è€Œï¼Œä½ çŸ¥é“ handbag å’Œ handsome çš„åç§»ï¼Œè€Œä¸”ç”±äºæ’åºç‰¹æ€§ï¼Œä½ çŸ¥é“ handiwork å¿…é¡»å‡ºç°åœ¨è¿™ä¸¤è€…ä¹‹é—´ã€‚è¿™æ„å‘³ç€æ‚¨å¯ä»¥è·³åˆ° handbag çš„åç§»ä½ç½®å¹¶ä»é‚£é‡Œæ‰«æï¼Œç›´åˆ°æ‚¨æ‰¾åˆ° handiworkï¼ˆæˆ–æ²¡æ‰¾åˆ°ï¼Œå¦‚æœè¯¥æ–‡ä»¶ä¸­æ²¡æœ‰è¯¥é”®ï¼‰ã€‚<br><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch3-3-5.png" alt=""><br>ä»ç„¶éœ€è¦ä¸€ä¸ªå†…å­˜ä¸­ç´¢å¼•æ¥å‘Šè¯‰æ‚¨ä¸€äº›é”®çš„åç§»é‡ï¼Œä½†å®ƒå¯èƒ½å¾ˆç¨€ç–ï¼šæ¯å‡ åƒå­—èŠ‚çš„æ®µæ–‡ä»¶å°±æœ‰ä¸€ä¸ªé”®å°±è¶³å¤Ÿäº†ï¼Œå› ä¸ºå‡ åƒå­—èŠ‚å¯ä»¥å¾ˆå¿«è¢«æ‰«æã€‚</p>
</li>
<li><p>ç”±äºè¯»å–è¯·æ±‚æ— è®ºå¦‚ä½•éƒ½éœ€è¦æ‰«ææ‰€è¯·æ±‚èŒƒå›´å†…çš„å¤šä¸ªé”®å€¼å¯¹ï¼Œå› æ­¤å¯ä»¥å°†è¿™äº›è®°å½•åˆ†ç»„åˆ°å—ä¸­ï¼Œå¹¶åœ¨å°†å…¶å†™å…¥ç£ç›˜ä¹‹å‰å¯¹å…¶è¿›è¡Œå‹ç¼©ï¼ˆå¦‚ä¸Šå›¾é˜´å½±ï¼‰ã€‚ç¨€ç–å†…å­˜ä¸­ç´¢å¼•çš„æ¯ä¸ªæ¡ç›®éƒ½æŒ‡å‘å‹ç¼©å—çš„å¼€å§‹å¤„ã€‚é™¤äº†èŠ‚çœç£ç›˜ç©ºé—´ä¹‹å¤–ï¼Œå‹ç¼©è¿˜å¯ä»¥å‡å°‘IOå¸¦å®½çš„ä½¿ç”¨ã€‚</p>
</li>
</ul>
<h3 id="æ„å»ºå’Œç»´æŠ¤SSTables"><a href="#æ„å»ºå’Œç»´æŠ¤SSTables" class="headerlink" title="æ„å»ºå’Œç»´æŠ¤SSTables"></a>æ„å»ºå’Œç»´æŠ¤SSTables</h3><p>å¦‚ä½•è®©æ•°æ®é¦–å…ˆè¢«æŒ‰é”®æ’åºï¼Ÿ</p>
<p>å¯ä»¥ä½¿ç”¨çº¢é»‘æ ‘æˆ–AVLæ ‘ç­‰ï¼Œå¯ä»¥ä»¥ä»»ä½•é¡ºåºæ’å…¥é”®ï¼Œå¹¶æŒ‰ç…§æ’åºé¡ºåºè¯»å–ä»–ä»¬ã€‚</p>
<p>å½“å‰å­˜å‚¨å¼•æ“å·¥ä½œæ–¹å¼ï¼š</p>
<ul>
<li>å†™å…¥æ—¶ï¼Œå°†å…¶æ·»åŠ åˆ°å†…å­˜ä¸­çš„å¹³è¡¡æ ‘æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚ï¼Œçº¢é»‘æ ‘ï¼‰ã€‚è¿™ä¸ªå†…å­˜æ ‘æœ‰æ—¶è¢«ç§°ä¸ºå†…å­˜è¡¨ï¼ˆmemtableï¼‰ã€‚</li>
<li>å½“å†…å­˜è¡¨å¤§äºæŸä¸ªé˜ˆå€¼ï¼ˆé€šå¸¸ä¸ºå‡ å…†å­—èŠ‚ï¼‰æ—¶ï¼Œå°†å…¶ä½œä¸ºSSTableæ–‡ä»¶å†™å…¥ç£ç›˜ã€‚è¿™å¯ä»¥é«˜æ•ˆåœ°å®Œæˆï¼Œå› ä¸ºæ ‘å·²ç»ç»´æŠ¤äº†æŒ‰é”®æ’åºçš„é”®å€¼å¯¹ã€‚æ–°çš„SSTableæ–‡ä»¶æˆä¸ºæ•°æ®åº“çš„æœ€æ–°éƒ¨åˆ†ã€‚å½“SSTableè¢«å†™å…¥ç£ç›˜æ—¶ï¼Œå†™å…¥å¯ä»¥ç»§ç»­åˆ°ä¸€ä¸ªæ–°çš„å†…å­˜è¡¨å®ä¾‹ã€‚</li>
<li>ä¸ºäº†æä¾›è¯»å–è¯·æ±‚ï¼Œé¦–å…ˆå°è¯•åœ¨å†…å­˜è¡¨ä¸­æ‰¾åˆ°å…³é”®å­—ï¼Œç„¶ååœ¨æœ€è¿‘çš„ç£ç›˜æ®µä¸­ï¼Œç„¶ååœ¨ä¸‹ä¸€ä¸ªè¾ƒæ—§çš„æ®µä¸­æ‰¾åˆ°è¯¥å…³é”®å­—ã€‚</li>
<li>æœ‰æ—¶ä¼šåœ¨åå°è¿è¡Œåˆå¹¶å’Œå‹ç¼©è¿‡ç¨‹ä»¥ç»„åˆæ®µæ–‡ä»¶å¹¶ä¸¢å¼ƒè¦†ç›–æˆ–åˆ é™¤çš„å€¼ã€‚</li>
</ul>
<p>ä½†æ˜¯ï¼Œå¦‚æœæ•°æ®åº“å´©æºƒï¼Œåˆ™æœ€è¿‘çš„å†™å…¥ï¼ˆåœ¨å†…å­˜è¡¨ä¸­ï¼Œä½†å°šæœªå†™å…¥ç£ç›˜ï¼‰å°†ä¸¢å¤±ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨ç£ç›˜ä¸Šä¿å­˜ä¸€ä¸ªå•ç‹¬çš„æ—¥å¿—ï¼Œæ¯ä¸ªå†™å…¥éƒ½ä¼šç«‹å³è¢«é™„åŠ åˆ°ç£ç›˜ä¸Šï¼Œå°±åƒåœ¨å‰ä¸€èŠ‚ä¸­ä¸€æ ·ã€‚è¯¥æ—¥å¿—ä¸æ˜¯æŒ‰æ’åºé¡ºåºï¼Œä½†è¿™å¹¶ä¸é‡è¦ï¼Œå› ä¸ºå®ƒçš„å”¯ä¸€ç›®çš„æ˜¯åœ¨å´©æºƒåæ¢å¤å†…å­˜è¡¨ã€‚æ¯å½“å†…å­˜è¡¨å†™å‡ºåˆ°SSTableæ—¶ï¼Œç›¸åº”çš„æ—¥å¿—éƒ½å¯ä»¥è¢«ä¸¢å¼ƒã€‚</p>
<h3 id="ä½¿ç”¨SSTablesç”ŸæˆLSMæ ‘"><a href="#ä½¿ç”¨SSTablesç”ŸæˆLSMæ ‘" class="headerlink" title="ä½¿ç”¨SSTablesç”ŸæˆLSMæ ‘"></a>ä½¿ç”¨SSTablesç”ŸæˆLSMæ ‘</h3><p>è¿™é‡Œæè¿°çš„ç®—æ³•æœ¬è´¨ä¸Šæ˜¯LevelDBå’ŒRocksDBä¸­ä½¿ç”¨çš„å…³é”®å€¼å­˜å‚¨å¼•æ“åº“ï¼Œè¢«è®¾è®¡åµŒå…¥åˆ°å…¶ä»–åº”ç”¨ç¨‹åºä¸­ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒLevelDBå¯ä»¥åœ¨Riakä¸­ç”¨ä½œBitcaskçš„æ›¿ä»£å“ã€‚åœ¨Cassandraå’ŒHBaseä¸­ä½¿ç”¨äº†ç±»ä¼¼çš„å­˜å‚¨å¼•æ“ï¼Œè¿™ä¸¤ç§å¼•æ“éƒ½å—åˆ°äº†Googleçš„Bigtableæ–‡æ¡£ï¼ˆå¼•å…¥äº†SSTableå’Œmemtableï¼‰çš„å¯å‘ã€‚</p>
<p>æœ€åˆè¿™ç§ç´¢å¼•ç»“æ„æ˜¯ç”±Patrick Oâ€™Neilç­‰äººæè¿°çš„ã€‚åœ¨æ—¥å¿—ç»“æ„åˆå¹¶æ ‘ï¼ˆæˆ–LSMæ ‘ï¼‰çš„åŸºç¡€ä¸Šï¼Œå»ºç«‹åœ¨ä»¥å‰çš„å·¥ä½œä¸Šæ—¥å¿—ç»“æ„çš„æ–‡ä»¶ç³»ç»Ÿã€‚åŸºäºè¿™ç§åˆå¹¶å’Œå‹ç¼©æ’åºæ–‡ä»¶åŸç†çš„å­˜å‚¨å¼•æ“é€šå¸¸è¢«ç§°ä¸ºLSMå­˜å‚¨å¼•æ“ã€‚</p>
<p>Luceneæ˜¯Elasticsearchå’ŒSolrä½¿ç”¨çš„ä¸€ç§å…¨æ–‡æœç´¢çš„ç´¢å¼•å¼•æ“ï¼Œå®ƒä½¿ç”¨ç±»ä¼¼çš„æ–¹æ³•æ¥å­˜å‚¨å®ƒçš„è¯å…¸ã€‚å…¨æ–‡ç´¢å¼•æ¯”é”®å€¼ç´¢å¼•å¤æ‚å¾—å¤šï¼Œä½†æ˜¯åŸºäºç±»ä¼¼çš„æƒ³æ³•ï¼šåœ¨æœç´¢æŸ¥è¯¢ä¸­ç»™å‡ºä¸€ä¸ªå•è¯ï¼Œæ‰¾åˆ°æåŠå•è¯çš„æ‰€æœ‰æ–‡æ¡£ï¼ˆç½‘é¡µï¼Œäº§å“æè¿°ç­‰ï¼‰ã€‚è¿™æ˜¯é€šè¿‡é”®å€¼ç»“æ„å®ç°çš„ï¼Œå…¶ä¸­é”®æ˜¯å•è¯ï¼ˆå…³é”®è¯ï¼ˆtermï¼‰ï¼‰ï¼Œå€¼æ˜¯åŒ…å«å•è¯ï¼ˆæ–‡ç« åˆ—è¡¨ï¼‰çš„æ‰€æœ‰æ–‡æ¡£çš„IDçš„åˆ—è¡¨ã€‚åœ¨Luceneä¸­ï¼Œä»æœ¯è¯­åˆ°å‘å¸ƒåˆ—è¡¨çš„è¿™ç§æ˜ å°„ä¿å­˜åœ¨SSTableç±»çš„æœ‰åºæ–‡ä»¶ä¸­ï¼Œæ ¹æ®éœ€è¦åœ¨åå°åˆå¹¶ã€‚</p>
<h3 id="æ€§èƒ½ä¼˜åŒ–"><a href="#æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–"></a>æ€§èƒ½ä¼˜åŒ–</h3><p>ä¸å¾€å¸¸ä¸€æ ·ï¼Œå¤§é‡çš„ç»†èŠ‚ä½¿å¾—å­˜å‚¨å¼•æ“åœ¨å®è·µä¸­è¡¨ç°è‰¯å¥½ã€‚ä¾‹å¦‚ï¼Œå½“æŸ¥æ‰¾æ•°æ®åº“ä¸­ä¸å­˜åœ¨çš„é”®æ—¶ï¼ŒLSMæ ‘ç®—æ³•å¯èƒ½ä¼šå¾ˆæ…¢ï¼šæ‚¨å¿…é¡»æ£€æŸ¥å†…å­˜è¡¨ï¼Œç„¶åå°†è¿™äº›æ®µä¸€ç›´å›åˆ°æœ€è€çš„ï¼ˆå¯èƒ½å¿…é¡»ä»ç£ç›˜è¯»å–æ¯ä¸€ä¸ªï¼‰ï¼Œç„¶åæ‰èƒ½ç¡®å®šé”®ä¸å­˜åœ¨ã€‚ä¸ºäº†ä¼˜åŒ–è¿™ç§è®¿é—®ï¼Œå­˜å‚¨å¼•æ“é€šå¸¸ä½¿ç”¨é¢å¤–çš„<code>Bloomè¿‡æ»¤å™¨</code>ã€‚ ï¼ˆå¸ƒéš†è¿‡æ»¤å™¨æ˜¯ç”¨äºè¿‘ä¼¼é›†åˆå†…å®¹çš„å†…å­˜é«˜æ•ˆæ•°æ®ç»“æ„ï¼Œå®ƒå¯ä»¥å‘Šè¯‰æ‚¨æ•°æ®åº“ä¸­æ˜¯å¦å‡ºç°é”®ï¼Œä»è€Œä¸ºä¸å­˜åœ¨çš„é”®èŠ‚çœè®¸å¤šä¸å¿…è¦çš„ç£ç›˜è¯»å–æ“ä½œã€‚</p>
<p>è¿˜æœ‰ä¸åŒçš„ç­–ç•¥æ¥ç¡®å®šSSTableså¦‚ä½•è¢«å‹ç¼©å’Œåˆå¹¶çš„é¡ºåºå’Œæ—¶é—´ã€‚æœ€å¸¸è§çš„é€‰æ‹©æ˜¯å¤§å°åˆ†å±‚å‹å®ã€‚ LevelDBå’ŒRocksDBä½¿ç”¨å¹³å¦å‹ç¼©ï¼ˆLevelDBå› æ­¤å¾—åï¼‰ï¼ŒHBaseä½¿ç”¨å¤§å°åˆ†å±‚ï¼ŒCassandraåŒæ—¶æ”¯æŒã€‚åœ¨è§„æ¨¡çº§åˆ«çš„è°ƒæ•´ä¸­ï¼Œæ›´æ–°å’Œæ›´å°çš„SSTableså…ˆåè¢«åˆå¹¶åˆ°æ›´è€çš„å’Œæ›´å¤§çš„SSTableä¸­ã€‚åœ¨æ°´å¹³å‹å®ä¸­ï¼Œå…³é”®èŒƒå›´è¢«æ‹†åˆ†æˆæ›´å°çš„SSTablesï¼Œè€Œè¾ƒæ—§çš„æ•°æ®è¢«ç§»åŠ¨åˆ°å•ç‹¬çš„â€œæ°´å¹³â€ï¼Œè¿™ä½¿å¾—å‹ç¼©èƒ½å¤Ÿæ›´åŠ é€’å¢åœ°è¿›è¡Œï¼Œå¹¶ä¸”ä½¿ç”¨æ›´å°‘çš„ç£ç›˜ç©ºé—´ã€‚</p>
<p><code>LSMæ ‘çš„åŸºæœ¬æ€æƒ³</code>ï¼šä¿å­˜ä¸€ç³»åˆ—åœ¨åå°åˆå¹¶çš„SSTablesã€‚å³ä½¿æ•°æ®é›†æ¯”å¯ç”¨å†…å­˜å¤§å¾—å¤šï¼Œå®ƒä»èƒ½ç»§ç»­æ­£å¸¸å·¥ä½œã€‚ç”±äºæ•°æ®æŒ‰æ’åºé¡ºåºå­˜å‚¨ï¼Œå› æ­¤å¯ä»¥é«˜æ•ˆåœ°æ‰§è¡ŒèŒƒå›´æŸ¥è¯¢ï¼ˆæ‰«ææ‰€æœ‰é«˜äºæŸäº›æœ€å°å€¼å’Œæœ€é«˜å€¼çš„æ‰€æœ‰é”®ï¼‰ï¼Œå¹¶ä¸”å› ä¸ºç£ç›˜å†™å…¥æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥LSMæ ‘å¯ä»¥æ”¯æŒéå¸¸é«˜çš„å†™å…¥ååé‡ã€‚</p>
<h2 id="Bæ ‘"><a href="#Bæ ‘" class="headerlink" title="Bæ ‘"></a>Bæ ‘</h2><p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch3-3-6.png" alt=""></p>
<p>ä¸€ä¸ªé¡µé¢ä¼šè¢«æŒ‡å®šä¸ºBæ ‘çš„æ ¹ï¼›åœ¨ç´¢å¼•ä¸­æŸ¥æ‰¾ä¸€ä¸ªé”®æ—¶ï¼Œå°±ä»è¿™é‡Œå¼€å§‹ã€‚è¯¥é¡µé¢åŒ…å«å‡ ä¸ªé”®å’Œå¯¹å­é¡µé¢çš„å¼•ç”¨ã€‚æ¯ä¸ªå­é¡µé¢è´Ÿè´£ä¸€æ®µè¿ç»­èŒƒå›´çš„é”®ï¼Œå¼•ç”¨ä¹‹é—´çš„é”®ï¼ŒæŒ‡æ˜äº†å¼•ç”¨å­é¡µé¢çš„é”®èŒƒå›´ã€‚</p>
<p>åœ¨å›¾3-6çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨å¯»æ‰¾å…³é”®å­— 251 ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬éœ€è¦éµå¾ªè¾¹ç•Œ 200 å’Œ 300 ä¹‹é—´çš„é¡µé¢å¼•ç”¨ã€‚è¿™å°†æˆ‘ä»¬å¸¦åˆ°ä¸€ä¸ªç±»ä¼¼çš„é¡µé¢ï¼Œè¿›ä¸€æ­¥æ‰“ç ´äº†200 - 300åˆ°å­èŒƒå›´ã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŒ…å«å•ä¸ªé”®ï¼ˆå¶é¡µï¼‰çš„é¡µé¢ï¼Œè¯¥é¡µé¢åŒ…å«æ¯ä¸ªé”®çš„å†…è”å€¼ï¼Œæˆ–è€…åŒ…å«å¯¹å¯ä»¥æ‰¾åˆ°å€¼çš„é¡µé¢çš„å¼•ç”¨ã€‚</p>
<p>åœ¨Bæ ‘çš„ä¸€ä¸ªé¡µé¢ä¸­å¯¹å­é¡µé¢çš„å¼•ç”¨çš„æ•°é‡ç§°ä¸ºåˆ†æ”¯å› å­ã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾3-6ä¸­ï¼Œåˆ†æ”¯å› å­æ˜¯ 6 ã€‚åœ¨å®è·µä¸­ï¼Œåˆ†æ”¯å› å­å–å†³äºå­˜å‚¨é¡µé¢å‚è€ƒå’ŒèŒƒå›´è¾¹ç•Œæ‰€éœ€çš„ç©ºé—´é‡ï¼Œä½†é€šå¸¸æ˜¯å‡ ç™¾ä¸ªã€‚</p>
<p>å¦‚æœè¦æ›´æ–°Bæ ‘ä¸­ç°æœ‰é”®çš„å€¼ï¼Œåˆ™æœç´¢åŒ…å«è¯¥é”®çš„å¶é¡µï¼Œæ›´æ”¹è¯¥é¡µä¸­çš„å€¼ï¼Œå¹¶å°†è¯¥é¡µå†™å›åˆ°ç£ç›˜ï¼ˆå¯¹è¯¥é¡µçš„ä»»ä½•å¼•ç”¨ä¿æŒæœ‰æ•ˆï¼‰ ã€‚å¦‚æœä½ æƒ³æ·»åŠ ä¸€ä¸ªæ–°çš„é”®ï¼Œä½ éœ€è¦æ‰¾åˆ°å…¶èŒƒå›´åŒ…å«æ–°é”®çš„é¡µé¢ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°è¯¥é¡µé¢ã€‚å¦‚æœé¡µé¢ä¸­æ²¡æœ‰è¶³å¤Ÿçš„å¯ç”¨ç©ºé—´å®¹çº³æ–°é”®ï¼Œåˆ™å°†å…¶åˆ†æˆä¸¤ä¸ªåŠæ»¡é¡µé¢ï¼Œå¹¶æ›´æ–°çˆ¶é¡µé¢ä»¥è§£é‡Šé”®èŒƒå›´çš„æ–°åˆ†åŒº</p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch3-3-7.png" alt=""></p>
<p>è¯¥ç®—æ³•ç¡®ä¿æ ‘ä¿æŒå¹³è¡¡ï¼šå…·æœ‰ n ä¸ªé”®çš„Bæ ‘æ€»æ˜¯å…·æœ‰ $O(log n)$ çš„æ·±åº¦ã€‚å¤§å¤šæ•°æ•°æ®åº“å¯ä»¥æ”¾å…¥ä¸€ä¸ªä¸‰åˆ°å››å±‚çš„Bæ ‘ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦éµè¿½è¸ªå¤šé¡µé¢å¼•ç”¨æ¥æ‰¾åˆ°ä½ æ­£åœ¨æŸ¥æ‰¾çš„é¡µé¢ã€‚ ï¼ˆåˆ†æ”¯å› å­ä¸º 500 çš„ 4KB é¡µé¢çš„å››çº§æ ‘å¯ä»¥å­˜å‚¨å¤šè¾¾ 256TB ã€‚ï¼‰</p>
<h3 id="è®©Bæ ‘æ›´å¯é "><a href="#è®©Bæ ‘æ›´å¯é " class="headerlink" title="è®©Bæ ‘æ›´å¯é "></a>è®©Bæ ‘æ›´å¯é </h3><p>Bæ ‘çš„åŸºæœ¬åº•å±‚å†™æ“ä½œæ˜¯ç”¨æ–°æ•°æ®è¦†ç›–ç£ç›˜ä¸Šçš„é¡µé¢ã€‚å‡å®šè¦†ç›–ä¸æ”¹å˜é¡µé¢çš„ä½ç½®;å³ï¼Œå½“é¡µé¢è¢«è¦†ç›–æ—¶ï¼Œå¯¹è¯¥é¡µé¢çš„æ‰€æœ‰å¼•ç”¨ä¿æŒå®Œæ•´ã€‚è¿™ä¸æ—¥å¿—ç»“æ„ç´¢å¼•ï¼ˆå¦‚LSMæ ‘ï¼‰å½¢æˆé²œæ˜å¯¹æ¯”ï¼Œåè€…åªé™„åŠ åˆ°æ–‡ä»¶ï¼ˆå¹¶æœ€ç»ˆåˆ é™¤è¿‡æ—¶çš„æ–‡ä»¶ï¼‰ï¼Œä½†ä»ä¸ä¿®æ”¹æ–‡ä»¶ã€‚</p>
<p>Bæ ‘å®ç°é€šå¸¸ä¼šå¸¦æœ‰ä¸€ä¸ªé¢å¤–çš„ç£ç›˜æ•°æ®ç»“æ„ï¼š<code>é¢„å†™å¼æ—¥å¿—ï¼ˆWAL, write-ahead-logï¼‰</code>ï¼ˆä¹Ÿç§°ä¸ºé‡åšæ—¥å¿—ï¼ˆredo logï¼‰ï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªä»…è¿½åŠ çš„æ–‡ä»¶ï¼Œæ¯ä¸ªBæ ‘ä¿®æ”¹éƒ½å¯ä»¥åº”ç”¨åˆ°æ ‘æœ¬èº«çš„é¡µé¢ä¸Šã€‚å½“æ•°æ®åº“åœ¨å´©æºƒåæ¢å¤æ—¶ï¼Œè¿™ä¸ªæ—¥å¿—è¢«ç”¨æ¥ä½¿Bæ ‘æ¢å¤åˆ°ä¸€è‡´çš„çŠ¶æ€</p>
<p>æ›´æ–°é¡µé¢çš„ä¸€ä¸ªé¢å¤–çš„å¤æ‚æƒ…å†µæ˜¯ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹è¦åŒæ—¶è®¿é—®Bæ ‘ï¼Œåˆ™éœ€è¦ä»”ç»†çš„å¹¶å‘æ§åˆ¶ â€”â€” å¦åˆ™çº¿ç¨‹å¯èƒ½ä¼šçœ‹åˆ°æ ‘å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ã€‚è¿™é€šå¸¸é€šè¿‡ä½¿ç”¨<code>é”å­˜å™¨ï¼ˆlatchesï¼‰</code>ï¼ˆè½»é‡çº§é”ï¼‰ä¿æŠ¤æ ‘çš„æ•°æ®ç»“æ„æ¥å®Œæˆã€‚æ—¥å¿—ç»“æ„åŒ–çš„æ–¹æ³•åœ¨è¿™æ–¹é¢æ›´ç®€å•ï¼Œå› ä¸ºå®ƒä»¬åœ¨åå°è¿›è¡Œæ‰€æœ‰çš„åˆå¹¶ï¼Œè€Œä¸ä¼šå¹²æ‰°ä¼ å…¥çš„æŸ¥è¯¢ï¼Œå¹¶ä¸”ä¸æ—¶åœ°å°†æ—§çš„åˆ†æ®µåŸå­äº¤æ¢ä¸ºæ–°çš„åˆ†æ®µã€‚</p>
<h3 id="Bæ ‘ä¼˜åŒ–"><a href="#Bæ ‘ä¼˜åŒ–" class="headerlink" title="Bæ ‘ä¼˜åŒ–"></a>Bæ ‘ä¼˜åŒ–</h3><ul>
<li>å†™æ—¶å¤åˆ¶</li>
<li>ä¸å­˜å‚¨æ•´ä¸ªé”®</li>
<li>å¸ƒå±€æ ‘</li>
<li>é˜Ÿå…„å¼Ÿé¡µé¢çš„å¼•ç”¨</li>
<li>åˆ†å½¢æ ‘</li>
</ul>
<h2 id="Bæ ‘ä¸LSMæ ‘ä¼˜ç¼ºç‚¹æ¯”è¾ƒ"><a href="#Bæ ‘ä¸LSMæ ‘ä¼˜ç¼ºç‚¹æ¯”è¾ƒ" class="headerlink" title="Bæ ‘ä¸LSMæ ‘ä¼˜ç¼ºç‚¹æ¯”è¾ƒ"></a>Bæ ‘ä¸LSMæ ‘ä¼˜ç¼ºç‚¹æ¯”è¾ƒ</h2><h3 id="LSMæ ‘ä¼˜ç‚¹"><a href="#LSMæ ‘ä¼˜ç‚¹" class="headerlink" title="LSMæ ‘ä¼˜ç‚¹"></a>LSMæ ‘ä¼˜ç‚¹</h3><p>Bæ ‘ç´¢å¼•å¿…é¡»è‡³å°‘ä¸¤æ¬¡å†™å…¥æ¯ä¸€æ®µæ•°æ®ï¼šä¸€æ¬¡å†™å…¥é¢„å…ˆå†™å…¥æ—¥å¿—ï¼Œä¸€æ¬¡å†™å…¥æ ‘é¡µé¢æœ¬èº«ï¼ˆä¹Ÿè®¸å†æ¬¡åˆ†é¡µï¼‰ã€‚å³ä½¿åœ¨è¯¥é¡µé¢ä¸­åªæœ‰å‡ ä¸ªå­—èŠ‚å‘ç”Ÿäº†å˜åŒ–ï¼Œä¹Ÿéœ€è¦ä¸€æ¬¡ç¼–å†™æ•´ä¸ªé¡µé¢çš„å¼€é”€ã€‚æœ‰äº›å­˜å‚¨å¼•æ“ç”šè‡³ä¼šè¦†ç›–åŒä¸€ä¸ªé¡µé¢ä¸¤æ¬¡ï¼Œä»¥å…åœ¨ç”µæºæ•…éšœçš„æƒ…å†µä¸‹å¯¼è‡´é¡µé¢éƒ¨åˆ†æ›´æ–°ã€‚</p>
<p>ç”±äºåå¤å‹ç¼©å’Œåˆå¹¶SSTablesï¼Œæ—¥å¿—ç»“æ„ç´¢å¼•ä¹Ÿä¼šé‡å†™æ•°æ®ã€‚è¿™ç§å½±å“åœ¨æ•°æ®åº“çš„ç”Ÿå‘½å‘¨æœŸä¸­å†™å…¥æ•°æ®åº“å¯¼è‡´å¯¹ç£ç›˜çš„å¤šæ¬¡å†™å…¥è¢«ç§°ä¸ºå†™æ”¾å¤§ï¼ˆwrite amplificationï¼‰ã€‚éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯å›ºæ€ç¡¬ç›˜ï¼Œå›ºæ€ç¡¬ç›˜çš„é—ªå­˜å¯¿å‘½åœ¨è¦†å†™æœ‰é™æ¬¡æ•°åå°±ä¼šè€—å°½ã€‚</p>
<p>åœ¨å†™å…¥ç¹é‡çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæ€§èƒ½ç“¶é¢ˆå¯èƒ½æ˜¯æ•°æ®åº“å¯ä»¥å†™å…¥ç£ç›˜çš„é€Ÿåº¦ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå†™æ”¾å¤§ä¼šå¯¼è‡´ç›´æ¥çš„æ€§èƒ½ä»£ä»·ï¼šå­˜å‚¨å¼•æ“å†™å…¥ç£ç›˜çš„æ¬¡æ•°è¶Šå¤šï¼Œå¯ç”¨ç£ç›˜å¸¦å®½å†…çš„æ¯ç§’å†™å…¥æ¬¡æ•°è¶Šå°‘ã€‚</p>
<p>è€Œä¸”ï¼ŒLSMæ ‘é€šå¸¸èƒ½å¤Ÿæ¯”Bæ ‘æ”¯æŒæ›´é«˜çš„å†™å…¥ååé‡ï¼Œéƒ¨åˆ†åŸå› æ˜¯å®ƒä»¬æœ‰æ—¶å…·æœ‰è¾ƒä½çš„å†™æ”¾å¤§ï¼ˆå°½ç®¡è¿™å–å†³äºå­˜å‚¨å¼•æ“é…ç½®å’Œå·¥ä½œè´Ÿè½½ï¼‰ï¼Œéƒ¨åˆ†æ˜¯å› ä¸ºå®ƒä»¬é¡ºåºåœ°å†™å…¥ç´§å‡‘çš„SSTableæ–‡ä»¶è€Œä¸æ˜¯å¿…é¡»è¦†ç›–æ ‘ä¸­çš„å‡ ä¸ªé¡µé¢ã€‚è¿™ç§å·®å¼‚åœ¨ç£æ€§ç¡¬ç›˜é©±åŠ¨å™¨ä¸Šå°¤å…¶é‡è¦ï¼Œé¡ºåºå†™å…¥æ¯”éšæœºå†™å…¥å¿«å¾—å¤šã€‚</p>
<p>LSMæ ‘å¯ä»¥è¢«å‹ç¼©å¾—æ›´å¥½ï¼Œå› æ­¤ç»å¸¸æ¯”Bæ ‘åœ¨ç£ç›˜ä¸Šäº§ç”Ÿæ›´å°çš„æ–‡ä»¶ã€‚ Bæ ‘å­˜å‚¨å¼•æ“ä¼šç”±äºåˆ†å‰²è€Œç•™ä¸‹ä¸€äº›æœªä½¿ç”¨çš„ç£ç›˜ç©ºé—´ï¼šå½“é¡µé¢è¢«æ‹†åˆ†æˆ–æŸè¡Œä¸èƒ½æ”¾å…¥ç°æœ‰é¡µé¢æ—¶ï¼Œé¡µé¢ä¸­çš„æŸäº›ç©ºé—´ä»æœªè¢«ä½¿ç”¨ã€‚ç”±äºLSMæ ‘ä¸æ˜¯é¢å‘é¡µé¢çš„ï¼Œå¹¶ä¸”å®šæœŸé‡å†™SSTablesä»¥å»é™¤ç¢ç‰‡ï¼Œæ‰€ä»¥å®ƒä»¬å…·æœ‰è¾ƒä½çš„å­˜å‚¨å¼€é”€ï¼Œç‰¹åˆ«æ˜¯å½“ä½¿ç”¨å¹³å¦å‹ç¼©æ—¶ã€‚</p>
<p>åœ¨è®¸å¤šå›ºæ€ç¡¬ç›˜ä¸Šï¼Œå›ºä»¶å†…éƒ¨ä½¿ç”¨æ—¥å¿—ç»“æ„åŒ–ç®—æ³•ï¼Œå°†éšæœºå†™å…¥è½¬å˜ä¸ºé¡ºåºå†™å…¥åº•å±‚å­˜å‚¨èŠ¯ç‰‡ï¼Œå› æ­¤å­˜å‚¨å¼•æ“å†™å…¥æ¨¡å¼çš„å½±å“ä¸å¤ªæ˜æ˜¾ã€‚ä½†æ˜¯ï¼Œè¾ƒä½çš„å†™å…¥æ”¾å¤§ç‡å’Œå‡å°‘çš„ç¢ç‰‡å¯¹SSDä»ç„¶æœ‰åˆ©ï¼šæ›´ç´§å‡‘åœ°è¡¨ç¤ºæ•°æ®å¯åœ¨å¯ç”¨çš„I/Oå¸¦å®½å†…æä¾›æ›´å¤šçš„è¯»å–å’Œå†™å…¥è¯·æ±‚ã€‚</p>
<h3 id="LSMç¼ºç‚¹"><a href="#LSMç¼ºç‚¹" class="headerlink" title="LSMç¼ºç‚¹"></a>LSMç¼ºç‚¹</h3><p>æ—¥å¿—ç»“æ„å­˜å‚¨çš„ç¼ºç‚¹æ˜¯å‹ç¼©è¿‡ç¨‹æœ‰æ—¶ä¼šå¹²æ‰°æ­£åœ¨è¿›è¡Œçš„è¯»å†™æ“ä½œã€‚å°½ç®¡å­˜å‚¨å¼•æ“å°è¯•é€æ­¥æ‰§è¡Œå‹ç¼©è€Œä¸å½±å“å¹¶å‘è®¿é—®ï¼Œä½†æ˜¯ç£ç›˜èµ„æºæœ‰é™ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“å‘ç”Ÿè¯·æ±‚éœ€è¦ç­‰å¾…è€Œç£ç›˜å®Œæˆæ˜‚è´µçš„å‹ç¼©æ“ä½œã€‚å¯¹ååé‡å’Œå¹³å‡å“åº”æ—¶é—´çš„å½±å“é€šå¸¸å¾ˆå°ï¼Œä½†æ˜¯åœ¨æ›´é«˜ç™¾åˆ†æ¯”çš„æƒ…å†µä¸‹ï¼ˆå‚é˜…â€œæè¿°æ€§èƒ½â€ï¼‰ï¼Œå¯¹æ—¥å¿—ç»“æ„åŒ–å­˜å‚¨å¼•æ“çš„æŸ¥è¯¢å“åº”æ—¶é—´æœ‰æ—¶ä¼šç›¸å½“é•¿ï¼Œè€ŒBæ ‘çš„è¡Œä¸ºåˆ™ç›¸å¯¹æ›´å…·å¯é¢„æµ‹æ€§ã€‚</p>
<p>å‹ç¼©çš„å¦ä¸€ä¸ªé—®é¢˜å‡ºç°åœ¨é«˜å†™å…¥ååé‡ï¼šç£ç›˜çš„æœ‰é™å†™å…¥å¸¦å®½éœ€è¦åœ¨åˆå§‹å†™å…¥ï¼ˆè®°å½•å’Œåˆ·æ–°å†…å­˜è¡¨åˆ°ç£ç›˜ï¼‰å’Œåœ¨åå°è¿è¡Œçš„å‹ç¼©çº¿ç¨‹ä¹‹é—´å…±äº«ã€‚å†™å…¥ç©ºæ•°æ®åº“æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å…¨ç£ç›˜å¸¦å®½è¿›è¡Œåˆå§‹å†™å…¥ï¼Œä½†æ•°æ®åº“è¶Šå¤§ï¼Œå‹ç¼©æ‰€éœ€çš„ç£ç›˜å¸¦å®½å°±è¶Šå¤šã€‚</p>
<p>å¦‚æœå†™å…¥ååé‡å¾ˆé«˜ï¼Œå¹¶ä¸”å‹ç¼©æ²¡æœ‰ä»”ç»†é…ç½®ï¼Œå‹ç¼©è·Ÿä¸ä¸Šå†™å…¥é€Ÿç‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç£ç›˜ä¸Šæœªåˆå¹¶æ®µçš„æ•°é‡ä¸æ–­å¢åŠ ï¼Œç›´åˆ°ç£ç›˜ç©ºé—´ç”¨å®Œï¼Œè¯»å–é€Ÿåº¦ä¹Ÿä¼šå‡æ…¢ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦æ£€æŸ¥æ›´å¤šæ®µæ–‡ä»¶ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå³ä½¿å‹ç¼©æ— æ³•è·Ÿä¸Šï¼ŒåŸºäºSSTableçš„å­˜å‚¨å¼•æ“ä¹Ÿä¸ä¼šé™åˆ¶ä¼ å…¥å†™å…¥çš„é€Ÿç‡ï¼Œæ‰€ä»¥æ‚¨éœ€è¦è¿›è¡Œæ˜ç¡®çš„ç›‘æ§æ¥æ£€æµ‹è¿™ç§æƒ…å†µã€‚</p>
<p>Bæ ‘çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯æ¯ä¸ªé”®åªå­˜åœ¨äºç´¢å¼•ä¸­çš„ä¸€ä¸ªä½ç½®ï¼Œè€Œæ—¥å¿—ç»“æ„åŒ–çš„å­˜å‚¨å¼•æ“å¯èƒ½åœ¨ä¸åŒçš„æ®µä¸­æœ‰ç›¸åŒé”®çš„å¤šä¸ªå‰¯æœ¬ã€‚è¿™ä¸ªæ–¹é¢ä½¿å¾—Bæ ‘åœ¨æƒ³è¦æä¾›å¼ºå¤§çš„äº‹åŠ¡è¯­ä¹‰çš„æ•°æ®åº“ä¸­å¾ˆæœ‰å¸å¼•åŠ›ï¼šåœ¨è®¸å¤šå…³ç³»æ•°æ®åº“ä¸­ï¼Œäº‹åŠ¡éš”ç¦»æ˜¯é€šè¿‡åœ¨é”®èŒƒå›´ä¸Šä½¿ç”¨é”æ¥å®ç°çš„ï¼Œåœ¨Bæ ‘ç´¢å¼•ä¸­ï¼Œè¿™äº›é”å¯ä»¥ç›´æ¥è¿æ¥åˆ°æ ‘ã€‚</p>
<hr>
<h2 id="äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ"><a href="#äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ" class="headerlink" title="äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ"></a>äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ</h2><p>åœ¨çº¿äº‹åŠ¡å¤„ç†ï¼ˆOLTPï¼ŒOnline Transcation Processing)ã€‚</p>
<p>åœ¨çº¿åˆ†æå¤„ç†ï¼ˆOLAPï¼ŒOnline Analytice Processing)ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>äº‹åŠ¡å¤„ç† OLTP</th>
<th>åˆ†æç³»ç»Ÿ OLAP</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä¸»è¦è¯»å–æ¨¡å¼</td>
<td>æŸ¥è¯¢å°‘é‡è®°å½•ï¼ŒæŒ‰é”®è¯»å–</td>
<td>åœ¨å¤§æ‰¹é‡è®°å½•ä¸Šèšåˆ</td>
</tr>
<tr>
<td>ä¸»è¦å†™å…¥æ¨¡å¼</td>
<td>éšæœºè®¿é—®ï¼Œå†™å…¥è¦æ±‚ä½å»¶æ—¶</td>
<td>æ‰¹é‡å¯¼å…¥ï¼ˆETLï¼‰ï¼Œäº‹ä»¶æµ</td>
</tr>
<tr>
<td>ä¸»è¦ç”¨æˆ·</td>
<td>ç»ˆç«¯ç”¨æˆ·ï¼Œé€šè¿‡Webåº”ç”¨</td>
<td>å†…éƒ¨æ•°æ®åˆ†æå¸ˆï¼Œå†³ç­–æ”¯æŒ</td>
</tr>
<tr>
<td>å¤„ç†çš„æ•°æ®</td>
<td>æ•°æ®çš„æœ€æ–°çŠ¶æ€ï¼ˆå½“å‰æ—¶é—´ç‚¹ï¼‰</td>
<td>éšæ—¶é—´æ¨ç§»çš„å†å²äº‹ä»¶</td>
</tr>
<tr>
<td>æ•°æ®é›†å°ºå¯¸</td>
<td>GB ~ TB</td>
<td>TB ~ PB</td>
</tr>
</tbody>
</table>
</div>
<p><code>æ•°æ®ä»“åº“</code>ï¼šç”¨ä½œæ•°æ®åˆ†æ</p>
<p>ä»OLTPæ•°æ®åº“ä¸­æå–æ•°æ®ï¼ˆä½¿ç”¨å®šæœŸçš„æ•°æ®è½¬å‚¨æˆ–è¿ç»­çš„æ›´æ–°æµï¼‰ï¼Œè½¬æ¢æˆé€‚åˆåˆ†æçš„æ¨¡å¼ï¼Œæ¸…ç†å¹¶åŠ è½½åˆ°æ•°æ®ä»“åº“ä¸­ã€‚å°†æ•°æ®å­˜å…¥ä»“åº“çš„è¿‡ç¨‹ç§°ä¸º<code>æŠ½å–-è½¬æ¢-åŠ è½½ï¼ˆETLï¼‰</code><br><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch3-3-8.png" alt=""></p>
<h3 id="OLTPæ•°æ®åº“å’Œæ•°æ®ä»“åº“ä¹‹é—´çš„åˆ†æ­§"><a href="#OLTPæ•°æ®åº“å’Œæ•°æ®ä»“åº“ä¹‹é—´çš„åˆ†æ­§" class="headerlink" title="OLTPæ•°æ®åº“å’Œæ•°æ®ä»“åº“ä¹‹é—´çš„åˆ†æ­§"></a>OLTPæ•°æ®åº“å’Œæ•°æ®ä»“åº“ä¹‹é—´çš„åˆ†æ­§</h3><p>è¡¨é¢ä¸Šï¼Œä¸€ä¸ªæ•°æ®ä»“åº“å’Œä¸€ä¸ªå…³ç³»OLTPæ•°æ®åº“çœ‹èµ·æ¥å¾ˆç›¸ä¼¼ï¼Œå› ä¸ºå®ƒä»¬éƒ½æœ‰ä¸€ä¸ªSQLæŸ¥è¯¢æ¥å£ã€‚ç„¶è€Œï¼Œç³»ç»Ÿçš„å†…éƒ¨çœ‹èµ·æ¥å¯èƒ½å®Œå…¨ä¸åŒï¼Œå› ä¸ºå®ƒä»¬é’ˆå¯¹éå¸¸ä¸åŒçš„æŸ¥è¯¢æ¨¡å¼è¿›è¡Œäº†ä¼˜åŒ–ã€‚ç°åœ¨è®¸å¤šæ•°æ®åº“ä¾›åº”å•†éƒ½å°†é‡ç‚¹æ”¾åœ¨æ”¯æŒäº‹åŠ¡å¤„ç†æˆ–åˆ†æå·¥ä½œè´Ÿè½½ä¸Šï¼Œè€Œä¸æ˜¯ä¸¤è€…éƒ½æ”¯æŒã€‚</p>
<h2 id="åˆ—å­˜å‚¨"><a href="#åˆ—å­˜å‚¨" class="headerlink" title="åˆ—å­˜å‚¨"></a>åˆ—å­˜å‚¨</h2><p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch3-3-10.png" alt=""></p>
<h2 id="åˆ—å‹ç¼©"><a href="#åˆ—å‹ç¼©" class="headerlink" title="åˆ—å‹ç¼©"></a>åˆ—å‹ç¼©</h2><p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch3-3-11.png" alt=""></p>
<h2 id="æ•°æ®ç«‹æ–¹ä½“"><a href="#æ•°æ®ç«‹æ–¹ä½“" class="headerlink" title="æ•°æ®ç«‹æ–¹ä½“"></a>æ•°æ®ç«‹æ–¹ä½“</h2><p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch3-3-12.png" alt=""></p>
]]></content>
      <categories>
        <category>DDIA</category>
      </categories>
      <tags>
        <tag>å­˜å‚¨</tag>
        <tag>æ£€ç´¢</tag>
      </tags>
  </entry>
  <entry>
    <title>[DDIA][ç¬¬å››ç« ]ï¼šç¼–ç ä¸æ¼”åŒ–</title>
    <url>/DDIA-ch4-coding-and-evo/</url>
    <content><![CDATA[<h1 id="ç¬¬å››ç« "><a href="#ç¬¬å››ç« " class="headerlink" title="ç¬¬å››ç« "></a>ç¬¬å››ç« </h1><p>å½“æ•°æ®æ ¼å¼ï¼ˆformatï¼‰æˆ–æ¨¡å¼ï¼ˆschemaï¼‰å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé€šå¸¸éœ€è¦å¯¹åº”ç”¨ç¨‹åºä»£ç è¿›è¡Œç›¸åº”çš„æ›´æ”¹ï¼ˆä¾‹å¦‚ï¼Œä¸ºè®°å½•æ·»åŠ æ–°å­—æ®µï¼Œç„¶åä¿®æ”¹ç¨‹åºå¼€å§‹è¯»å†™è¯¥å­—æ®µï¼‰ã€‚ä½†åœ¨å¤§å‹åº”ç”¨ç¨‹åºä¸­ï¼Œä»£ç å˜æ›´é€šå¸¸ä¸ä¼šç«‹å³å®Œæˆã€‚</p>
<p>è¿™æ„å‘³ç€ï¼Œæ–°æ—§ç‰ˆæœ¬çš„ä»£ç ï¼Œä»¥åŠæ–°æ—§æ•°æ®æ ¼å¼å¯èƒ½ä¼šåœ¨ç³»ç»Ÿä¸­åŒæ—¶å…±å¤„ã€‚ç³»ç»Ÿæƒ³è¦ç»§ç»­é¡ºåˆ©è¿è¡Œï¼Œå°±éœ€è¦ä¿æŒ<code>åŒå‘å…¼å®¹æ€§</code>ï¼š</p>
<p><em>å‘åå…¼å®¹ (backward compatibility)</em></p>
<p>â€‹ æ–°ä»£ç å¯ä»¥è¯»æ—§æ•°æ®ã€‚</p>
<p><em>å‘å‰å…¼å®¹ (forward compatibility)</em></p>
<p>â€‹ æ—§ä»£ç å¯ä»¥è¯»æ–°æ•°æ®ã€‚</p>
<p>æœ¬ç« ä¸­å°†ä»‹ç»å‡ ç§ç¼–ç æ•°æ®çš„æ ¼å¼ï¼ŒåŒ…æ‹¬ JSONï¼ŒXMLï¼ŒProtocol Buffersï¼ŒThriftå’ŒAvroã€‚ç„¶åå°†è®¨è®ºå¦‚ä½•ä½¿ç”¨è¿™äº›æ ¼å¼è¿›è¡Œæ•°æ®å­˜å‚¨å’Œé€šä¿¡ï¼šåœ¨WebæœåŠ¡ä¸­,<code>å…·è±¡çŠ¶æ€ä¼ è¾“ï¼ˆRESTï¼‰</code>å’Œ<code>è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰</code>ï¼Œä»¥åŠ<code>æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿ</code>ï¼ˆå¦‚Actorå’Œæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ã€‚</p>
<h2 id="ç¼–ç æ•°æ®çš„æ ¼å¼"><a href="#ç¼–ç æ•°æ®çš„æ ¼å¼" class="headerlink" title="ç¼–ç æ•°æ®çš„æ ¼å¼"></a>ç¼–ç æ•°æ®çš„æ ¼å¼</h2><p>å¦‚æœè¦å°†æ•°æ®å†™å…¥æ–‡ä»¶ï¼Œæˆ–é€šè¿‡ç½‘ç»œå‘é€ï¼Œåˆ™å¿…é¡»å°†å…¶ ç¼–ç ï¼ˆencodeï¼‰ ä¸ºæŸç§è‡ªåŒ…å«çš„å­—èŠ‚åºåˆ—ï¼ˆä¾‹å¦‚ï¼ŒJSONæ–‡æ¡£ï¼‰</p>
<p>ä»å†…å­˜ä¸­è¡¨ç¤ºåˆ°å­—èŠ‚åºåˆ—çš„è½¬æ¢ç§°ä¸º <code>ç¼–ç ï¼ˆEncodingï¼‰</code> ï¼ˆä¹Ÿç§°ä¸º<code>åºåˆ—åŒ–ï¼ˆserializationï¼‰</code>æˆ–<code>ç¼–ç»„ï¼ˆmarshallingï¼‰</code>ï¼‰ï¼Œåè¿‡æ¥ç§°ä¸º<code>è§£ç ï¼ˆDecodingï¼‰</code>ï¼ˆè§£æï¼ˆParsingï¼‰ï¼Œ<code>ååºåˆ—åŒ–ï¼ˆdeserializationï¼‰</code>ï¼Œ<code>åç¼–ç»„( unmarshallingï¼‰</code>ï¼‰</p>
<p>è®¸å¤šç¼–ç¨‹è¯­è¨€éƒ½å†…å»ºäº†å°†å†…å­˜å¯¹è±¡ç¼–ç ä¸ºå­—èŠ‚åºåˆ—çš„æ”¯æŒï¼š<br>Javaæœ‰<code>java.io.Serializable</code> ï¼ŒRubyæœ‰<code>Marshal</code>ï¼ŒPythonæœ‰<code>pickle</code>ç­‰ç­‰ã€‚</p>
<h3 id="JSONï¼ŒXMLå’ŒäºŒè¿›åˆ¶å˜ä½“"><a href="#JSONï¼ŒXMLå’ŒäºŒè¿›åˆ¶å˜ä½“" class="headerlink" title="JSONï¼ŒXMLå’ŒäºŒè¿›åˆ¶å˜ä½“"></a>JSONï¼ŒXMLå’ŒäºŒè¿›åˆ¶å˜ä½“</h3><ul>
<li>æ•°å­—çš„ç¼–ç å¤šæœ‰æ­§ä¹‰ä¹‹å¤„ã€‚XMLå’ŒCSVä¸èƒ½åŒºåˆ†æ•°å­—å’Œå­—ç¬¦ä¸²ï¼ˆé™¤éå¼•ç”¨å¤–éƒ¨æ¨¡å¼ï¼‰ã€‚ JSONè™½ç„¶åŒºåˆ†å­—ç¬¦ä¸²å’Œæ•°å­—ï¼Œä½†ä¸åŒºåˆ†æ•´æ•°å’Œæµ®ç‚¹æ•°ï¼Œè€Œä¸”ä¸èƒ½æŒ‡å®šç²¾åº¦ã€‚</li>
<li>å½“å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œè¿™ä¸ªé—®é¢˜æ›´ä¸¥é‡äº†ã€‚ä¾‹å¦‚ï¼Œå¤§äº$2^{53}$çš„æ•´æ•°ä¸èƒ½åœ¨IEEE 754åŒç²¾åº¦æµ®ç‚¹æ•°ä¸­ç²¾ç¡®è¡¨ç¤ºï¼Œå› æ­¤åœ¨ä½¿ç”¨æµ®ç‚¹æ•°ï¼ˆä¾‹å¦‚JavaScriptï¼‰çš„è¯­è¨€è¿›è¡Œåˆ†ææ—¶ï¼Œè¿™äº›æ•°å­—ä¼šå˜å¾—ä¸å‡†ç¡®ã€‚ Twitterä¸Šæœ‰ä¸€ä¸ªå¤§äº$2^{53}$çš„æ•°å­—çš„ä¾‹å­ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ª64ä½çš„æ•°å­—æ¥æ ‡è¯†æ¯æ¡æ¨æ–‡ã€‚ Twitter APIè¿”å›çš„JSONåŒ…å«äº†ä¸¤ç§æ¨ç‰¹IDï¼Œä¸€ä¸ªJSONæ•°å­—ï¼Œå¦ä¸€ä¸ªæ˜¯åè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä»¥æ­¤é¿å…JavaScriptç¨‹åºæ— æ³•æ­£ç¡®è§£ææ•°å­—çš„é—®é¢˜ã€‚</li>
<li>JSONå’ŒXMLå¯¹Unicodeå­—ç¬¦ä¸²ï¼ˆå³äººç±»å¯è¯»çš„æ–‡æœ¬ï¼‰æœ‰å¾ˆå¥½çš„æ”¯æŒï¼Œä½†æ˜¯å®ƒä»¬ä¸æ”¯æŒäºŒè¿›åˆ¶æ•°æ®ï¼ˆä¸å¸¦å­—ç¬¦ç¼–ç (character encoding)çš„å­—èŠ‚åºåˆ—ï¼‰ã€‚äºŒè¿›åˆ¶ä¸²æ˜¯å¾ˆå®ç”¨çš„åŠŸèƒ½ï¼Œæ‰€ä»¥äººä»¬é€šè¿‡ä½¿ç”¨Base64å°†äºŒè¿›åˆ¶æ•°æ®ç¼–ç ä¸ºæ–‡æœ¬æ¥ç»•å¼€è¿™ä¸ªé™åˆ¶ã€‚æ¨¡å¼ç„¶åç”¨äºè¡¨ç¤ºè¯¥å€¼åº”è¯¥è¢«è§£é‡Šä¸ºBase64ç¼–ç ã€‚è¿™ä¸ªå·¥ä½œï¼Œä½†å®ƒæœ‰ç‚¹hackyï¼Œå¹¶å¢åŠ äº†33ï¼…çš„æ•°æ®å¤§å°ã€‚ XMLå’ŒJSONéƒ½æœ‰å¯é€‰çš„æ¨¡å¼æ”¯æŒã€‚è¿™äº›æ¨¡å¼è¯­è¨€ç›¸å½“å¼ºå¤§ï¼Œæ‰€ä»¥å­¦ä¹ å’Œå®ç°èµ·æ¥ç›¸å½“å¤æ‚ã€‚ XMLæ¨¡å¼çš„ä½¿ç”¨ç›¸å½“æ™®éï¼Œä½†è®¸å¤šåŸºäºJSONçš„å·¥å…·å«Œéº»çƒ¦æ‰ä¸ä¼šä½¿ç”¨æ¨¡å¼ã€‚ç”±äºæ•°æ®çš„æ­£ç¡®è§£é‡Šï¼ˆä¾‹å¦‚æ•°å­—å’ŒäºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼‰å–å†³äºæ¨¡å¼ä¸­çš„ä¿¡æ¯ï¼Œå› æ­¤ä¸ä½¿ç”¨XML/JSONæ¨¡å¼çš„åº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦å¯¹ç›¸åº”çš„ç¼–ç /è§£ç é€»è¾‘è¿›è¡Œç¡¬ç¼–ç ã€‚</li>
<li>CSVæ²¡æœ‰ä»»ä½•æ¨¡å¼ï¼Œå› æ­¤åº”ç”¨ç¨‹åºéœ€è¦å®šä¹‰æ¯è¡Œå’Œæ¯åˆ—çš„å«ä¹‰ã€‚å¦‚æœåº”ç”¨ç¨‹åºæ›´æ”¹æ·»åŠ æ–°çš„è¡Œæˆ–åˆ—ï¼Œåˆ™å¿…é¡»æ‰‹åŠ¨å¤„ç†è¯¥å˜æ›´ã€‚ CSVä¹Ÿæ˜¯ä¸€ä¸ªç›¸å½“æ¨¡ç³Šçš„æ ¼å¼ï¼ˆå¦‚æœä¸€ä¸ªå€¼åŒ…å«é€—å·æˆ–æ¢è¡Œç¬¦ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿï¼‰ã€‚å°½ç®¡å…¶è½¬ä¹‰è§„åˆ™å·²ç»è¢«æ­£å¼æŒ‡å®šï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„è§£æå™¨éƒ½æ­£ç¡®çš„å®ç°äº†æ ‡å‡†ã€‚</li>
</ul>
<h3 id="äºŒè¿›åˆ¶ç¼–ç "><a href="#äºŒè¿›åˆ¶ç¼–ç " class="headerlink" title="äºŒè¿›åˆ¶ç¼–ç "></a>äºŒè¿›åˆ¶ç¼–ç </h3><p>JSONæ¯”XMLç®€æ´ï¼Œä½†ä¸äºŒè¿›åˆ¶æ ¼å¼ä¸€æ¯”ï¼Œè¿˜æ˜¯å¤ªå åœ°æ–¹ã€‚è¿™ä¸€äº‹å®å¯¼è‡´å¤§é‡äºŒè¿›åˆ¶ç¼–ç ç‰ˆæœ¬JSON &amp; XMLçš„å‡ºç°ï¼ŒJSONï¼ˆMessagePackï¼ŒBSONï¼ŒBJSONï¼ŒUBJSONï¼ŒBISONå’ŒSmileç­‰ï¼‰ï¼ˆä¾‹å¦‚WBXMLå’ŒFast Infosetï¼‰ã€‚è¿™äº›æ ¼å¼å·²ç»è¢«å„ç§å„æ ·çš„é¢†åŸŸæ‰€é‡‡ç”¨ï¼Œä½†æ˜¯æ²¡æœ‰ä¸€ä¸ªåƒJSONå’ŒXMLçš„æ–‡æœ¬ç‰ˆæœ¬é‚£æ ·è¢«å¹¿æ³›é‡‡ç”¨ã€‚</p>
<p>81ä¸ªå­—èŠ‚<br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"userName"</span>: <span class="string">"Martin"</span>,</span><br><span class="line">    <span class="attr">"favoriteNumber"</span>: <span class="number">1337</span>,</span><br><span class="line">    <span class="attr">"interests"</span>: [<span class="string">"daydreaming"</span>, <span class="string">"hacking"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>66ä¸ªå­—èŠ‚<br><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch4-4-1.png" alt=""></p>
<ol>
<li>ç¬¬ä¸€ä¸ªå­—èŠ‚0x83è¡¨ç¤ºæ¥ä¸‹æ¥æ˜¯3ä¸ªå­—æ®µï¼ˆä½å››ä½=<code>0x03</code>ï¼‰çš„å¯¹è±¡ objectï¼ˆé«˜å››ä½=<code>0x80</code>ï¼‰ã€‚ ï¼ˆå¦‚æœæƒ³çŸ¥é“å¦‚æœä¸€ä¸ªå¯¹è±¡æœ‰15ä¸ªä»¥ä¸Šçš„å­—æ®µä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Œå­—æ®µçš„æ•°é‡å¡ä¸è¿›4ä¸ªbité‡Œï¼Œé‚£ä¹ˆå®ƒä¼šç”¨å¦ä¸€ä¸ªä¸åŒçš„ç±»å‹æ ‡è¯†ç¬¦ï¼Œå­—æ®µçš„æ•°é‡è¢«ç¼–ç ä¸¤ä¸ªæˆ–å››ä¸ªå­—èŠ‚ï¼‰ã€‚</li>
<li>ç¬¬äºŒä¸ªå­—èŠ‚<code>0xa8</code>è¡¨ç¤ºæ¥ä¸‹æ¥æ˜¯8å­—èŠ‚é•¿çš„å­—ç¬¦ä¸²ï¼ˆæœ€é«˜å››ä½=<code>0x08</code>ï¼‰ã€‚</li>
<li>æ¥ä¸‹æ¥å…«ä¸ªå­—èŠ‚æ˜¯ASCIIå­—ç¬¦ä¸²å½¢å¼çš„å­—æ®µåç§°userNameã€‚ç”±äºä¹‹å‰å·²ç»æŒ‡æ˜é•¿åº¦ï¼Œä¸éœ€è¦ä»»ä½•æ ‡è®°æ¥æ ‡è¯†å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ï¼ˆæˆ–è€…ä»»ä½•è½¬ä¹‰ï¼‰ã€‚</li>
<li>æ¥ä¸‹æ¥çš„ä¸ƒä¸ªå­—èŠ‚å¯¹å‰ç¼€ä¸º0xa6çš„å…­ä¸ªå­—æ¯çš„å­—ç¬¦ä¸²å€¼Martinè¿›è¡Œç¼–ç ï¼Œä¾æ­¤ç±»æ¨ã€‚</li>
</ol>
<h3 id="Thriftä¸Protocol-Buffers"><a href="#Thriftä¸Protocol-Buffers" class="headerlink" title="Thriftä¸Protocol Buffers"></a>Thriftä¸Protocol Buffers</h3><p>æ¥å£å®šä¹‰è¯­è¨€(IDL)</p>
<p><em>Thrift</em><br><figure class="highlight thrift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="number">1</span>: <span class="keyword">required</span> <span class="built_in">string</span>       userName,</span><br><span class="line">    <span class="number">2</span>: <span class="keyword">optional</span> <span class="built_in">i64</span>          favoriteNumber,</span><br><span class="line">    <span class="number">3</span>: <span class="keyword">optional</span> list&lt;<span class="keyword">string</span>&gt; interests</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>Protocol Buffers</em><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">message Person &#123;</span><br><span class="line">    required string user_name       &#x3D; 1;</span><br><span class="line">    optional int64  favorite_number &#x3D; 2;</span><br><span class="line">    repeated string interests       &#x3D; 3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Thriftæœ‰ä¸¤ç§ä¸åŒçš„äºŒè¿›åˆ¶ç¼–ç æ ¼å¼ï¼Œåˆ†åˆ«ç§°ä¸ºBinaryProtocolå’ŒCompactProtocol</p>
<p>59ä¸ªå­—èŠ‚<br><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch4-4-2.png" alt=""></p>
<p>ä¸ä¸Šé¢ç›¸æ¯”ï¼Œæœ€å¤§çš„åŒºåˆ«æ˜¯æ²¡æœ‰å­—æ®µå(userName, favoriteNumber, interest)ã€‚ç›¸åï¼Œç¼–ç æ•°æ®åŒ…å«å­—æ®µæ ‡ç­¾ï¼Œå®ƒä»¬æ˜¯æ•°å­—(1, 2å’Œ3)ã€‚è¿™äº›æ˜¯æ¨¡å¼å®šä¹‰ä¸­å‡ºç°çš„æ•°å­—</p>
<p>34ä¸ªå­—èŠ‚<br><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch4-4-3.png" alt=""></p>
<p>æ•°å­—1337ä¸æ˜¯ä½¿ç”¨å…¨éƒ¨å…«ä¸ªå­—èŠ‚ï¼Œè€Œæ˜¯ç”¨ä¸¤ä¸ªå­—èŠ‚ç¼–ç ï¼Œæ¯ä¸ªå­—èŠ‚çš„æœ€é«˜ä½ç”¨æ¥æŒ‡ç¤ºæ˜¯å¦è¿˜æœ‰æ›´å¤šçš„å­—èŠ‚æ¥</p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch4-4-4.png" alt=""></p>
<h3 id="å­—æ®µæ ‡ç­¾å’Œæ¨¡å¼æ¼”å˜"><a href="#å­—æ®µæ ‡ç­¾å’Œæ¨¡å¼æ¼”å˜" class="headerlink" title="å­—æ®µæ ‡ç­¾å’Œæ¨¡å¼æ¼”å˜"></a>å­—æ®µæ ‡ç­¾å’Œæ¨¡å¼æ¼”å˜</h3><p>æ¯ä¸ªå­—æ®µç”±å…¶æ ‡ç­¾å·ç ï¼ˆæ ·æœ¬æ¨¡å¼ä¸­çš„æ•°å­—1,2,3ï¼‰æ ‡è¯†ï¼Œå¹¶ç”¨æ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚å­—ç¬¦ä¸²æˆ–æ•´æ•°ï¼‰æ³¨é‡Šã€‚å¦‚æœæ²¡æœ‰è®¾ç½®å­—æ®µå€¼ï¼Œåˆ™ç®€å•åœ°ä»ç¼–ç è®°å½•ä¸­çœç•¥ã€‚ä»ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå­—æ®µæ ‡è®°å¯¹ç¼–ç æ•°æ®çš„å«ä¹‰è‡³å…³é‡è¦ã€‚å¯ä»¥æ›´æ”¹æ¶æ„ä¸­å­—æ®µçš„åç§°ï¼Œå› ä¸ºç¼–ç çš„æ•°æ®æ°¸è¿œä¸ä¼šå¼•ç”¨å­—æ®µåç§°ï¼Œä½†ä¸èƒ½æ›´æ”¹å­—æ®µçš„æ ‡è®°ï¼Œå› ä¸ºè¿™ä¼šä½¿æ‰€æœ‰ç°æœ‰çš„ç¼–ç æ•°æ®æ— æ•ˆã€‚</p>
<p>æ‚¨å¯ä»¥æ·»åŠ æ–°çš„å­—æ®µåˆ°æ¶æ„ï¼Œåªè¦æ‚¨ç»™æ¯ä¸ªå­—æ®µä¸€ä¸ªæ–°çš„æ ‡ç­¾å·ç ã€‚å¦‚æœæ—§çš„ä»£ç ï¼ˆä¸çŸ¥é“ä½ æ·»åŠ çš„æ–°çš„æ ‡ç­¾å·ç ï¼‰è¯•å›¾è¯»å–æ–°ä»£ç å†™å…¥çš„æ•°æ®ï¼ŒåŒ…æ‹¬ä¸€ä¸ªæ–°çš„å­—æ®µï¼Œå…¶æ ‡ç­¾å·ç ä¸èƒ½è¯†åˆ«ï¼Œå®ƒå¯ä»¥ç®€å•åœ°å¿½ç•¥è¯¥å­—æ®µã€‚æ•°æ®ç±»å‹æ³¨é‡Šå…è®¸è§£æå™¨ç¡®å®šéœ€è¦è·³è¿‡çš„å­—èŠ‚æ•°ã€‚è¿™ä¿æŒäº†å‰å‘å…¼å®¹æ€§ï¼šæ—§ä»£ç å¯ä»¥è¯»å–ç”±æ–°ä»£ç ç¼–å†™çš„è®°å½•ã€‚</p>
<p>å‘åå…¼å®¹æ€§å‘¢ï¼Ÿåªè¦æ¯ä¸ªå­—æ®µéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡ç­¾å·ç ï¼Œæ–°çš„ä»£ç æ€»æ˜¯å¯ä»¥è¯»å–æ—§çš„æ•°æ®ï¼Œå› ä¸ºæ ‡ç­¾å·ç ä»ç„¶å…·æœ‰ç›¸åŒçš„å«ä¹‰ã€‚å”¯ä¸€çš„ç»†èŠ‚æ˜¯ï¼Œå¦‚æœä½ æ·»åŠ ä¸€ä¸ªæ–°çš„é¢†åŸŸï¼Œä½ ä¸èƒ½è¦æ±‚ï¼Œå¦‚æœæ‚¨è¦æ·»åŠ ä¸€ä¸ªå­—æ®µå¹¶å°†å…¶è®¾ç½®ä¸ºå¿…éœ€ï¼Œé‚£ä¹ˆå¦‚æœæ–°ä»£ç è¯»å–æ—§ä»£ç å†™å…¥çš„æ•°æ®ï¼Œåˆ™è¯¥æ£€æŸ¥å°†å¤±è´¥ï¼Œå› ä¸ºæ—§ä»£ç ä¸ä¼šå†™å…¥æ‚¨æ·»åŠ çš„æ–°å­—æ®µã€‚å› æ­¤ï¼Œä¸ºäº†ä¿æŒå‘åå…¼å®¹æ€§ï¼Œåœ¨æ¨¡å¼çš„åˆå§‹éƒ¨ç½²ä¹‹å <code>æ·»åŠ çš„æ¯ä¸ªå­—æ®µå¿…é¡»æ˜¯å¯é€‰çš„æˆ–å…·æœ‰é»˜è®¤å€¼</code>ã€‚</p>
<h3 id="æ•°æ®ç±»å‹å’Œæ¨¡å¼æ¼”å˜"><a href="#æ•°æ®ç±»å‹å’Œæ¨¡å¼æ¼”å˜" class="headerlink" title="æ•°æ®ç±»å‹å’Œæ¨¡å¼æ¼”å˜"></a>æ•°æ®ç±»å‹å’Œæ¨¡å¼æ¼”å˜</h3><p>Protobufçš„ä¸€ä¸ªå¥‡æ€ªçš„ç»†èŠ‚æ˜¯ï¼Œå®ƒæ²¡æœ‰åˆ—è¡¨æˆ–æ•°ç»„æ•°æ®ç±»å‹ï¼Œè€Œæ˜¯æœ‰ä¸€ä¸ªå­—æ®µçš„é‡å¤æ ‡è®°ï¼Œè¯»å–æ—§æ•°æ®çš„æ–°ä»£ç ä¼šçœ‹åˆ°ä¸€ä¸ªåŒ…å«é›¶ä¸ªæˆ–ä¸€ä¸ªå…ƒç´ çš„åˆ—è¡¨ï¼ˆå–å†³äºè¯¥å­—æ®µæ˜¯å¦å­˜åœ¨ï¼‰ã€‚è¯»å–æ–°æ•°æ®çš„æ—§ä»£ç åªèƒ½çœ‹åˆ°åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚</p>
<p>Thriftæœ‰ä¸€ä¸ªä¸“ç”¨çš„åˆ—è¡¨æ•°æ®ç±»å‹ï¼Œå®ƒä½¿ç”¨åˆ—è¡¨å…ƒç´ çš„æ•°æ®ç±»å‹è¿›è¡Œå‚æ•°åŒ–ã€‚è¿™ä¸å…è®¸Protocol Buffersæ‰€åšçš„ä»å•å€¼åˆ°å¤šå€¼çš„ç›¸åŒæ¼”å˜ï¼Œä½†æ˜¯å®ƒå…·æœ‰æ”¯æŒåµŒå¥—åˆ—è¡¨çš„ä¼˜ç‚¹ã€‚</p>
<h3 id="Avro"><a href="#Avro" class="headerlink" title="Avro"></a>Avro</h3><p>IDL</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">record Person &#123;</span><br><span class="line">    string                userName;</span><br><span class="line">    union &#123; null, long &#125;  favoriteNumber &#x3D; null;</span><br><span class="line">    array&lt;string&gt;         interests;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç­‰ä»·çš„JSON</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"type"</span>: <span class="string">"record"</span>,</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"Person"</span>,</span><br><span class="line">    <span class="attr">"fields"</span>: [</span><br><span class="line">        &#123;<span class="attr">"name"</span>: <span class="string">"userName"</span>, <span class="attr">"type"</span>: <span class="string">"string"</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"name"</span>: <span class="string">"favoriteNumber"</span>, <span class="attr">"type"</span>: [<span class="string">"null"</span>, <span class="string">"long"</span>], <span class="attr">"default"</span>: <span class="literal">null</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">"name"</span>: <span class="string">"interests"</span>, <span class="attr">"type"</span>: &#123;<span class="attr">"type"</span>: <span class="string">"array"</span>, <span class="attr">"items"</span>: <span class="string">"string"</span>&#125;</span><br><span class="line">    ] </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>32ä¸ªå­—èŠ‚<br><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch4-4-5.png" alt=""></p>
<p>æ•´æ•°ä½¿ç”¨å¯å˜é•¿åº¦ç¼–ç ï¼ˆä¸Thriftçš„CompactProtocolç›¸åŒï¼‰è¿›è¡Œç¼–ç ã€‚</p>
<p>ä¸ºäº†è§£æäºŒè¿›åˆ¶æ•°æ®ï¼Œæ‚¨æŒ‰ç…§å®ƒä»¬å‡ºç°åœ¨æ¶æ„ä¸­çš„é¡ºåºéå†è¿™äº›å­—æ®µï¼Œå¹¶ä½¿ç”¨æ¶æ„æ¥å‘Šè¯‰æ¯ä¸ªå­—æ®µçš„æ•°æ®ç±»å‹ã€‚è¿™æ„å‘³ç€å¦‚æœè¯»å–æ•°æ®çš„ä»£ç ä½¿ç”¨ä¸å†™å…¥æ•°æ®çš„ä»£ç å®Œå…¨ç›¸åŒçš„æ¨¡å¼ï¼Œåˆ™åªèƒ½æ­£ç¡®è§£ç äºŒè¿›åˆ¶æ•°æ®ã€‚è¯»è€…å’Œä½œè€…ä¹‹é—´çš„æ¨¡å¼ä¸åŒ¹é…æ„å‘³ç€é”™è¯¯åœ°è§£ç æ•°æ®ã€‚</p>
<h3 id="ä½œè€…æ¨¡å¼ä¸è¯»è€…æ¨¡å¼"><a href="#ä½œè€…æ¨¡å¼ä¸è¯»è€…æ¨¡å¼" class="headerlink" title="ä½œè€…æ¨¡å¼ä¸è¯»è€…æ¨¡å¼"></a>ä½œè€…æ¨¡å¼ä¸è¯»è€…æ¨¡å¼</h3><p>å½“åº”ç”¨ç¨‹åºæƒ³è¦ç¼–ç ä¸€äº›æ•°æ®ï¼ˆå°†å…¶å†™å…¥æ–‡ä»¶æˆ–æ•°æ®åº“ï¼Œé€šè¿‡ç½‘ç»œå‘é€ç­‰ï¼‰æ—¶ï¼Œå®ƒä½¿ç”¨å®ƒçŸ¥é“çš„ä»»ä½•ç‰ˆæœ¬çš„æ¨¡å¼ç¼–ç æ•°æ®ï¼Œä¾‹å¦‚ï¼Œæ¶æ„å¯èƒ½è¢«ç¼–è¯‘åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚è¿™è¢«ç§°ä¸ºä½œè€…çš„æ¨¡å¼ã€‚</p>
<p>å½“ä¸€ä¸ªåº”ç”¨ç¨‹åºæƒ³è¦è§£ç ä¸€äº›æ•°æ®ï¼ˆä»ä¸€ä¸ªæ–‡ä»¶æˆ–æ•°æ®åº“è¯»å–æ•°æ®ï¼Œä»ç½‘ç»œæ¥æ”¶æ•°æ®ç­‰ï¼‰æ—¶ï¼Œå®ƒå¸Œæœ›æ•°æ®åœ¨æŸä¸ªæ¨¡å¼ä¸­ï¼Œè¿™å°±æ˜¯è¯»è€…çš„æ¨¡å¼ã€‚</p>
<p>Avroçš„å…³é”®æ€æƒ³æ˜¯ä½œè€…çš„æ¨¡å¼å’Œè¯»è€…çš„æ¨¡å¼ä¸å¿…æ˜¯ç›¸åŒçš„ - ä»–ä»¬åªéœ€è¦å…¼å®¹ã€‚å½“æ•°æ®è§£ç ï¼ˆè¯»å–ï¼‰æ—¶ï¼ŒAvroåº“é€šè¿‡å¹¶æ’æŸ¥çœ‹ä½œè€…çš„æ¨¡å¼å’Œè¯»è€…çš„æ¨¡å¼å¹¶å°†æ•°æ®ä»ä½œè€…çš„æ¨¡å¼è½¬æ¢åˆ°è¯»è€…çš„æ¨¡å¼æ¥è§£å†³å·®å¼‚ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch4-4-6.png" alt=""></p>
<h3 id="æ¨¡å¼æ¼”å˜è§„åˆ™"><a href="#æ¨¡å¼æ¼”å˜è§„åˆ™" class="headerlink" title="æ¨¡å¼æ¼”å˜è§„åˆ™"></a>æ¨¡å¼æ¼”å˜è§„åˆ™</h3><p>ä¸ºäº†ä¿æŒå…¼å®¹æ€§ï¼Œæ‚¨åªèƒ½æ·»åŠ æˆ–åˆ é™¤å…·æœ‰é»˜è®¤å€¼çš„å­—æ®µã€‚</p>
<p>å¦‚æœè¦å…è®¸ä¸€ä¸ªå­—æ®µä¸ºnullï¼Œåˆ™å¿…é¡»ä½¿ç”¨è”åˆç±»å‹ã€‚ä¾‹å¦‚ï¼Œunion {nullï¼Œlongï¼Œstring}å­—æ®µ;è¡¨ç¤ºè¯¥å­—æ®µå¯ä»¥æ˜¯æ•°å­—æˆ–å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯nullã€‚å¦‚æœå®ƒæ˜¯unionçš„åˆ†æ”¯ä¹‹ä¸€ï¼Œé‚£ä¹ˆåªèƒ½ä½¿ç”¨nullä½œä¸ºé»˜è®¤å€¼ã€‚è¿™æ¯”é»˜è®¤æƒ…å†µä¸‹å¯ä»¥ä¸ºnullæ˜¯æ›´åŠ å†—é•¿çš„ï¼Œä½†æ˜¯é€šè¿‡æ˜ç¡®ä»€ä¹ˆå¯ä»¥å’Œä¸å¯ä»¥æ˜¯ä»€ä¹ˆï¼Œæœ‰åŠ©äºé˜²æ­¢é”™è¯¯çš„null</p>
<p>åªè¦Avroå¯ä»¥è½¬æ¢ç±»å‹ï¼Œå°±å¯ä»¥æ”¹å˜å­—æ®µçš„æ•°æ®ç±»å‹ã€‚æ›´æ”¹å­—æ®µçš„åç§°æ˜¯å¯èƒ½çš„ï¼Œä½†æœ‰ç‚¹æ£˜æ‰‹ï¼šè¯»è€…çš„æ¨¡å¼å¯ä»¥åŒ…å«å­—æ®µåç§°çš„åˆ«åï¼Œæ‰€ä»¥å®ƒå¯ä»¥åŒ¹é…æ—§ä½œå®¶çš„æ¨¡å¼å­—æ®µåç§°ä¸åˆ«åã€‚è¿™æ„å‘³ç€æ›´æ”¹å­—æ®µåç§°æ˜¯å‘åå…¼å®¹çš„ï¼Œä½†ä¸èƒ½å‘å‰å…¼å®¹ã€‚åŒæ ·ï¼Œå‘è”åˆç±»å‹æ·»åŠ åˆ†æ”¯ä¹Ÿæ˜¯å‘åå…¼å®¹çš„ï¼Œä½†ä¸èƒ½å‘å‰å…¼å®¹ã€‚</p>
<h3 id="åŠ¨æ€ç”Ÿæˆçš„æ¨¡å¼"><a href="#åŠ¨æ€ç”Ÿæˆçš„æ¨¡å¼" class="headerlink" title="åŠ¨æ€ç”Ÿæˆçš„æ¨¡å¼"></a>åŠ¨æ€ç”Ÿæˆçš„æ¨¡å¼</h3><p>Avroæ–¹æ³•çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯æ¶æ„ä¸åŒ…å«ä»»ä½•æ ‡ç­¾å·ç ã€‚</p>
<p>å¦‚æœæ•°æ®åº“æ¨¡å¼å‘ç”Ÿå˜åŒ–ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªè¡¨ä¸­æ·»åŠ äº†ä¸€åˆ—ï¼Œåˆ é™¤äº†ä¸€åˆ—ï¼‰ï¼Œåˆ™å¯ä»¥ä»æ›´æ–°çš„æ•°æ®åº“æ¨¡å¼ç”Ÿæˆæ–°çš„Avroæ¨¡å¼ï¼Œå¹¶åœ¨æ–°çš„Avroæ¨¡å¼ä¸­å¯¼å‡ºæ•°æ®ã€‚æ•°æ®å¯¼å‡ºè¿‡ç¨‹ä¸éœ€è¦æ³¨æ„æ¨¡å¼çš„æ”¹å˜ - æ¯æ¬¡è¿è¡Œæ—¶éƒ½å¯ä»¥ç®€å•åœ°è¿›è¡Œæ¨¡å¼è½¬æ¢ã€‚</p>
<p>ä½¿ç”¨Thriftæˆ–Protocol Buffersï¼Œåˆ™å­—æ®µæ ‡è®°å¯èƒ½å¿…é¡»æ‰‹åŠ¨åˆ†é…ï¼šæ¯æ¬¡æ•°æ®åº“æ¨¡å¼æ›´æ”¹æ—¶ï¼Œç®¡ç†å‘˜éƒ½å¿…é¡»æ‰‹åŠ¨æ›´æ–°ä»æ•°æ®åº“åˆ—ååˆ°å­—æ®µæ ‡ç­¾ã€‚</p>
<h3 id="æ¨¡å¼çš„ä¼˜ç‚¹"><a href="#æ¨¡å¼çš„ä¼˜ç‚¹" class="headerlink" title="æ¨¡å¼çš„ä¼˜ç‚¹"></a>æ¨¡å¼çš„ä¼˜ç‚¹</h3><p>Protocol Buffersï¼ŒThriftå’ŒAvroéƒ½ä½¿ç”¨æ¨¡å¼æ¥æè¿°äºŒè¿›åˆ¶ç¼–ç æ ¼å¼ã€‚ä»–ä»¬çš„æ¨¡å¼è¯­è¨€æ¯”XMLæ¨¡å¼æˆ–è€…JSONæ¨¡å¼ç®€å•å¾—å¤šï¼Œå®ƒæ”¯æŒæ›´è¯¦ç»†çš„éªŒè¯è§„åˆ™ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå°½ç®¡JSONï¼ŒXMLå’ŒCSVç­‰æ–‡æœ¬æ•°æ®æ ¼å¼éå¸¸æ™®éï¼Œä½†åŸºäºæ¨¡å¼çš„äºŒè¿›åˆ¶ç¼–ç ä¹Ÿæ˜¯ä¸€ä¸ªå¯è¡Œçš„é€‰æ‹©ã€‚ä»–ä»¬æœ‰ä¸€äº›å¾ˆå¥½çš„å±æ€§ï¼š</p>
<ul>
<li>å®ƒä»¬å¯ä»¥æ¯”å„ç§â€œäºŒè¿›åˆ¶JSONâ€å˜ä½“æ›´ç´§å‡‘ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥çœç•¥ç¼–ç æ•°æ®ä¸­çš„å­—æ®µåç§°ã€‚</li>
<li>æ¨¡å¼æ˜¯ä¸€ç§æœ‰ä»·å€¼çš„æ–‡æ¡£å½¢å¼ï¼Œå› ä¸ºæ¨¡å¼æ˜¯è§£ç æ‰€å¿…éœ€çš„ï¼Œæ‰€ä»¥å¯ä»¥ç¡®å®šå®ƒæ˜¯æœ€æ–°çš„ï¼ˆè€Œæ‰‹åŠ¨ç»´æŠ¤çš„æ–‡æ¡£å¯èƒ½å¾ˆå®¹æ˜“åç¦»ç°å®ï¼‰ã€‚</li>
<li>ä¿ç•™æ¨¡å¼æ•°æ®åº“å…è®¸æ‚¨åœ¨éƒ¨ç½²ä»»ä½•å†…å®¹ä¹‹å‰æ£€æŸ¥æ¨¡å¼æ›´æ”¹çš„å‘å‰å’Œå‘åå…¼å®¹æ€§ã€‚</li>
<li>å¯¹äºé™æ€ç±»å‹ç¼–ç¨‹è¯­è¨€çš„ç”¨æˆ·æ¥è¯´ï¼Œä»æ¨¡å¼ç”Ÿæˆä»£ç çš„èƒ½åŠ›æ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨ç¼–è¯‘æ—¶è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚<br>æ€»è€Œè¨€ä¹‹ï¼Œæ¨¡å¼è¿›åŒ–å…è®¸ä¸JSONæ•°æ®åº“æä¾›çš„æ— æ¨¡å¼/æ¨¡å¼è¯»å–ç›¸åŒçš„çµæ´»æ€§ï¼ŒåŒæ—¶è¿˜å¯ä»¥æ›´å¥½åœ°ä¿è¯æ•°æ®å’Œæ›´å¥½çš„å·¥å…·ã€‚</li>
</ul>
<h2 id="æ•°æ®æµçš„ç±»å‹"><a href="#æ•°æ®æµçš„ç±»å‹" class="headerlink" title="æ•°æ®æµçš„ç±»å‹"></a>æ•°æ®æµçš„ç±»å‹</h2><p>å¦‚æœå°†æ•°æ®åº“å€¼è§£ç ä¸ºåº”ç”¨ç¨‹åºä¸­çš„æ¨¡å‹å¯¹è±¡ï¼Œç¨åé‡æ–°ç¼–ç è¿™äº›æ¨¡å‹å¯¹è±¡ï¼Œé‚£ä¹ˆæœªçŸ¥å­—æ®µå¯èƒ½ä¼šåœ¨è¯¥ç¿»è¯‘è¿‡ç¨‹ä¸­ä¸¢å¤±ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/DDIA-ch4-4-7.png" alt=""></p>
<h3 id="RESTä¸RPC"><a href="#RESTä¸RPC" class="headerlink" title="RESTä¸RPC"></a>RESTä¸RPC</h3><p>æœåŠ¡å™¨æœ¬èº«å¯ä»¥æ˜¯å¦ä¸€ä¸ªæœåŠ¡çš„å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ï¼Œå…¸å‹çš„Webåº”ç”¨æœåŠ¡å™¨å……å½“æ•°æ®åº“çš„å®¢æˆ·ç«¯ï¼‰ã€‚è¿™ç§æ–¹æ³•é€šå¸¸ç”¨äºå°†å¤§å‹åº”ç”¨ç¨‹åºæŒ‰ç…§åŠŸèƒ½åŒºåŸŸåˆ†è§£ä¸ºè¾ƒå°çš„æœåŠ¡ï¼Œè¿™æ ·å½“ä¸€ä¸ªæœåŠ¡éœ€è¦æ¥è‡ªå¦ä¸€ä¸ªæœåŠ¡çš„æŸäº›åŠŸèƒ½æˆ–æ•°æ®æ—¶ï¼Œå°±ä¼šå‘å¦ä¸€ä¸ªæœåŠ¡å‘å‡ºè¯·æ±‚ã€‚è¿™ç§æ„å»ºåº”ç”¨ç¨‹åºçš„æ–¹å¼ä¼ ç»Ÿä¸Šè¢«ç§°ä¸º <code>é¢å‘æœåŠ¡çš„ä½“ç³»ç»“æ„ï¼ˆservice-oriented architectureï¼ŒSOAï¼‰</code> ï¼Œæœ€è¿‘è¢«æ”¹è¿›å’Œæ›´åä¸º <code>å¾®æœåŠ¡æ¶æ„</code>ã€‚</p>
<h4 id="WebæœåŠ¡"><a href="#WebæœåŠ¡" class="headerlink" title="WebæœåŠ¡"></a>WebæœåŠ¡</h4><p>å½“æœåŠ¡ä½¿ç”¨HTTPä½œä¸ºåº•å±‚é€šä¿¡åè®®æ—¶ï¼Œå¯ç§°ä¹‹ä¸ºWebæœåŠ¡ã€‚</p>
<p>æœ‰ä¸¤ç§æµè¡Œçš„WebæœåŠ¡æ–¹æ³•ï¼šRESTå’ŒSOAPã€‚ä»–ä»¬åœ¨å“²å­¦æ–¹é¢å‡ ä¹æ˜¯æˆªç„¶ç›¸åçš„ï¼Œå¾€å¾€æ˜¯å„è‡ªæ”¯æŒè€…ä¹‹é—´çš„æ¿€çƒˆè¾©è®ºã€‚</p>
<p>RESTä¸æ˜¯ä¸€ä¸ªåè®®ï¼Œè€Œæ˜¯ä¸€ä¸ªåŸºäºHTTPåŸåˆ™çš„è®¾è®¡å“²å­¦ã€‚å®ƒå¼ºè°ƒç®€å•çš„æ•°æ®æ ¼å¼ï¼Œä½¿ç”¨URLæ¥æ ‡è¯†èµ„æºï¼Œå¹¶ä½¿ç”¨HTTPåŠŸèƒ½è¿›è¡Œç¼“å­˜æ§åˆ¶ï¼Œèº«ä»½éªŒè¯å’Œå†…å®¹ç±»å‹åå•†ã€‚ä¸SOAPç›¸æ¯”ï¼ŒRESTå·²ç»è¶Šæ¥è¶Šå—æ¬¢è¿ï¼Œè‡³å°‘åœ¨è·¨ç»„ç»‡æœåŠ¡é›†æˆçš„èƒŒæ™¯ä¸‹ï¼Œå¹¶ç»å¸¸ä¸å¾®æœåŠ¡ç›¸å…³ã€‚æ ¹æ®RESTåŸåˆ™è®¾è®¡çš„APIç§°ä¸ºRESTfulã€‚</p>
<p>SOAPæ˜¯ç”¨äºåˆ¶ä½œç½‘ç»œAPIè¯·æ±‚çš„åŸºäºXMLçš„åè®®ï¼ˆ å°½ç®¡é¦–å­—æ¯ç¼©å†™è¯ç›¸ä¼¼ï¼ŒSOAPå¹¶ä¸æ˜¯SOAçš„è¦æ±‚ã€‚ SOAPæ˜¯ä¸€ç§ç‰¹æ®Šçš„æŠ€æœ¯ï¼Œè€ŒSOAæ˜¯æ„å»ºç³»ç»Ÿçš„ä¸€èˆ¬æ–¹æ³•ã€‚ï¼‰ã€‚è™½ç„¶å®ƒæœ€å¸¸ç”¨äºHTTPï¼Œä½†å…¶ç›®çš„æ˜¯ç‹¬ç«‹äºHTTPï¼Œå¹¶é¿å…ä½¿ç”¨å¤§å¤šæ•°HTTPåŠŸèƒ½ã€‚ç›¸åï¼Œå®ƒå¸¦æœ‰åºå¤§è€Œå¤æ‚çš„å¤šç§ç›¸å…³æ ‡å‡†ï¼ˆWebæœåŠ¡æ¡†æ¶ï¼Œç§°ä¸ºWS-*ï¼‰ï¼Œå®ƒä»¬å¢åŠ äº†å„ç§åŠŸèƒ½ã€‚</p>
<p>SOAP WebæœåŠ¡çš„APIä½¿ç”¨ç§°ä¸ºWebæœåŠ¡æè¿°è¯­è¨€ï¼ˆWSDLï¼‰çš„åŸºäºXMLçš„è¯­è¨€æ¥æè¿°ã€‚ WSDLæ”¯æŒä»£ç ç”Ÿæˆï¼Œå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨æœ¬åœ°ç±»å’Œæ–¹æ³•è°ƒç”¨ï¼ˆç¼–ç ä¸ºXMLæ¶ˆæ¯å¹¶ç”±æ¡†æ¶å†æ¬¡è§£ç ï¼‰è®¿é—®è¿œç¨‹æœåŠ¡ã€‚è¿™åœ¨é™æ€ç±»å‹ç¼–ç¨‹è¯­è¨€ä¸­éå¸¸æœ‰ç”¨ï¼Œä½†åœ¨åŠ¨æ€ç±»å‹ç¼–ç¨‹è¯­è¨€ä¸­å¾ˆå°‘ã€‚</p>
<p>ç”±äºWSDLçš„è®¾è®¡ä¸æ˜¯äººç±»å¯è¯»çš„ï¼Œè€Œä¸”ç”±äºSOAPæ¶ˆæ¯é€šå¸¸æ˜¯æ‰‹åŠ¨æ„å»ºçš„è¿‡äºå¤æ‚ï¼Œæ‰€ä»¥SOAPçš„ç”¨æˆ·åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºå·¥å…·æ”¯æŒï¼Œä»£ç ç”Ÿæˆå’ŒIDEã€‚</p>
<h4 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h4><p>Enterprise JavaBeansï¼ˆEJBï¼‰å’ŒJavaçš„<code>è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ˆRMIï¼‰</code>ä»…é™äºJavaã€‚<code>åˆ†å¸ƒå¼ç»„ä»¶å¯¹è±¡æ¨¡å‹ï¼ˆDCOMï¼‰</code>ä»…é™äºMicrosoftå¹³å°ã€‚<code>å…¬å…±å¯¹è±¡è¯·æ±‚ä»£ç†ä½“ç³»ç»“æ„ï¼ˆCORBAï¼‰</code>è¿‡äºå¤æ‚ï¼Œä¸æä¾›å‰å‘æˆ–åå‘å…¼å®¹æ€§ã€‚<br>æ‰€æœ‰è¿™äº›éƒ½æ˜¯åŸºäº è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰ çš„æ€æƒ³ï¼Œç½‘ç»œè¯·æ±‚ä¸æœ¬åœ°å‡½æ•°è°ƒç”¨éå¸¸ä¸åŒï¼š</p>
<ul>
<li>æœ¬åœ°å‡½æ•°è°ƒç”¨æ˜¯å¯é¢„æµ‹çš„ï¼Œå¹¶ä¸”æˆåŠŸæˆ–å¤±è´¥ï¼Œè¿™ä»…å–å†³äºå—æ‚¨æ§åˆ¶çš„å‚æ•°ã€‚ç½‘ç»œè¯·æ±‚æ˜¯ä¸å¯é¢„çŸ¥çš„ï¼šç”±äºç½‘ç»œé—®é¢˜ï¼Œè¯·æ±‚æˆ–å“åº”å¯èƒ½ä¼šä¸¢å¤±ï¼Œæˆ–è€…è¿œç¨‹è®¡ç®—æœºå¯èƒ½å¾ˆæ…¢æˆ–ä¸å¯ç”¨ï¼Œè¿™äº›é—®é¢˜å®Œå…¨ä¸åœ¨æ‚¨çš„æ§åˆ¶èŒƒå›´ä¹‹å†…ã€‚ç½‘ç»œé—®é¢˜æ˜¯å¸¸è§çš„ï¼Œæ‰€ä»¥ä½ å¿…é¡»é¢„æµ‹ä»–ä»¬ï¼Œä¾‹å¦‚é€šè¿‡é‡è¯•å¤±è´¥çš„è¯·æ±‚ã€‚</li>
<li>æœ¬åœ°å‡½æ•°è°ƒç”¨è¦ä¹ˆè¿”å›ç»“æœï¼Œè¦ä¹ˆæŠ›å‡ºå¼‚å¸¸ï¼Œæˆ–è€…æ°¸è¿œä¸è¿”å›ï¼ˆå› ä¸ºè¿›å…¥æ— é™å¾ªç¯æˆ–è¿›ç¨‹å´©æºƒï¼‰ã€‚ç½‘ç»œè¯·æ±‚æœ‰å¦ä¸€ä¸ªå¯èƒ½çš„ç»“æœï¼šç”±äºè¶…æ—¶ï¼Œå®ƒå¯èƒ½ä¼šè¿”å›æ²¡æœ‰ç»“æœã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ æ ¹æœ¬ä¸çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆï¼šå¦‚æœä½ æ²¡æœ‰å¾—åˆ°æ¥è‡ªè¿œç¨‹æœåŠ¡çš„å“åº”ï¼Œä½ æ— æ³•çŸ¥é“è¯·æ±‚æ˜¯å¦é€šè¿‡ã€‚ ï¼ˆæˆ‘ä»¬å°†åœ¨ç¬¬8ç« æ›´è¯¦ç»†åœ°è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚ï¼‰</li>
<li>å¦‚æœæ‚¨é‡è¯•å¤±è´¥çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯èƒ½ä¼šå‘ç”Ÿè¯·æ±‚å®é™…ä¸Šæ­£åœ¨é€šè¿‡ï¼Œåªæœ‰å“åº”ä¸¢å¤±ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé‡è¯•å°†å¯¼è‡´è¯¥æ“ä½œè¢«æ‰§è¡Œå¤šæ¬¡ï¼Œé™¤éæ‚¨åœ¨åè®®ä¸­å¼•å…¥é™¤é‡ï¼ˆ å¹‚ç­‰ï¼ˆidempotenceï¼‰ï¼‰æœºåˆ¶ã€‚æœ¬åœ°å‡½æ•°è°ƒç”¨æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚ ï¼ˆåœ¨ç¬¬åä¸€ç« æ›´è¯¦ç»†åœ°è®¨è®ºå¹‚ç­‰æ€§ï¼‰</li>
<li>æ¯æ¬¡è°ƒç”¨æœ¬åœ°åŠŸèƒ½æ—¶ï¼Œé€šå¸¸éœ€è¦å¤§è‡´ç›¸åŒçš„æ—¶é—´æ¥æ‰§è¡Œã€‚ç½‘ç»œè¯·æ±‚æ¯”å‡½æ•°è°ƒç”¨è¦æ…¢å¾—å¤šï¼Œè€Œä¸”å…¶å»¶è¿Ÿä¹Ÿæ˜¯éå¸¸å¯å˜çš„ï¼šåœ¨ä¸åˆ°ä¸€æ¯«ç§’çš„æ—¶é—´å†…å®ƒå¯èƒ½ä¼šå®Œæˆï¼Œä½†æ˜¯å½“ç½‘ç»œæ‹¥å¡æˆ–è€…è¿œç¨‹æœåŠ¡è¶…è½½æ—¶ï¼Œå¯èƒ½éœ€è¦å‡ ç§’é’Ÿçš„æ—¶é—´å®Œå…¨ä¸€æ ·çš„ä¸œè¥¿ã€‚</li>
<li>è°ƒç”¨æœ¬åœ°å‡½æ•°æ—¶ï¼Œå¯ä»¥é«˜æ•ˆåœ°å°†å¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰ä¼ é€’ç»™æœ¬åœ°å†…å­˜ä¸­çš„å¯¹è±¡ã€‚å½“ä½ å‘å‡ºä¸€ä¸ªç½‘ç»œè¯·æ±‚æ—¶ï¼Œæ‰€æœ‰è¿™äº›å‚æ•°éƒ½éœ€è¦è¢«ç¼–ç æˆå¯ä»¥é€šè¿‡ç½‘ç»œå‘é€çš„ä¸€ç³»åˆ—å­—èŠ‚ã€‚æ²¡å…³ç³»ï¼Œå¦‚æœå‚æ•°æ˜¯åƒæ•°å­—æˆ–å­—ç¬¦ä¸²è¿™æ ·çš„åŸºæœ¬ç±»å‹ï¼Œä½†æ˜¯å¯¹äºè¾ƒå¤§çš„å¯¹è±¡å¾ˆå¿«å°±ä¼šå˜æˆé—®é¢˜ã€‚</li>
</ul>
<h4 id="RPCçš„å½“å‰æ–¹å‘"><a href="#RPCçš„å½“å‰æ–¹å‘" class="headerlink" title="RPCçš„å½“å‰æ–¹å‘"></a>RPCçš„å½“å‰æ–¹å‘</h4><p>ä½¿ç”¨äºŒè¿›åˆ¶ç¼–ç æ ¼å¼çš„è‡ªå®šä¹‰RPCåè®®å¯ä»¥å®ç°æ¯”é€šç”¨çš„JSON over RESTæ›´å¥½çš„æ€§èƒ½ã€‚ä½†æ˜¯ï¼ŒRESTful APIè¿˜æœ‰å…¶ä»–ä¸€äº›æ˜¾è‘—çš„ä¼˜ç‚¹ï¼šå¯¹äºå®éªŒå’Œè°ƒè¯•ï¼ˆåªéœ€ä½¿ç”¨Webæµè§ˆå™¨æˆ–å‘½ä»¤è¡Œå·¥å…·curlï¼Œæ— éœ€ä»»ä½•ä»£ç ç”Ÿæˆæˆ–è½¯ä»¶å®‰è£…å³å¯å‘å…¶è¯·æ±‚ï¼‰ï¼Œå®ƒæ˜¯å—æ”¯æŒçš„æ‰€æœ‰çš„ä¸»æµç¼–ç¨‹è¯­è¨€å’Œå¹³å°ï¼Œè¿˜æœ‰å¤§é‡å¯ç”¨çš„å·¥å…·ï¼ˆæœåŠ¡å™¨ï¼Œç¼“å­˜ï¼Œè´Ÿè½½å¹³è¡¡å™¨ï¼Œä»£ç†ï¼Œé˜²ç«å¢™ï¼Œç›‘æ§ï¼Œè°ƒè¯•å·¥å…·ï¼Œæµ‹è¯•å·¥å…·ç­‰ï¼‰çš„ç”Ÿæ€ç³»ç»Ÿã€‚ç”±äºè¿™äº›åŸå› ï¼ŒRESTä¼¼ä¹æ˜¯å…¬å…±APIçš„ä¸»è¦é£æ ¼ã€‚ RPCæ¡†æ¶çš„ä¸»è¦é‡ç‚¹åœ¨äºåŒä¸€ç»„ç»‡æ‹¥æœ‰çš„æœåŠ¡ä¹‹é—´çš„è¯·æ±‚ï¼Œé€šå¸¸åœ¨åŒä¸€æ•°æ®ä¸­å¿ƒå†…ã€‚</p>
<h3 id="æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ"><a href="#æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ" class="headerlink" title="æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ"></a>æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ</h3><p>ç®€è¦ä»‹ç»ä¸€ä¸‹RPCå’Œæ•°æ®åº“ä¹‹é—´çš„å¼‚æ­¥æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿã€‚å®ƒä»¬ä¸RPCç±»ä¼¼ï¼Œå› ä¸ºå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼ˆé€šå¸¸ç§°ä¸ºæ¶ˆæ¯ï¼‰ä»¥ä½å»¶è¿Ÿä¼ é€åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ã€‚å®ƒä»¬ä¸æ•°æ®åº“ç±»ä¼¼ï¼Œä¸æ˜¯é€šè¿‡ç›´æ¥çš„ç½‘ç»œè¿æ¥å‘é€æ¶ˆæ¯ï¼Œè€Œæ˜¯é€šè¿‡ç§°ä¸ºæ¶ˆæ¯ä»£ç†ï¼ˆä¹Ÿç§°ä¸ºæ¶ˆæ¯é˜Ÿåˆ—æˆ–é¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶ï¼‰çš„ä¸­ä»‹æ¥ä¸´æ—¶å­˜å‚¨æ¶ˆæ¯ã€‚</p>
<p>ä¸ç›´æ¥RPCç›¸æ¯”ï¼Œä½¿ç”¨æ¶ˆæ¯ä»£ç†æœ‰å‡ ä¸ªä¼˜ç‚¹ï¼š</p>
<ul>
<li>å¦‚æœæ”¶ä»¶äººä¸å¯ç”¨æˆ–è¿‡è½½ï¼Œå¯ä»¥å……å½“ç¼“å†²åŒºï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯é æ€§ã€‚</li>
<li>å®ƒå¯ä»¥è‡ªåŠ¨å°†æ¶ˆæ¯é‡æ–°å‘é€åˆ°å·²ç»å´©æºƒçš„è¿›ç¨‹ï¼Œä»è€Œé˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ã€‚</li>
<li>é¿å…å‘ä»¶äººéœ€è¦çŸ¥é“æ”¶ä»¶äººçš„IPåœ°å€å’Œç«¯å£å·ï¼ˆè¿™åœ¨è™šæ‹Ÿæœºç»å¸¸å‡ºå…¥çš„äº‘éƒ¨ç½²ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼‰ã€‚</li>
<li>å®ƒå…è®¸å°†ä¸€æ¡æ¶ˆæ¯å‘é€ç»™å¤šä¸ªæ”¶ä»¶äººã€‚</li>
<li>å°†å‘ä»¶äººä¸æ”¶ä»¶äººé€»è¾‘åˆ†ç¦»ï¼ˆå‘ä»¶äººåªæ˜¯å‘å¸ƒé‚®ä»¶ï¼Œä¸å…³å¿ƒä½¿ç”¨è€…ï¼‰ã€‚<br>ç„¶è€Œï¼Œä¸RPCç›¸æ¯”ï¼Œå·®å¼‚åœ¨äºæ¶ˆæ¯ä¼ é€’é€šä¿¡é€šå¸¸æ˜¯å•å‘çš„ï¼šå‘é€è€…é€šå¸¸ä¸æœŸæœ›æ”¶åˆ°å…¶æ¶ˆæ¯çš„å›å¤ã€‚ä¸€ä¸ªè¿›ç¨‹å¯èƒ½å‘é€ä¸€ä¸ªå“åº”ï¼Œä½†è¿™é€šå¸¸æ˜¯åœ¨ä¸€ä¸ªå•ç‹¬çš„é€šé“ä¸Šå®Œæˆçš„ã€‚è¿™ç§é€šä¿¡æ¨¡å¼æ˜¯å¼‚æ­¥çš„ï¼šå‘é€è€…ä¸ä¼šç­‰å¾…æ¶ˆæ¯è¢«ä¼ é€’ï¼Œè€Œåªæ˜¯å‘é€å®ƒï¼Œç„¶åå¿˜è®°å®ƒã€‚</li>
</ul>
<h4 id="æ¶ˆæ¯æ®å®¢"><a href="#æ¶ˆæ¯æ®å®¢" class="headerlink" title="æ¶ˆæ¯æ®å®¢"></a>æ¶ˆæ¯æ®å®¢</h4><p>RabbitMQï¼ŒActiveMQï¼ŒHornetQï¼ŒNATSå’ŒApache Kafkaã€‚</p>
<p>æ¶ˆæ¯ä»£ç†çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼šä¸€ä¸ªè¿›ç¨‹å°†æ¶ˆæ¯å‘é€åˆ°æŒ‡å®šçš„é˜Ÿåˆ—æˆ–ä¸»é¢˜ï¼Œä»£ç†ç¡®ä¿å°†æ¶ˆæ¯ä¼ é€’ç»™ä¸€ä¸ªæˆ–å¤šä¸ªæ¶ˆè´¹è€…æˆ–è®¢é˜…è€…åˆ°é‚£ä¸ªé˜Ÿåˆ—æˆ–ä¸»é¢˜ã€‚åœ¨åŒä¸€ä¸»é¢˜ä¸Šå¯ä»¥æœ‰è®¸å¤šç”Ÿäº§è€…å’Œè®¸å¤šæ¶ˆè´¹è€…ã€‚</p>
<p>ä¸€ä¸ªä¸»é¢˜åªæä¾›å•å‘æ•°æ®æµã€‚ä½†æ˜¯ï¼Œæ¶ˆè´¹è€…æœ¬èº«å¯èƒ½ä¼šå°†æ¶ˆæ¯å‘å¸ƒåˆ°å¦ä¸€ä¸ªä¸»é¢˜ä¸Šï¼Œæˆ–è€…å‘é€ç»™åŸå§‹æ¶ˆæ¯çš„å‘é€è€…ä½¿ç”¨çš„å›å¤é˜Ÿåˆ—ï¼ˆå…è®¸è¯·æ±‚/å“åº”æ•°æ®æµï¼Œç±»ä¼¼äºRPCï¼‰ã€‚</p>
<p>æ¶ˆæ¯ä»£ç†é€šå¸¸ä¸ä¼šæ‰§è¡Œä»»ä½•ç‰¹å®šçš„æ•°æ®æ¨¡å‹ - æ¶ˆæ¯åªæ˜¯åŒ…å«ä¸€äº›å…ƒæ•°æ®çš„å­—èŠ‚åºåˆ—ï¼Œå› æ­¤æ‚¨å¯ä»¥ä½¿ç”¨ä»»ä½•ç¼–ç æ ¼å¼ã€‚å¦‚æœç¼–ç æ˜¯å‘åå…¼å®¹çš„ï¼Œåˆ™æ‚¨å¯ä»¥çµæ´»åœ°æ›´æ”¹å‘è¡Œå•†å’Œæ¶ˆè´¹è€…çš„ç‹¬ç«‹ç¼–ç ï¼Œå¹¶ä»¥ä»»æ„é¡ºåºè¿›è¡Œéƒ¨ç½²ã€‚</p>
<h4 id="åˆ†å¸ƒå¼Actoræ¡†æ¶"><a href="#åˆ†å¸ƒå¼Actoræ¡†æ¶" class="headerlink" title="åˆ†å¸ƒå¼Actoræ¡†æ¶"></a>åˆ†å¸ƒå¼Actoræ¡†æ¶</h4><p>Actoræ¨¡å‹æ˜¯å•ä¸ªè¿›ç¨‹ä¸­å¹¶å‘çš„ç¼–ç¨‹æ¨¡å‹ã€‚é€»è¾‘è¢«å°è£…åœ¨è§’è‰²ä¸­ï¼Œè€Œä¸æ˜¯ç›´æ¥å¤„ç†çº¿ç¨‹ï¼ˆä»¥åŠç«äº‰æ¡ä»¶ï¼Œé”å®šå’Œæ­»é”çš„ç›¸å…³é—®é¢˜ï¼‰ã€‚æ¯ä¸ªè§’è‰²é€šå¸¸ä»£è¡¨ä¸€ä¸ªå®¢æˆ·æˆ–å®ä½“ï¼Œå®ƒå¯èƒ½æœ‰ä¸€äº›æœ¬åœ°çŠ¶æ€ï¼ˆä¸ä¸å…¶ä»–ä»»ä½•è§’è‰²å…±äº«ï¼‰ï¼Œå®ƒé€šè¿‡å‘é€å’Œæ¥æ”¶å¼‚æ­¥æ¶ˆæ¯ä¸å…¶ä»–è§’è‰²é€šä¿¡ã€‚æ¶ˆæ¯ä¼ é€ä¸ä¿è¯ï¼šåœ¨æŸäº›é”™è¯¯æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯å°†ä¸¢å¤±ã€‚ç”±äºæ¯ä¸ªè§’è‰²ä¸€æ¬¡åªèƒ½å¤„ç†ä¸€æ¡æ¶ˆæ¯ï¼Œå› æ­¤ä¸éœ€è¦æ‹…å¿ƒçº¿ç¨‹ï¼Œæ¯ä¸ªè§’è‰²å¯ä»¥ç”±æ¡†æ¶ç‹¬ç«‹è°ƒåº¦ã€‚</p>
<p>åœ¨åˆ†å¸ƒå¼çš„è¡Œä¸ºè€…æ¡†æ¶ä¸­ï¼Œè¿™ä¸ªç¼–ç¨‹æ¨¡å‹è¢«ç”¨æ¥è·¨è¶Šå¤šä¸ªèŠ‚ç‚¹æ¥æ‰©å±•åº”ç”¨ç¨‹åºã€‚ä¸ç®¡å‘é€æ–¹å’Œæ¥æ”¶æ–¹æ˜¯åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šè¿˜æ˜¯åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œéƒ½ä½¿ç”¨ç›¸åŒçš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶ã€‚å¦‚æœå®ƒä»¬åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œåˆ™è¯¥æ¶ˆæ¯è¢«é€æ˜åœ°ç¼–ç æˆå­—èŠ‚åºåˆ—ï¼Œé€šè¿‡ç½‘ç»œå‘é€ï¼Œå¹¶åœ¨å¦ä¸€ä¾§è§£ç ã€‚</p>
<p>ä½ç½®é€æ˜åœ¨actoræ¨¡å‹ä¸­æ¯”åœ¨RPCä¸­æ•ˆæœæ›´å¥½ï¼Œå› ä¸ºactoræ¨¡å‹å·²ç»å‡å®šæ¶ˆæ¯å¯èƒ½ä¼šä¸¢å¤±ï¼Œå³ä½¿åœ¨å•ä¸ªè¿›ç¨‹ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å°½ç®¡ç½‘ç»œä¸Šçš„å»¶è¿Ÿå¯èƒ½æ¯”åŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„å»¶è¿Ÿæ›´é«˜ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨å‚ä¸è€…æ¨¡å‹æ—¶ï¼Œæœ¬åœ°å’Œè¿œç¨‹é€šä¿¡ä¹‹é—´çš„åŸºæœ¬ä¸åŒ¹é…æ˜¯è¾ƒå°‘çš„ã€‚</p>
<p>åˆ†å¸ƒå¼çš„Actoræ¡†æ¶å®è´¨ä¸Šæ˜¯å°†æ¶ˆæ¯ä»£ç†å’Œè§’è‰²ç¼–ç¨‹æ¨¡å‹é›†æˆåˆ°ä¸€ä¸ªæ¡†æ¶ä¸­ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¦æ‰§è¡ŒåŸºäºè§’è‰²çš„åº”ç”¨ç¨‹åºçš„æ»šåŠ¨å‡çº§ï¼Œåˆ™ä»ç„¶éœ€è¦æ‹…å¿ƒå‘å‰å’Œå‘åå…¼å®¹æ€§é—®é¢˜ï¼Œå› ä¸ºæ¶ˆæ¯å¯èƒ½ä¼šä»è¿è¡Œæ–°ç‰ˆæœ¬çš„èŠ‚ç‚¹å‘é€åˆ°è¿è¡Œæ—§ç‰ˆæœ¬çš„èŠ‚ç‚¹ï¼Œåä¹‹äº¦ç„¶ã€‚</p>
]]></content>
      <categories>
        <category>DDIA</category>
      </categories>
  </entry>
  <entry>
    <title>è®¾è®¡åŸåˆ™</title>
    <url>/design-principles/</url>
    <content><![CDATA[<h2 id="è®¾è®¡æ¨¡å¼ï¼šè®¾è®¡åŸåˆ™"><a href="#è®¾è®¡æ¨¡å¼ï¼šè®¾è®¡åŸåˆ™" class="headerlink" title="è®¾è®¡æ¨¡å¼ï¼šè®¾è®¡åŸåˆ™"></a>è®¾è®¡æ¨¡å¼ï¼šè®¾è®¡åŸåˆ™</h2><ol>
<li><p>æ‰¾å‡ºåº”ç”¨ä¸­å¯èƒ½éœ€è¦å˜åŒ–æŒ‡å‡ºï¼ŒæŠŠå®ƒä»¬ç‹¬ç«‹å‡ºæ¥ï¼Œä¸è¦å’Œé‚£äº›ä¸éœ€è¦å˜åŒ–çš„ä»£ç æ··åœ¨ä¸€èµ·ã€‚</p>
</li>
<li><p>é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œè€Œä¸æ˜¯é’ˆå¯¹å®ç°ç¼–ç¨‹ã€‚</p>
</li>
<li><p>å¤šç”¨ç»„åˆï¼Œå°‘ç”¨ç»§æ‰¿ã€‚</p>
<blockquote>
<p>é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œå³é’ˆå¯¹è¶…ç±»å‹ç¼–ç¨‹ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨å¤šæ€ã€‚</p>
</blockquote>
</li>
<li><p>ä¸ºäº†äº¤äº’å¯¹è±¡ä¹‹é—´çš„æ¾è€¦åˆè®¾è®¡è€ŒåŠªåŠ›ã€‚</p>
</li>
<li><p>å¼€æ”¾-å…³é—­åŸåˆ™ï¼šç±»åº”è¯¥å¯¹æ‹“å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚</p>
</li>
<li><p>ä¾èµ–å€’ç½®åŸåˆ™ï¼šè¦ä¾èµ–æŠ½è±¡ï¼Œä¸è¦ä¾èµ–å…·ä½“ç±»ã€‚</p>
<blockquote>
<p>å˜é‡ä¸å¯ä»¥æŒæœ‰å…·ä½“ç±»çš„å¼•ç”¨ã€‚<br>ä¸è¦è®©ç±»æ´¾ç”Ÿè‡ªå…·ä½“ç±»ã€‚<br>ä¸è¦è¦†ç›–åŸºç±»ä¸­å·²å®ç°çš„æ–¹æ³•ã€‚</p>
</blockquote>
</li>
</ol>
]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title>2020å¹´è€ƒç ”æ„Ÿæƒ³&amp;ä¸€äº›å…¶ä»–çš„</title>
    <url>/graduation/</url>
    <content><![CDATA[<h2 id="æ€»è¿°"><a href="#æ€»è¿°" class="headerlink" title="æ€»è¿°"></a>æ€»è¿°</h2><p>å¥½ä¹…æ²¡æ›´æ–°äº†ï¼Œå‰é˜µå­å¿™ç€è€ƒç ”å¤è¯•ï¼Œå­¦æ ¡å¼€æ”¾ä¹‹åï¼Œä¾¿ä»å…¬å¸è¯·å‡ï¼Œå›åˆ°å­¦æ ¡å°é—­å¼ç®¡ç†äº†ã€‚</p>
<p>å¤è¯•åœ¨5æœˆ16æ—¥ï¼Œå½•å–åå•5æœˆ17æ—¥å°±å‡ºäº†ï¼Œä¸å¾—ä¸è¯´æˆ‘æµ™è¿™ä¸ªæ•ˆç‡çœŸçš„é«˜ã€‚</p>
<p>æœ¬äººä¸€æˆ˜ï¼ŒåŒéä¸€æœ¬æœ¬ä¸“ä¸šï¼ŒæŠ¥è€ƒçš„æ˜¯<code>æµ™æ±Ÿå¤§å­¦è½¯ä»¶å­¦é™¢</code>ï¼Œè¿æ°”è¾ƒå¥½ï¼Œå› ä¸ºç–«æƒ…æ‰©æ‹›ï¼Œæœ€ç»ˆå½•å–åˆ°è½¯ä»¶å·¥ç¨‹å…¨æ—¥åˆ¶ã€‚åˆ†æ•°360+ï¼ŒæŒ‰æœªæ‰©æ‹›æ—¶ç®—çš„åœ¨å¤è¯•è¾¹ç¼˜ã€‚</p>
<p>è¿™å‡ å¤©å¿™ç€æ¯•è®¾å’Œæ‰¾å¯¼å¸ˆï¼Œæ›´æ–°çš„è¾ƒè¿Ÿï¼Œè¿™æ˜¯ä¸€ä¸ªé˜¶æ®µæ€§æ€»ç»“ï¼Œç­‰ä¹‹åç”Ÿæ´»å¹³ç¨³äº†æ‰ä¼šç¨³å®šæ›´æ–°ã€‚</p>
<a id="more"></a>
<h2 id="å­¦æ ¡ç®€ä»‹"><a href="#å­¦æ ¡ç®€ä»‹" class="headerlink" title="å­¦æ ¡ç®€ä»‹"></a>å­¦æ ¡ç®€ä»‹</h2><p>æµ™å¤§è®¡ç®—æœºè¿˜æ˜¯å¾ˆå¼ºçš„ï¼Œå…¨å›½ç¬¬ä¸‰ã€‚æµ™å¤§è®¡ç®—æœºä¸»è¦åœ¨ï¼šCAD/CGã€åŒºå—é“¾ã€æœºå™¨å­¦ä¹ æ–¹é¢è¾ƒä¸ºçªå‡ºã€‚æŠ¥è€ƒæµ™å¤§çš„è®¡ç®—æœº/ç”µå­ä¿¡æ¯ä¸»è¦æœ‰ä¸‰ä¸ªåˆ†é™¢ï¼šè®¡ç®—æœºå­¦é™¢(è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯(<code>å­¦ç¡•</code>)ã€è½¯ä»¶å·¥ç¨‹ï¼ˆ<code>å­¦ç¡•</code>ï¼‰ã€ç½‘ç»œç©ºé—´å®‰å…¨(<code>å­¦ç¡•</code>)ã€è®¡ç®—æœºæŠ€æœ¯(<code>ä¸“ç¡•</code>))ã€è½¯ä»¶å­¦é™¢(è½¯ä»¶å·¥ç¨‹(<code>ä¸“ç¡•</code>))ã€å·¥ç¨‹å¸ˆå­¦é™¢(ç‰©è”ç½‘(<code>ä¸“ç¡•</code>))</p>
<p>è¿™ä¸‰ä¸ªå­¦é™¢è€ƒç ”ç§‘ç›®å…¬å…±è¯¾ç›¸åŒï¼Œä¸“ä¸šè¯¾ä¸Šï¼šè®¡é™¢ã€å·¥é™¢éƒ½æ˜¯408ã€è½¯é™¢878(c+æ•°æ®ç»“æ„)</p>
<p>è®¡é™¢å½•å–äººæ•°ï¼š<a href="http://www.cs.zju.edu.cn/csen/2020/0430/c27006a2092231/page.htm" target="_blank" rel="noopener">http://www.cs.zju.edu.cn/csen/2020/0430/c27006a2092231/page.htm</a></p>
<p>è½¯é™¢å½•å–äººæ•°ï¼š<a href="http://www.cst.zju.edu.cn/2020/0502/c32178a2092359/page.htm" target="_blank" rel="noopener">http://www.cst.zju.edu.cn/2020/0502/c32178a2092359/page.htm</a></p>
<p>å·¥é™¢å½•å–äººæ•°ï¼š<a href="http://pi.zju.edu.cn/index.php?c=Index&amp;a=news_detail&amp;id=3308" target="_blank" rel="noopener">http://pi.zju.edu.cn/index.php?c=Index&amp;a=news_detail&amp;id=3308</a></p>
<p>æµ™å¤§æ‹›å¾—äººç®—æ˜¯éå¸¸å¤šäº†ï¼Œç›¸å¯¹æ¥è¯´éš¾åº¦æ¯”æ‹›äººæ•°ä¸ªä½æ•°çš„å­¦æ ¡å¥½å¤šäº†ï¼Œä½†æ˜¯åŒæ ·ä¼šå¸å¼•å¤§é‡å¤§ä½¬æ¥ç«äº‰ã€‚æ‰€ä»¥éš¾åº¦ä¸å¤ªå¥½è¯„ä¼°ã€‚</p>
<p>æµ™å¤§çš„å¤è¯•è¾ƒä¸ºå…¬å¹³ï¼Œä¹Ÿæ˜¯ç›¸å¯¹æ¥è¯´æ²¡é‚£ä¹ˆç¹æ‚çš„ã€‚</p>
<p>æ€»åˆ†æˆç»© = (åˆè¯•/5) x 0.7 + å¤è¯• x 0.3</p>
<p>ç›¸å½“äºï¼š1åˆ†å¤è¯•=2.1åˆ†åˆè¯•ï¼Œæ‰€ä»¥åˆè¯•ä¸é«˜é€†è¢­ä¹Ÿä¸æ˜¯ä¸å¯èƒ½</p>
<p>å…¶ä»–çš„è€ƒç ”ä¿¡æ¯æœ€å¥½è¯·å…³æ³¨åˆ†é™¢å®˜ç½‘ï¼Œä»¥åŠç ”ç©¶ç”Ÿæ‹›ç”Ÿç½‘ã€‚</p>
<h2 id="ä¸ªäººæƒ…å†µ"><a href="#ä¸ªäººæƒ…å†µ" class="headerlink" title="ä¸ªäººæƒ…å†µ"></a>ä¸ªäººæƒ…å†µ</h2><p>æˆ‘æ˜¯ä»7æœˆæ­£å¼å¼€å§‹å¤ä¹ çš„ï¼Œä¹‹å‰æ–­æ–­ç»­ç»­èƒŒäº†ä¸€äº›è‹±è¯­å•è¯å°±ä¸ç®—è¿›å»äº†ã€‚</p>
<p>7æœˆæˆ‘è§‰è€ƒæµ™å¤§å¯èƒ½æœ‰ç‚¹è¿Ÿäº†ï¼Œå› ä¸ºæˆ‘çš„é«˜æ•°åŸºç¡€å’Œè‹±è¯­åº•å­å¯èƒ½ä¸ç®—å¤ªå¥½ï¼Œæ‰€ä»¥åœ¨æ—©æœŸæˆ‘æ•°å­¦ä¸€å¤©6ä¸ªå°æ—¶ï¼Œè‹±è¯­ä¸€å¤©4ä¸ªå°æ—¶ï¼Œå› ä¸ºæˆ‘è€ƒçš„æ˜¯è½¯ä»¶å­¦é™¢ï¼Œä¸“ä¸šè¯¾æœ€åä¸‰ä¸ªæœˆå‡†å¤‡å°±å¯ä»¥äº†ã€‚æ‰€ä»¥æœ€å¥½åœ¨è€ƒç ”å‰è¯„ä¼°è‡ªå·±çš„åŸºç¡€æ€ä¹ˆæ ·ã€‚</p>
<p>å¤ä¹ æ–¹æ³•æˆ‘å°±ä¸è¯´äº†ï¼Œæ¯•ç«Ÿè€ƒå¾—ä¸é«˜..</p>
<p>æœ€éš¾å—çš„å°±æ˜¯æœ€ç”¨å¿ƒå¤ä¹ çš„æ•°å­¦å’Œè‹±è¯­å¹¶æ²¡æœ‰è€ƒèµ·æ¥ï¼Œåè€Œæ²¡æ€å¤ä¹ çš„æ”¿æ²»è€ƒå¾—è¿˜ä¸é”™ã€‚(éš¾å—)</p>
<p>æˆ‘ä¸»è¦ä¾§é‡äºå¯¹äºæ—¶é—´çš„æŠŠæ¡ã€‚</p>
<p>ä»Šå¹´å› ä¸ºç–«æƒ…çš„å…³ç³»ï¼Œå–æ¶ˆäº†ä¸Šæœºè€ƒè¯•ã€‚æŒ‰ç…§å¾€å¹´ï¼Œä¸Šæœºä¹Ÿæ˜¯å¤è¯•çš„å†…å®¹ä¹‹ä¸€ï¼Œå½“ç„¶patå¯ä»¥ä»£æ›¿ä¸Šæœºå¤è¯•ã€‚</p>
<p>æ¢ç®—å…¬å¼ï¼š2åˆ†pat = 1åˆ†åˆè¯•</p>
<p>å¯ä»¥çœ‹åˆ°patè¿˜æ˜¯ç›¸å½“é‡è¦çš„ï¼ŒåŒæ—¶patå’Œä¸Šæœºæˆç»©åªèƒ½2é€‰1ï¼Œå°±æ„å‘³ç€å¦‚æœä½ å‚åŠ äº†ä¸Šæœºè€ƒè¯•ï¼Œpatæˆç»©ä½œåºŸï¼Œæˆç»©åªèƒ½ç®—ä¸Šæœºçš„ï¼ŒåŒæ—¶patå°±åªæœ‰å½“å¹´çš„patæˆç»©æœ‰æ•ˆã€‚æ¯”å¦‚æˆ‘è€ƒ2020çš„ç ”ç©¶ç”Ÿï¼Œåªæœ‰2019å¹´3æœˆã€9æœˆã€12æœˆçš„æœ‰æ•ˆã€‚</p>
<p>è¿™è¾¹æ¨èPATè€ƒè¯•å°½é‡æ—©å¼€å§‹ï¼Œåœ¨3æœˆä»½æ‹¿åˆ°é«˜åˆ†æœ€åï¼Œåé¢æ¯å¤©å¯ä»¥å¤šå‡º2ã€3æ—¶æ¥å¤ä¹ ã€‚</p>
<p>æˆ‘ä¸ƒæœˆå¼€å§‹ï¼Œpatä¹Ÿæ²¡è€ƒï¼Œåé¢èŠ±äº†æ¯”è¾ƒå¤šçš„æ—¶é—´å¤ä¹ patï¼Œè¿™éƒ¨åˆ†å…¶å®å¯ä»¥ææ—©ç»“æŸã€‚</p>
<p>æˆ‘ä¹Ÿå†™äº†ä¸€ä¸ª<a href="/strategy-pat/" title="PATæ”»ç•¥">PATæ”»ç•¥</a>ï¼Œæœ‰å…´è¶£çš„å¯ä»¥çœ‹çœ‹</p>
<p>å…¶ä»–å°±æ²¡ä»€ä¹ˆå¥½è¯´çš„äº†</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è€ƒç ”é€‰æ‹©æ¯”åŠªåŠ›é‡è¦ï¼Œä»Šå¹´è½¯é™¢aiä¸Šçº¿å°±å¯ä»¥å½•å–ï¼Œç›¸æ¯”éš”å£çš„è½¯ä»¶å·¥ç¨‹å‡åˆ†éƒ½åˆ°äº†390.</p>
<p>è€ƒ985ã€211æˆ–è€…å¼ºåŠ¿ä¸“ä¸šè¯·æ—©ç‚¹å¼€å§‹ã€‚</p>
<p>å°½æ—©åœ°è¯„ä¼°è‡ªå·±åœ°æ°´å¹³ï¼Œå¯¹ç—‡ä¸‹è¯ã€‚</p>
<p>æˆ‘åœ°ä¸€ä¸ªåŒå­¦å› ä¸ºæ•°å­¦ä½äº†2åˆ†ï¼Œè¡¥äº†25åˆ†ï¼Œæœ€ç»ˆæ— ç¼˜è½¯é™¢ã€‚è¡¥è¶³çŸ­æ¿ååˆ†é‡è¦ã€‚</p>
<p>æœ€è¿‘å¿™ç€å„ç§å„æ ·çš„è£èª‰ï¼Œæœ‰ç‚¹çƒ¦ã€‚æ„Ÿè§‰æ‹¿åˆ°æµ™å¤§çš„å½•å–é€šçŸ¥ä¹¦åè€Œæ²¡æœ‰ç‰¹åˆ«å¼€å¿ƒï¼Œèº«ä¸Šçš„å‹åŠ›æ›´å¤§äº†ã€‚çœŸæ˜¯ä»¤äººå¤´ç§ƒã€‚</p>
<p>è¿‡æ®µæ—¶é—´ç¦»æ ¡ï¼Œåˆå¾—æ‰¾ä¸ªåœ°æ–¹ç§Ÿï¼Œè·Ÿç€å¯¼å¸ˆåšé¡¹ç›®å»äº†ã€‚</p>
<p>ç¥æ„¿å¤§å®¶ä»¥åå‰ç¨‹ä¼¼é”¦ã€‚</p>
]]></content>
      <categories>
        <category>éšç¬”</category>
      </categories>
  </entry>
  <entry>
    <title>å…«æ–¹æ—…äººå®Œç»“</title>
    <url>/octopath-traveler/</url>
    <content><![CDATA[<p>å…«æ–¹æ—…äººï¼Œä¸€æ–¹äº”å</p>
<p>ç¬¬ä¸€æ¬¡å…¨é€šå…³ä¸€æ¬¾JRPGï¼Œæ–­æ–­ç»­ç»­æ‰“äº†ä¸€ä¸ªæœˆï¼Œå°†è¿‘80å°æ—¶å…¨æ”¶é›†ã€‚</p>
<p>è¿™ä¸ªä¸»çº¿å‰§æƒ…æœ€ç»ˆBosså’Œéšè—Bosséš¾åº¦è·¨åº¦æœ‰ç‚¹å¤§ã€‚</p>
<p>å…¨è§’è‰²ç¬¬å››ç« é€šå…³ä¹‹åï¼ŒèŠ±äº†5ã€6å¤©å‡†å¤‡å‡çº§å’ŒèŒä¸šæ­é…å‡†å¤‡æ‰“æœ€åçš„éšè—Bossï¼ˆPSï¼šä¸æ„§æ˜¯éé…‹ä¹‹èˆï¼Œä¸ç„¶ä¹Ÿä¸ä¼šåˆ·5å¤©çš„çº§ï¼‰</p>
<p>æ‰“å®Œéšè—Bossä¹‹åæ•´ä¸€ä¸ªå…«æ–¹æ—…äººçš„å…«ä¸ªé›¶æ•£çš„ä¸»çº¿å°±å¯ä»¥ç»‡èµ·æ¥äº†ï¼Œæ€»çš„å‰§æƒ…ä¸­è§„ä¸­çŸ©ã€‚</p>
<p>æ¸¸æˆæœºåˆ¶åœ¨è€å¼ä¼ ç»Ÿå›åˆåˆ¶ä¸Šæœ‰åˆ›æ–°ï¼Œç©èµ·æ¥æœ‰åŠŸæœ‰é˜²ï¼Œå¾ˆæœ‰èŠ‚å¥æ„Ÿã€‚åŒæ—¶éŸ³ä¹å‡ºè‰²ï¼Œä¸è¿‡ä»·æ ¼åè´µï¼Œswitchç‰ˆç©å®Œè¿˜å¯ä»¥å›è¡€ã€‚</p>
<p>æ¨èç¨‹åº¦8/10</p>
<a id="more"></a>
<p>æœ€åæ”¶è—äº†ä¸€äº›å›¾ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/octopath-traveler-alfyn.jpg" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/octopath-traveler-cyrus.jpg" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/octopath-traveler-haannit.jpg" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/octopath-traveler-olberic.jpg" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/octopath-traveler-ophilia.jpg" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/octopath-traveler-primrose.jpg" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/octopath-traveler-therion.jpg" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/octopath-traveler-tressa.jpg" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/octopath-traveler-boss.jpg" alt=""></p>
]]></content>
      <categories>
        <category>æ¸¸æˆ</category>
      </categories>
      <tags>
        <tag>å…«æ–¹æ—…äºº</tag>
        <tag>SE</tag>
      </tags>
  </entry>
  <entry>
    <title>PATçœŸé¢˜ç›®å½•</title>
    <url>/pat-advanced-recommend/</url>
    <content><![CDATA[<h2 id="PATç”²çº§çœŸé¢˜ç›®å½•ï¼ˆæŒ‰é¢˜å‹æ•´ç†ï¼‰"><a href="#PATç”²çº§çœŸé¢˜ç›®å½•ï¼ˆæŒ‰é¢˜å‹æ•´ç†ï¼‰" class="headerlink" title="PATç”²çº§çœŸé¢˜ç›®å½•ï¼ˆæŒ‰é¢˜å‹æ•´ç†ï¼‰"></a>PATç”²çº§çœŸé¢˜ç›®å½•ï¼ˆæŒ‰é¢˜å‹æ•´ç†ï¼‰</h2><blockquote>
<p>æ¥è‡ª<a href="https://www.liuchuo.net/archives/2502?tdsourcetag=s_pcqq_aiomsg" target="_blank" rel="noopener">æŸ³å©¼ ã® blog</a></p>
</blockquote>
<h3 id="æœ€çŸ­è·¯å¾„"><a href="#æœ€çŸ­è·¯å¾„" class="headerlink" title="æœ€çŸ­è·¯å¾„"></a>æœ€çŸ­è·¯å¾„</h3><p><a href="http://www.liuchuo.net/archives/2359" target="_blank" rel="noopener">1003. Emergency (25)-PATç”²çº§çœŸé¢˜ï¼ˆDijkstraç®—æ³•ï¼‰</a><br><a href="http://www.liuchuo.net/archives/2373" target="_blank" rel="noopener">1018. Public Bike Management (30)-PATç”²çº§çœŸé¢˜ï¼ˆDijkstra + DFSï¼‰</a><br><a href="http://www.liuchuo.net/archives/2369" target="_blank" rel="noopener">1030. Travel Plan (30)-PATç”²çº§çœŸé¢˜ï¼ˆDijkstra + DFSï¼Œè¾“å‡ºè·¯å¾„ï¼Œè¾¹æƒï¼‰</a><br><a href="http://www.liuchuo.net/archives/2399" target="_blank" rel="noopener">1087. All Roads Lead to Rome (30)-PATç”²çº§çœŸé¢˜-Dijkstra + DFS</a><br><a href="http://www.liuchuo.net/archives/2407" target="_blank" rel="noopener">1111. Online Map (30)-PATç”²çº§çœŸé¢˜ï¼ˆDijkstra + DFSï¼‰æ ‘çš„éå†</a>  </p>
<h3 id="æ ‘çš„éå†"><a href="#æ ‘çš„éå†" class="headerlink" title="æ ‘çš„éå†"></a>æ ‘çš„éå†</h3><p><a href="http://www.liuchuo.net/archives/2229" target="_blank" rel="noopener">1004. Counting Leaves (30)-PATç”²çº§çœŸé¢˜(bfs,dfs,æ ‘çš„éå†ï¼Œå±‚åºéå†)</a><br><a href="http://www.liuchuo.net/archives/2100" target="_blank" rel="noopener">1020. Tree Traversals (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2285" target="_blank" rel="noopener">1053. Path of Equal Weight (30)-PATç”²çº§çœŸé¢˜(æ ‘çš„éå†) </a><br><a href="http://www.liuchuo.net/archives/2212" target="_blank" rel="noopener">1079. Total Sales of Supply Chain (25)-PATç”²çº§çœŸé¢˜ï¼ˆdfs,bfs,æ ‘çš„éå†ï¼‰</a><br><a href="http://www.liuchuo.net/archives/2168" target="_blank" rel="noopener">1086. Tree Traversals Again (25)-PATç”²çº§çœŸé¢˜ </a><br><a href="http://www.liuchuo.net/archives/2465" target="_blank" rel="noopener">1090. Highest Price in Supply Chain (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2223" target="_blank" rel="noopener">1094. The Largest Generation (25)-PATç”²çº§çœŸé¢˜ï¼ˆbfs,dfs,æ ‘çš„éå†ï¼‰</a><br><a href="http://www.liuchuo.net/archives/2166" target="_blank" rel="noopener">1102. Invert a Binary Tree (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2226" target="_blank" rel="noopener">1106. Lowest Price in Supply Chain (25)-PATç”²çº§çœŸé¢˜(dfs,bfs,æ ‘çš„éå†)</a><br><a href="http://www.liuchuo.net/archives/2235" target="_blank" rel="noopener">1115. Counting Nodes in a BST (30)-PATç”²çº§çœŸé¢˜ï¼ˆäºŒå‰æ ‘çš„éå†ï¼Œdfsï¼‰</a><br><a href="http://www.liuchuo.net/archives/2484" target="_blank" rel="noopener">1119. Pre- and Post-order Traversals (30)-PATç”²çº§çœŸé¢˜ï¼ˆå‰åºååºè½¬ä¸­åºï¼‰</a></p>
<h3 id="å›¾çš„éå†"><a href="#å›¾çš„éå†" class="headerlink" title="å›¾çš„éå†"></a>å›¾çš„éå†</h3><p><a href="http://www.liuchuo.net/archives/2346" target="_blank" rel="noopener">1013. Battle Over Cities (25)-PATç”²çº§çœŸé¢˜ï¼ˆå›¾çš„éå†ï¼Œç»Ÿè®¡å¼ºè¿é€šåˆ†é‡çš„ä¸ªæ•°ï¼Œdfsï¼‰</a><br><a href="http://www.liuchuo.net/archives/2348" target="_blank" rel="noopener">1021. Deepest Root (25)-PATç”²çº§çœŸé¢˜ï¼ˆå›¾çš„éå†ï¼Œdfsï¼Œè¿é€šåˆ†é‡çš„ä¸ªæ•°ï¼‰</a><br><a href="http://www.liuchuo.net/archives/2331" target="_blank" rel="noopener">1034. Head of a Gang (30)-PATç”²çº§çœŸé¢˜ï¼ˆå›¾çš„éå†dfsï¼‰</a><br><a href="http://www.liuchuo.net/archives/2376" target="_blank" rel="noopener">1072. Gas Station (30)-PATç”²çº§çœŸé¢˜ï¼ˆDijkstraï¼‰</a><br><a href="http://www.liuchuo.net/archives/2334" target="_blank" rel="noopener">1076. Forwards on Weibo (30)-PATç”²çº§çœŸé¢˜ï¼ˆå›¾çš„éå†bfsï¼‰</a>    </p>
<h3 id="æ·±åº¦ä¼˜å…ˆæœç´¢"><a href="#æ·±åº¦ä¼˜å…ˆæœç´¢" class="headerlink" title="æ·±åº¦ä¼˜å…ˆæœç´¢"></a>æ·±åº¦ä¼˜å…ˆæœç´¢</h3><p><a href="http://www.liuchuo.net/archives/2451" target="_blank" rel="noopener">1103. Integer Factorization (30)-PATç”²çº§çœŸé¢˜ï¼ˆdfsæ·±åº¦ä¼˜å…ˆï¼‰</a>  </p>
<h3 id="å¹¿åº¦ä¼˜å…ˆæœç´¢"><a href="#å¹¿åº¦ä¼˜å…ˆæœç´¢" class="headerlink" title="å¹¿åº¦ä¼˜å…ˆæœç´¢"></a>å¹¿åº¦ä¼˜å…ˆæœç´¢</h3><p><a href="http://www.liuchuo.net/archives/2307" target="_blank" rel="noopener">1091. Acute Stroke (30)-PATç”²çº§çœŸé¢˜ï¼ˆå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰</a>  </p>
<h3 id="å“ˆå¸Œã€æ•£åˆ—"><a href="#å“ˆå¸Œã€æ•£åˆ—" class="headerlink" title="å“ˆå¸Œã€æ•£åˆ—"></a>å“ˆå¸Œã€æ•£åˆ—</h3><p><a href="http://www.liuchuo.net/archives/2142" target="_blank" rel="noopener">1048. Find Coins (25)-PATç”²çº§çœŸé¢˜(Hashæ•£åˆ—)</a><br><a href="http://www.liuchuo.net/archives/2130" target="_blank" rel="noopener">1050. String Subtraction (20)-PATç”²çº§çœŸé¢˜ï¼ˆå“ˆå¸Œï¼‰</a><br><a href="http://www.liuchuo.net/archives/1898" target="_blank" rel="noopener">1092. To Buy or Not to Buy (20)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/452" target="_blank" rel="noopener">1084. Broken Keyboard (20)-PATç”²çº§è¯•é¢˜</a>  </p>
<h3 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h3><p><a href="http://www.liuchuo.net/archives/2207" target="_blank" rel="noopener">1012. The Best Rank (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2350" target="_blank" rel="noopener">1016. Phone Bills (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2180" target="_blank" rel="noopener">1025. PAT Ranking (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2120" target="_blank" rel="noopener">1028. List Sorting (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2255" target="_blank" rel="noopener">1055. The Worldâ€™s Richest (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2068" target="_blank" rel="noopener">1062. Talent and Virtue (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2260" target="_blank" rel="noopener">1075. PAT Judge (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2453" target="_blank" rel="noopener">1080. Graduate Admission (30)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2128" target="_blank" rel="noopener">1083. List Grades (25)-PATç”²çº§çœŸé¢˜</a>  </p>
<h3 id="STLçš„ä½¿ç”¨"><a href="#STLçš„ä½¿ç”¨" class="headerlink" title="STLçš„ä½¿ç”¨"></a>STLçš„ä½¿ç”¨</h3><p><a href="http://www.liuchuo.net/archives/2295" target="_blank" rel="noopener">1022. Digital Library (30)-PATç”²çº§çœŸé¢˜ï¼ˆmapæ˜ å°„ï¼‰</a><br><a href="http://www.liuchuo.net/archives/2145" target="_blank" rel="noopener">1039. Course List for Student (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2147" target="_blank" rel="noopener">1047. Student List for Course (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2048" target="_blank" rel="noopener">1054. The Dominant Color (20)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2106" target="_blank" rel="noopener">1063. Set Similarity (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2257" target="_blank" rel="noopener">1071. Speech Patterns (25)-PATç”²çº§çœŸé¢˜ï¼ˆmapåº”ç”¨ï¼‰</a><br><a href="http://www.liuchuo.net/archives/1892" target="_blank" rel="noopener">1100. Mars Numbers (20)-PATç”²çº§çœŸé¢˜</a>  </p>
<h3 id="é“¾è¡¨å¤„ç†"><a href="#é“¾è¡¨å¤„ç†" class="headerlink" title="é“¾è¡¨å¤„ç†"></a>é“¾è¡¨å¤„ç†</h3><p><a href="http://www.liuchuo.net/archives/2113" target="_blank" rel="noopener">1032. Sharing (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2116" target="_blank" rel="noopener">1052. Linked List Sorting (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/1910" target="_blank" rel="noopener">1074. Reversing Linked List (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2118" target="_blank" rel="noopener">1097. Deduplication on a Linked List (25)-PATç”²çº§çœŸé¢˜</a></p>
<h3 id="äºŒå‰æœç´¢æ ‘"><a href="#äºŒå‰æœç´¢æ ‘" class="headerlink" title="äºŒå‰æœç´¢æ ‘"></a>äºŒå‰æœç´¢æ ‘</h3><p><a href="http://www.liuchuo.net/archives/2153" target="_blank" rel="noopener">1043. Is It a Binary Search Tree (25)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2161" target="_blank" rel="noopener">Complete Binary Search Tree (30)-PATç”²çº§çœŸé¢˜</a><br><a href="http://www.liuchuo.net/archives/2173" target="_blank" rel="noopener">1099. Build A Binary Search Tree (30)-PATç”²çº§çœŸé¢˜</a>  </p>
<h3 id="å¹³è¡¡äºŒå‰æ ‘"><a href="#å¹³è¡¡äºŒå‰æ ‘" class="headerlink" title="å¹³è¡¡äºŒå‰æ ‘"></a>å¹³è¡¡äºŒå‰æ ‘</h3><p><a href="http://www.liuchuo.net/archives/2178" target="_blank" rel="noopener">1066. Root of AVL Tree (25)-PATç”²çº§çœŸé¢˜</a></p>
<h3 id="å †æ’åº"><a href="#å †æ’åº" class="headerlink" title="å †æ’åº"></a>å †æ’åº</h3><p><a href="http://www.liuchuo.net/archives/2273" target="_blank" rel="noopener">1098. Insertion or Heap Sort (25)-PATç”²çº§çœŸé¢˜ï¼ˆå †æ’åºï¼‰</a></p>
<h3 id="å¹¶æŸ¥é›†"><a href="#å¹¶æŸ¥é›†" class="headerlink" title="å¹¶æŸ¥é›†"></a>å¹¶æŸ¥é›†</h3><p><a href="http://www.liuchuo.net/archives/2183" target="_blank" rel="noopener">1107. Social Clusters (30)-PATç”²çº§çœŸé¢˜ï¼ˆå¹¶æŸ¥é›†ï¼‰</a><br><a href="http://www.liuchuo.net/archives/2201" target="_blank" rel="noopener">1114. Family Property (25)-PATç”²çº§çœŸé¢˜ï¼ˆå¹¶æŸ¥é›†ï¼‰</a><br><a href="http://www.liuchuo.net/archives/2482" target="_blank" rel="noopener">1118. Birds in Forest (25)-PATç”²çº§çœŸé¢˜ï¼ˆå¹¶æŸ¥é›†ï¼‰</a></p>
<h3 id="æ ‘çŠ¶æ•°ç»„"><a href="#æ ‘çŠ¶æ•°ç»„" class="headerlink" title="æ ‘çŠ¶æ•°ç»„"></a>æ ‘çŠ¶æ•°ç»„</h3><p><a href="http://www.liuchuo.net/archives/2265" target="_blank" rel="noopener">1057. Stack (30)-PATç”²çº§çœŸé¢˜ï¼ˆæ ‘çŠ¶æ•°ç»„ï¼‰</a></p>
]]></content>
  </entry>
  <entry>
    <title>PATæ”»ç•¥</title>
    <url>/strategy-pat/</url>
    <content><![CDATA[<p>å…¶å®æˆ‘patå‡†å¤‡å¾—å¾ˆè¿Ÿï¼Œä¸ƒæœˆä¸­æ—¬æ‰å¼€å§‹å‡†å¤‡PATã€‚</p>
<p>å°±åˆ·äº†ç”²çº§100æ¥é“é¢˜ï¼Œå°±å»è€ƒåœºäº†ï¼Œå…¶ä»–éƒ½acäº†ã€‚å¯èƒ½å¤ªè¿‡äºç´§å¼ ï¼Œç¬¬ä¸€é¢˜å°±ç•™äº†åŠå°æ—¶ï¼Œæ²¡åšå‡ºæ¥ï¼Œæ‹¿äº†80 â€¦â€¦ </p>
<p>ç¬¬äºŒæ¬¡æŠŠä¹™çº§é¢˜éƒ½åˆ·äº†ä¸€éï¼Œç”²çº§ä¸­çš„20åˆ†é¢˜ä»¥åŠå¯¹ç…§åˆ·é¢˜ç›®å½•æŠŠç”²çº§ä¸­çš„ç»å…¸é¢˜å‹ä¹Ÿéƒ½é‡æ–°åˆ·ä¸€éã€‚</p>
<p>å…¶å®patä¸éœ€è¦å…¨åˆ·ï¼Œæœ‰äº›é¢˜æ˜¯çœŸçš„æ¶å¿ƒï¼Œæ—©æœŸå„ç§å„æ ·æ¶å¿ƒçš„æ¨¡æ‹Ÿé¢˜ï¼Œæ¯”å¦‚è‡­åæ˜­è‘—çš„<code>Table tennis</code>ã€‚</p>
<p>æˆ‘å°±åˆ·äº†120å¤šé¢˜ã€‚<br><a id="more"></a><br>æˆ‘æ„Ÿè§‰æˆ‘è¿™ä¸ªè·¯çº¿åº”è¯¥å¯ä»¥2ä¸ªæœˆé€ŸæˆPATç”²çº§ã€‚æˆ‘çš„è·¯çº¿ï¼šPATä¹™çº§å…¨åˆ·-&gt;<a href="/pat-advanced-recommend/" title="çœŸé¢˜ç›®å½•">çœŸé¢˜ç›®å½•</a>-&gt;ç”²çº§1101é¢˜å¾€åæ‰€æœ‰é¢˜-&gt;è¿˜æœ‰æœ‰æ—¶é—´çš„è¯æŠŠç”²çº§20åˆ†é¢˜éƒ½åšä¸€ä¸‹(ç¬¬ä¸€é¢˜æœ‰æ—¶å€™æŒºéš¾çš„)</p>
<p>IDEï¼š DEV C++(ä¸€èˆ¬è¿™ä¸ªéƒ½æœ‰ï¼Œåˆ·é¢˜æœ€å¥½ç”¨c++)</p>
<p>ä¹¦ç±ï¼šã€Šç®—æ³•ç¬”è®°ã€‹ä¿—ç§°æ™´ç¥å®å…¸</p>
<p>ä»£ç å‚è€ƒï¼š<a href="https://www.liuchuo.net/" target="_blank" rel="noopener">æŸ³ç¥åšå®¢</a></p>
<p>PATä¹™çº§ï¼Œæ˜¯å¸®åŠ©ä½ ç†Ÿæ‚‰C++/Cï¼ŒæŒæ¡å­—ç¬¦ä¸²çš„å¤„ç†çš„å¼€å§‹</p>
<p><a href="/pat-advanced-recommend/" title="çœŸé¢˜ç›®å½•">çœŸé¢˜ç›®å½•</a>ï¼šé¢˜å‹åˆ†ç±»ï¼Œé‡Œé¢çš„é¢˜éƒ½æ˜¯éå¸¸ç»å…¸çš„ï¼Œå€¼å¾—å¤šåšå‡ æ¬¡ã€‚å¯ä»¥ä»æ˜“åˆ°éš¾ï¼ŒäºŒç‚¹è®ºç»“åˆï¼šSTL(ç†Ÿæ‚‰stl)-&gt;é“¾è¡¨-&gt;æ’åº-&gt;æ ‘-&gt;å›¾-&gt;å¹¿åº¦ã€æ·±åº¦-&gt;æœ€çŸ­è·¯å¾„-&gt;æœç´¢æ ‘ã€å¹³è¡¡æ ‘-&gt;å †-&gt;å¹¶æŸ¥é›†ã€‚å…¶ä»–å°±ä¸ç”¨æ€ä¹ˆç”¨çœ‹äº†ï¼ŒåŸºæœ¬ä¸è€ƒã€‚</p>
<p>å·®ä¸å¤šè¿™æ ·å°±è¡Œäº†å§ï¼Œä¸€å¤©ä¸‰ä¸ªå°æ—¶ï¼Œä¸¤ä¸ªæœˆ90åˆ†æ²¡æœ‰é—®é¢˜ï¼Œ100åˆ†è¿˜æ˜¯éœ€è¦ç‚¹å®åŠ›å’Œè¿æ°”çš„ã€‚</p>
]]></content>
      <categories>
        <category>DS</category>
      </categories>
      <tags>
        <tag>PAT</tag>
      </tags>
  </entry>
  <entry>
    <title>Talent plan Tinykv | project1 | Standalone KV</title>
    <url>/talent-plan-tinykv-project1/</url>
    <content><![CDATA[<p><a href="https://asktug.com/t/topic/242996" target="_blank" rel="noopener">Talent Plan 2021 KV å­¦ä¹ è¥ä¿¡æ¯æ€»è§ˆ</a></p>
<p>å‰ä¸€é˜µå­çœ‹è§Pç¤¾åœ¨å¾®ä¿¡ç¾¤æ¨äº†è¿™ä¸ªæ´»åŠ¨ï¼Œå‰ä¸€é˜µå­åˆšå­¦äº†6.824å¹¶å†™å®Œäº†lab3ï¼Œæ‰€ä»¥å…´å†²å†²æƒ³å»è¯•è¯•ï¼Œåœ¨ç¾¤é‡Œæ‹‰äº†ä¸€ä¸ªå°ä¼™ä¼´å»è¯•è¯•ã€‚</p>
<p>æ€»ä½“æ”¶è·è¿˜æ˜¯æŒºå¤§çš„ï¼Œtinykvä¹Ÿæ˜¯æŒºéš¾çš„ï¼Œä¸»è¦éš¾åœ¨æ–‡æ¡£å…¶å®æè¿°å¹¶æ²¡æœ‰é‚£ä¹ˆæ¸…æ¥šï¼Œå¾ˆå¤šåœ°æ–¹éƒ½éœ€è¦è‡ªå·±æ·Œå‘ã€‚åŒæ—¶debugæ¯”è¾ƒç—›è‹¦ã€‚ä½†æ˜¯ç¡®å®æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„å·¥ç¨‹é¡¹ç›®ã€‚</p>
<hr>
<h1 id="Project1"><a href="#Project1" class="headerlink" title="Project1"></a>Project1</h1><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><ol>
<li>å®ç°standaloneKV</li>
<li>å®ç°raw_apiï¼Œå®Œæˆæµ‹è¯•</li>
</ol>
<h2 id="å…·ä½“å®ç°"><a href="#å…·ä½“å®ç°" class="headerlink" title="å…·ä½“å®ç°"></a>å…·ä½“å®ç°</h2><h3 id="standalone-storage"><a href="#standalone-storage" class="headerlink" title="standalone_storage"></a>standalone_storage</h3><p>éœ€è¦å®ç°çš„ä»£ç æ”¾åœ¨<code>kv/storage/standalone_storage/standalone_storage.go</code>ï¼Œéœ€è¦å®ç°<code>StandAloneStorage</code>ç»“æ„ä½“ï¼Œæ–¹æ³•éƒ½å·²ç»å®šä¹‰å¥½äº†ï¼Œä»…éœ€è¦å®ç°ã€‚è¿™å…¶å®æ˜¯ä¸€ä¸ªç®€åŒ–çš„<code>raft_storage</code>ï¼Œåªè¦å–å…¶ä¸­ä¸€éƒ¨åˆ†å°±è¡Œäº†ï¼Œå…¶ä½™ä¸æ‡‚çš„apiå‚è€ƒ<code>engine_util</code>å°±è¡Œäº†ã€‚</p>
<ul>
<li>å¯¹äº<code>StandAloneStorage</code>ç»“æ„ä½“æ¥è¯´ï¼Œå…¶å®ä¸€ä¸ª<code>engines</code>å°±è¶³å¤Ÿäº†ï¼Œè°ƒç”¨ä¸€ä¸ªåŒ…è£…å¥½çš„<code>badger</code>æ•°æ®åº“ã€‚</li>
<li><code>Start</code>æ–¹æ³•ï¼Œæ²¡æœ‰éœ€è¦å®ç°çš„å†…å®¹</li>
<li><code>Stop</code>å…³é—­æ•°æ®åº“</li>
<li><code>Write</code>å¯ä»¥å‚è€ƒ<code>engine_util.write_batch.go</code>ï¼Œå®ƒå…¶å®å°±æ˜¯æŠŠ<code>batch</code>æ•°ç»„è½¬åŒ–ä¸ºä¸€ä¸ª<code>WriteBatch</code>ï¼Œå¯ä»¥è¿›è¡Œæ‰¹å¤„ç†å†™å…¥æ•°æ®åº“</li>
<li><code>Reader</code>å¯ä»¥å‚è€ƒ<code>raft_storage</code>ï¼Œéœ€è¦ä¸€ä¸ª<code>badger.txn</code>å¤„ç†ä¸€è‡´æ€§ï¼Œå¯¹äº<code>Reader</code>æ¥è¯´éœ€è¦è¿”å›ä¸€ä¸ªå¯¹è±¡å®ç°<code>StorageReader</code>ï¼Œè¿™é‡Œæ–°å»ºä¸€ä¸ªå¯¹è±¡æ–‡ä»¶<code>reader.go</code>å¯ä»¥å‚è€ƒ<code>region_reader.go</code>ã€‚è¿™é‡Œéœ€è¦äº§ç”Ÿä¸€ä¸ªè¿­ä»£å™¨ï¼Œæˆ‘ä»¬è¿™ä¸ªè¿­ä»£å™¨æ¯”è¾ƒç®€å•ç›´æ¥ä½¿ç”¨<code>cf_iterator.go</code>å°±å¯ä»¥äº†ã€‚</li>
</ul>
<h3 id="raw-api"><a href="#raw-api" class="headerlink" title="raw_api"></a>raw_api</h3><p>éœ€è¦å®ç°çš„ä»£ç æ”¾åœ¨<code>kv/server/raw_api.go</code>ï¼Œæˆ‘ä»¬éœ€è¦å®ç°4ä¸ªapiï¼ŒRawGet/ RawScan/ RawPut/ RawDelete</p>
<ul>
<li>RawGet, æ¯”è¾ƒç®€å•ï¼Œæ³¨æ„è¿”å›ç±»å‹ï¼Œç©ºå€¼éœ€è¦é¢å¤–æ ‡æ³¨</li>
<li>RawPutï¼Œæ¯”è¾ƒç®€å•ï¼Œåˆ©ç”¨<code>Storage.Modify</code>åŒ…è£…åŸæœ‰requestä¸­çš„ï¼ˆkey,valueï¼‰å³å¯</li>
<li>RawDeleteï¼Œå’ŒRawPutç±»ä¼¼</li>
<li>RawScanï¼Œè¿™ä¸ªåŸºäºæˆ‘ä»¬å·²ç»å†™çš„<code>reader.go</code>ï¼Œç‰¹åˆ«æ³¨æ„ï¼Œå½“å¾—åˆ°è¿­ä»£å™¨çš„æ—¶å€™ï¼Œéœ€è¦<code>seek</code>åˆ°å¯¹åº”çš„<code>start_key</code>ï¼Œä¸ç„¶æ‰¾ä¸åˆ°å€¼ã€‚éœ€è¦æ³¨æ„ï¼Œlimitçš„å¤§å°</li>
</ul>
]]></content>
      <categories>
        <category>åˆ†å¸ƒå¼</category>
      </categories>
      <tags>
        <tag>tinykv</tag>
        <tag>raft</tag>
      </tags>
  </entry>
  <entry>
    <title>Talent plan Tinykv | project2 | Raft KV</title>
    <url>/talent-plan-tinykv-project2/</url>
    <content><![CDATA[<h1 id="Project2"><a href="#Project2" class="headerlink" title="Project2"></a>Project2</h1><h2 id="Project2a"><a href="#Project2a" class="headerlink" title="Project2a"></a>Project2a</h2><p>å®éªŒä¸­æ•´ä½“ä»£ç é€»è¾‘</p>
<p>tick è§¦å‘äº‹ä»¶ -&gt; å‘é€è¯·æ±‚è‡³stepï¼ˆä¸ç»è¿‡Msgsï¼‰-&gt; stepé‡‡å–å¯¹åº”æ–¹æ³•ï¼Œè°ƒç”¨sendxxæ–¹æ³•å‘é€requestè‡³Msgsï¼ˆRPC) -&gt; æ¥æ”¶ç«¯é€šè¿‡stepå¤„ç†requestï¼Œè°ƒç”¨handlexxæ–¹æ³•ï¼Œè¿”å›responseè‡³Msgsï¼ˆRPCï¼‰-&gt; å‘é€ç«¯é€šè¿‡stepå¤„ç†responseï¼Œè°ƒç”¨handlexxæ–¹æ³•å¤„ç†</p>
<h3 id="Project2aa"><a href="#Project2aa" class="headerlink" title="Project2aa"></a>Project2aa</h3><h4 id="å®éªŒç›®çš„"><a href="#å®éªŒç›®çš„" class="headerlink" title="å®éªŒç›®çš„"></a>å®éªŒç›®çš„</h4><ol>
<li>å®ŒæˆRaftçš„é¢†å¯¼é€‰ä¸¾</li>
<li>é€šè¿‡æµ‹è¯•<code>project2aa</code></li>
</ol>
<h4 id="å®éªŒæ€è·¯"><a href="#å®éªŒæ€è·¯" class="headerlink" title="å®éªŒæ€è·¯"></a>å®éªŒæ€è·¯</h4><p>å®éªŒæ€è·¯ä»<code>raft/doc.go</code>ä¸­è·å¾—ã€‚</p>
<ol>
<li><p>æ ¹æ®å®éªŒæ‰‹å†Œçš„ç®€å•æç¤ºï¼Œæˆ‘ä»¬å¯ä»¥ä»<code>raft.Raft.tick()</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªé€»è¾‘æ—¶é’Ÿï¼Œç”±Nodeæ¨è¿›ï¼Œä¸è¿‡æš‚æ—¶2aaé‡Œç”¨ä¸åˆ°ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¸€å¼€å§‹å®ç°<code>tick()</code>å‡½æ•°å³å¯ã€‚ä¸åŒstateçš„raftï¼Œå¯¹åº”æ—¶é’Ÿæœ‰ä¸åŒçš„è¡Œä¸ºï¼šå³<code>Follower</code>å’Œ<code>Candidate</code>åªæœ‰é€‰ä¸¾çš„è¡Œä¸ºï¼Œè€Œ<code>Leader</code>åªæœ‰å¿ƒè·³çš„è¡Œä¸ºï¼Œæ ¹æ®doc.goå‰ä¸¤ä¸ªrpcçš„æç¤º(<code>MessageType_MsgHup</code>, <code>MessageType_MsgBeat</code>)å®ç°<code>tickElection</code>å’Œ<code>tickHeartbeat</code>ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°è§¦å‘è§¦å‘é€‰ä¸¾/å¿ƒè·³æ“ä½œï¼Œå‘é€å¯¹åº”çš„é€‰ä¸¾(<code>MessageType_MsgHup</code>)/å¿ƒè·³è¯·æ±‚(<code>MessageType_MsgBeat</code>)è‡³stepï¼Œç”±stepå…·ä½“è§¦å‘å…·ä½“çš„é€‰ä¸¾å’Œå¿ƒè·³æ“ä½œã€‚</p>
</li>
<li><p>é€‰ä¸¾ï¼Œå…¥å£<code>startElection</code>ï¼ŒæŒ‰ç…§è®ºæ–‡æ‰€è¿°ï¼Œä¸»è¦æ³¨æ„<code>lastLogIndex</code>ï¼Œ<code>lastLogTerm</code>çš„è·å¾—ï¼Œè¿™é‡Œéœ€è¦å…ˆä¿®æ”¹<code>raftlog</code>ã€‚ç„¶åå¯¹æ¯ä¸ªpeerï¼ˆä¸åŒ…å«è‡ªå·±ï¼‰å‘é€<code>sendRequestVote</code>ã€‚è¿™é‡Œæ³¨æ„éœ€è¦é‡ç½®é€‰ä¸¾çš„æ—¶é—´å’Œè¶…æ—¶æ—¶é—´ï¼Œè¶…æ—¶æ—¶é—´çš„è®¾ç½®å¯ä»¥å‚è€ƒ<code>testNonleaderElectionTimeoutRandomized</code>é‡Œé¢å†™çš„èŒƒå›´(timeout, 2*timeout)ã€‚ç„¶åä¹Ÿæ˜¯ç”±stepå‡½æ•°å¤„ç†<code>RequestVote</code>ï¼Œå¯¹åº”è®ºæ–‡ä¸­çš„é€‰ä¸¾è§„åˆ™ã€‚æˆ‘ä»¬ç»¼åˆäº†è®ºæ–‡å’Œdoc.goçš„æ€è·¯ï¼Œæœ€åå®ç°çš„ç»“æœç»¼åˆäº†ä¸¤ä¸ªã€‚æœ€åè¿”å›é€‰ä¸¾ç»“æœç»™å‘é€è€…ã€‚</p>
<ul>
<li>å¦‚æœé€‰ä¸¾æ—¶,åªå­˜åœ¨è‡ªå·±ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥å˜æˆleaderã€‚</li>
<li>followeræ¥å—åˆ°é€‰ä¸¾è¯·æ±‚ï¼Œéœ€è¦æ£€æŸ¥è¿™æ¡ä¿¡æ¯æ˜¯å¦è¶³å¤Ÿæ–°ï¼Œå®ƒä¸€ä¸ªtermåªèƒ½æœ‰ä¸€ä¸ªvoteå¯¹è±¡ï¼Œå¦‚æœæœ‰å…¶ä»–çš„è¯·æ±‚ï¼Œå¯ä»¥ç›´æ¥å›ç»ï¼Œç„¶åéœ€è¦æ¯”å¯¹è¯·æ±‚çš„æ—¥å¿—æ˜¯å¦ä¸ºæœ€æ–°ï¼Œé‡ç½®é€‰ä¸¾æ—¶é—´ï¼Œå‘é€ç»“æœã€‚</li>
<li>å‘é€è€…ä¼šç»Ÿè®¡æ”¶åˆ°çš„ç¥¨æ•°ï¼Œå‘é€è€…ç»Ÿè®¡æœ€ç»ˆçš„ç¥¨æ•°ï¼Œå¦‚æœè¶…è¿‡åŠæ•°èµæˆï¼Œåˆ™å˜æˆLeaderï¼Œå¦‚æœè¶…è¿‡åŠæ•°æ‹’ç»ï¼Œåˆ™å˜æˆfollower, åŒæ—¶æƒ©ç½šå…¶é€‰ä¸¾æ—¶é—´è‡³2å€ï¼Œæœ€å¤§4å€çš„timtoutã€‚</li>
<li>å˜æˆleaderéœ€è¦å°†ä¸€ä¸ªç©ºlogåŠ å…¥åˆ°æ—¥å¿—ä¸­</li>
</ul>
</li>
<li><p>å¿ƒè·³ï¼Œå…¥å£<code>startElection</code>ï¼Œè¿™é‡Œä¸è®ºæ–‡ä¸åŒï¼Œæœ¬å®éªŒå°†å¿ƒè·³ä¸appendEntriesåˆ†å¼€äº†ï¼Œæ‰€ä»¥è¯¥å‡½æ•°æ¥è¯´ååˆ†ç®€å•ï¼ŒLeaderä»…éœ€å®šæ—¶å‘é€è‡ªå·±çš„å¿ƒè·³è¯·æ±‚å³å¯ï¼Œæ¥æ”¶è€…æ ¹æ®å¿ƒè·³è¯·æ±‚æ˜¯å¦æ­£ç¡®ï¼Œæ¥é‡ç½®è‡ªå·±çš„é€‰ä¸¾æ—¶é—´ã€timeoutå’Œleaderï¼Œè¿”å›responseç»™å‘é€è€…ã€‚</p>
</li>
</ol>
<h3 id="Project2ab"><a href="#Project2ab" class="headerlink" title="Project2ab"></a>Project2ab</h3><h4 id="å®éªŒç›®çš„-1"><a href="#å®éªŒç›®çš„-1" class="headerlink" title="å®éªŒç›®çš„"></a>å®éªŒç›®çš„</h4><ol>
<li>å®ç°æ—¥å¿—å¤åˆ¶</li>
<li>é€šè¿‡æµ‹è¯•project2ab</li>
</ol>
<h4 id="å®éªŒæ€è·¯-1"><a href="#å®éªŒæ€è·¯-1" class="headerlink" title="å®éªŒæ€è·¯"></a>å®éªŒæ€è·¯</h4><ol>
<li><p>å½“æ¥æ”¶åˆ°<code>MessageType_MsgPropose</code>è¿™ä¸ªlocal msgï¼Œleaderé¦–å…ˆè°ƒç”¨<code>appendEntry</code>æ·»åŠ æ—¥å¿—ï¼Œç„¶åè°ƒç”¨<code>bcastAppend</code>æ–¹æ³•ï¼Œå‘å…¶ä½™èŠ‚ç‚¹å‘é€<code>MessageType_MsgAppend</code>æ¶ˆæ¯ã€‚</p>
</li>
<li><p>å½“å…¶ä½™èŠ‚ç‚¹æ”¶åˆ°leaderçš„<code>MessageType_MsgAppend</code>æ¶ˆæ¯ï¼ŒçŠ¶æ€è½¬ä¸ºfollowerï¼Œå…·ä½“å¤„ç†ç»†èŠ‚å‚ç…§raftè®ºæ–‡ã€‚éœ€è¦å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œfollowerå¤„ç†æ­¤æ¶ˆæ¯æ—¶ï¼Œéœ€è¦ä¾æ®leaderçš„commitIndexï¼Œæœ¬åœ°commitIndexå’Œæœ€æ–°æ—¥å¿—ç´¢å¼•çš„çŠ¶æ€æ¥æ›´æ–°æœ¬åœ°commitIndexã€‚ä½†åœ¨åˆ¤æ–­æ—¶ï¼Œæœ€æ–°æ—¥å¿—ç´¢å¼•ä¸èƒ½è°ƒç”¨<code>follower.getLastLogIndex()</code>æ¥è·å–ï¼Œè€Œæ˜¯éœ€è¦é€šè¿‡<code>MessageType_MsgAppend</code>ä¸­<code>Index</code>å’Œ<code>Entries</code>çš„é•¿åº¦è®¡ç®—å¾—å‡ºã€‚å½“èŠ‚ç‚¹å¤„ç†ç»“æŸåï¼Œå‘leaderèŠ‚ç‚¹å‘é€<code>MessageType_MsgAppendResponse</code>æ¶ˆæ¯ã€‚</p>
<ul>
<li>æ¥æ”¶è€…æ¥æ”¶åˆ°appendEntries é¦–å…ˆè¦æ£€æŸ¥æ¶ˆæ¯æ˜¯å¦æ˜¯æœ€æ–°çš„ï¼Œæ£€æŸ¥æ—¥å¿—ä¸‹æ ‡æ˜¯å¦ç¬¦åˆï¼ŒæŸ¥æ‰¾æ˜¯å¦åŒ…å«è¯·æ±‚çš„indexï¼Œå¦‚æœåœ¨ï¼Œåˆ™æŸ¥æ‰¾å…¶termå’Œindexæ˜¯å¦å’Œæœ¬åœ°çš„ç›¸åŒï¼Œä¸åŒåˆ™å‘ç”Ÿæ—¥å¿—å†²çªï¼Œåˆ™æ‰¾åˆ°ä¸Šä¸€ä¸ªtermçš„æœ€åä¸€é¡¹indexï¼Œè¿”å›å†²çªçš„ä¸‹æ ‡ï¼›å¦‚æœä¸åœ¨åˆ™å°†æ—¥å¿—æŒ‰é¡ºåºåŠ å…¥åˆ°æœ¬åœ°æ—¥å¿—ä¸­ï¼ŒåŒæ—¶åˆ æ‰ä¸è¯·æ±‚æ—¥å¿—ä¸ç›¸ç¬¦çš„æ—¥å¿—ä»¥åŠä¹‹åæ‰€æœ‰çš„æ—¥å¿—</li>
</ul>
</li>
<li><p>å½“leaderæ¥æ”¶åˆ°<code>MessageType_MsgAppendResponse</code>æ¶ˆæ¯ï¼Œæ ¹æ®å…¶rejectï¼Œå¦‚æœæ¥å—äº†ï¼ŒæŒ‰ç…§æ¶ˆæ¯æ›´æ–°<code>raft.Prs</code>å’Œ<code>raft.RaftLog.committed</code>ã€‚å¦‚æœæœªæ¥å—ï¼Œåˆ™éœ€è¦æŸ¥æ‰¾å†²çªçš„æ—¥å¿—ä¸‹æ ‡ï¼Œé‡æ–°ä¿®æ”¹prsï¼Œç»§ç»­å‘é€æ—¥å¿—ã€‚å½“leaderå¤„ç†ç»“æŸï¼Œå‘ç°<code>Msg.From</code>èŠ‚ç‚¹çš„commitIndexä¸leaderä¸ä¸€è‡´ï¼Œåˆ™ç»§ç»­å‘é€<code>MessageType_MsgAppend</code>æ¶ˆæ¯ï¼Œç›´è‡³è¾¾æˆä¸€è‡´çŠ¶æ€ã€‚åŒæ ·çš„ï¼Œå¦‚æœleaderåœ¨å¤„ç†<code>MessageType_MsgAppendResponse</code>æ¶ˆæ¯æ—¶ï¼ŒcommitIndexå‘ç”Ÿæ›´æ–°ï¼Œé‚£ä¹ˆleaderä¼šç»™å…¶ä½™æ‰€æœ‰èŠ‚ç‚¹å‘é€<code>MessageType_MsgAppend</code>ã€‚</p>
</li>
<li><p>å½“leaderå‘é€å¿ƒè·³å¹¶æ”¶åˆ°å…¶ä½™èŠ‚ç‚¹çš„<code>MessageType_MsgHeartbeatResponse</code>æ¶ˆæ¯ï¼Œleaderä¼šåˆ¤æ–­æ­¤followerçš„lastLogIndexæ˜¯å¦ä¸leaderçš„lastLogIndexä¸€è‡´ï¼Œè‹¥ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆleaderä¼šç»™è¯¥èŠ‚ç‚¹å‘é€<code>MessageType_MsgAppend</code>ã€‚</p>
</li>
</ol>
<h3 id="Project2ac"><a href="#Project2ac" class="headerlink" title="Project2ac"></a>Project2ac</h3><h4 id="å®éªŒç›®çš„-2"><a href="#å®éªŒç›®çš„-2" class="headerlink" title="å®éªŒç›®çš„"></a>å®éªŒç›®çš„</h4><ol>
<li>å®ç°rawnodeä¸­çš„<code>Ready()</code>ã€<code>HasReady()</code>ã€<code>Advance()</code>å‡½æ•°</li>
<li>é€šè¿‡æµ‹è¯•project2ac</li>
</ol>
<h4 id="å®éªŒæ€è·¯-2"><a href="#å®éªŒæ€è·¯-2" class="headerlink" title="å®éªŒæ€è·¯"></a>å®éªŒæ€è·¯</h4><p><code>Ready</code>ç»“æ„ä½“å†…å¯¹å®ƒçš„æ‰€æœ‰å‚æ•°è§£é‡Šå·²ç»éå¸¸å…¨é¢äº†</p>
<p><code>Ready()</code>ï¼šè¿”å›ä¸€ä¸ªReadyç»“æ„ä½“ï¼ŒåŒ…å«å¯¹åº”çš„å‚æ•°</p>
<p><code>HasReady()</code>ï¼šæ ¹æ®Raftåˆ¤æ–­æ˜¯å¦åº”è¯¥ç”ŸæˆReadyç»“æ„ä½“ï¼Œå½“ç„¶è¿™é‡Œçš„åˆ¤æ–­æ ‡å‡†æœ‰å¾ˆå¤šã€‚é¦–å…ˆè¦çœ‹<code>softState</code>å’Œ<code>hardState</code>ï¼Œè¿™ä¸¤ä¸ªç»“æ„ä½“è¯¦ç»†å†…å®¹å·²ç»åœ¨Readyä¸­å¾—åˆ°è¯´æ˜ï¼Œç®€å•è¯´å°±æ˜¯è¿™ä¸¤ä¸ªç»“æ„ä½“å¦‚æœä¸ä¸Šæ¬¡ä¸åŒåˆ™è¿”å›<code>true</code>ã€‚åŒæ—¶éœ€è¦åˆ¤æ–­<code>CommittedEntries</code>æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºåˆ™è¿”å›<code>true</code>ï¼Œè¿™ä¸ªå±æ€§å±äºæ—¥å¿—ä¸­å·²ç»æäº¤äº†ä½†æ˜¯è¿˜æ²¡åº”ç”¨åˆ°çŠ¶æ€æœºä¸­çš„æ—¥å¿—ã€‚åŒæ—¶ä¹Ÿéœ€è¦åˆ¤æ–­<code>Entries</code>æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºè¿”å›<code>true</code>ï¼Œè¿™ä¸ªå±æ€§å±äºæ—¥å¿—ä¸­éœ€è¦æŒä¹…åŒ–çš„æ—¥å¿—ï¼Œå³stabledä¹‹åçš„ã€‚å…¶ä»–æƒ…å†µè¿”å›<code>false</code></p>
<p><code>Advance(rd Ready)</code>ï¼šè¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ª<code>Ready</code>ï¼Œä¸»è¦ç”¨æ¥å¤„ç†<code>Ready</code>ï¼Œåœ¨æœ¬å®éªŒä¸­åªéœ€è¦å¤„ç†<code>CommittedEntries</code>ï¼Œå¹¶æ›´æ–°raftä¸­çš„<code>stable</code>å°±å¯ä»¥äº†ï¼Œè¿˜æœ‰<code>Entries</code>æ›´æ–°<code>applied</code>å³å¯ã€‚ä½†æ˜¯æœ¬èº«éœ€è¦å¤„ç†æ›´å¤šå†…å®¹ï¼Œè¿™æ˜¯åé¢å®éªŒçš„å†…å®¹äº†ã€‚</p>
<h2 id="Project2b"><a href="#Project2b" class="headerlink" title="Project2b"></a>Project2b</h2><h3 id="å®éªŒç›®çš„-3"><a href="#å®éªŒç›®çš„-3" class="headerlink" title="å®éªŒç›®çš„"></a>å®éªŒç›®çš„</h3><ol>
<li>å®ç°<code>PeerStorage.SaveReadyState</code>å’Œ<code>PeerStorage.Append</code>æ–¹æ³•</li>
<li>å®ç°<code>proposeRaftCommand</code>å’Œ<code>HandleRaftReady</code>æ–¹æ³•</li>
<li>é€šè¿‡æµ‹è¯•project2b</li>
</ol>
<h3 id="å®éªŒç»†èŠ‚"><a href="#å®éªŒç»†èŠ‚" class="headerlink" title="å®éªŒç»†èŠ‚"></a>å®éªŒç»†èŠ‚</h3><p>åœ¨tinkvçš„è®¾è®¡ä¸­ï¼Œä¸€ä¸ª<code>Store</code>å¯ä»¥æ‹¥æœ‰å¤šä¸ªRaftèŠ‚ç‚¹ï¼Œå³<code>Peer</code>ï¼Œè€Œè¿™äº›<code>Peer</code>åˆéš¶å±äºä¸åŒçš„<code>Region</code>ã€‚å¯¹äºå•ä¸ª<code>Peer</code>è€Œè¨€ï¼Œè‹¥èŠ‚ç‚¹çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œå³<code>HasReady()</code>è¿”å›trueï¼ŒèŠ‚ç‚¹éœ€è¦å°†Stateã€æ—¥å¿—å’Œå¿«ç…§æŒä¹…åŒ–ï¼Œç„¶åèŠ‚ç‚¹å¤„ç†å¹¶å›å¤ä¸Šå±‚ä¼ é€’çš„Msgã€‚</p>
<p>æŒä¹…åŒ–Stateã€æ—¥å¿—å’Œå¿«ç…§æ—¶ï¼Œä¼šåˆ©ç”¨åº•å±‚çš„<code>badger</code>åˆ›å»ºçš„ä¸¤ä¸ªæ•°æ®åº“ï¼ŒraftDBå’ŒkvDBï¼Œå…·ä½“å­˜å‚¨ç»†èŠ‚å¦‚è¡¨æ‰€ç¤ºï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">Key</th>
<th style="text-align:left">KeyFormat</th>
<th style="text-align:left">Value</th>
<th style="text-align:left">DB</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">raft_log_key</td>
<td style="text-align:left">0x01 0x02 region_id 0x01 log_idx</td>
<td style="text-align:left">Entry</td>
<td style="text-align:left">raft</td>
</tr>
<tr>
<td style="text-align:left">raft_state_key</td>
<td style="text-align:left">0x01 0x02 region_id 0x02</td>
<td style="text-align:left">RaftLocalState</td>
<td style="text-align:left">raft</td>
</tr>
<tr>
<td style="text-align:left">apply_state_key</td>
<td style="text-align:left">0x01 0x02 region_id 0x03</td>
<td style="text-align:left">RaftApplyState</td>
<td style="text-align:left">kv</td>
</tr>
<tr>
<td style="text-align:left">region_state_key</td>
<td style="text-align:left">0x01 0x03 region_id 0x01</td>
<td style="text-align:left">RegionLocalState</td>
<td style="text-align:left">kv</td>
</tr>
</tbody>
</table>
</div>
<p>æœ¬å®éªŒï¼Œæ—¥å¿—çš„æŒä¹…åŒ–åœ¨<code>PeerStorage.Append</code>æ–¹æ³•ä¸­å®Œæˆï¼Œåœ¨å­˜å‚¨æ—¶ï¼Œéœ€è¦æ³¨æ„ä¸€ä¸‹å‡ ä¸ªè¦ç‚¹ï¼š</p>
<ol>
<li>ä»…å­˜å‚¨æœªå­˜å‚¨çš„æœ€æ–°çš„log</li>
<li>è‹¥raftDBå­˜å‚¨çš„æœªè¢«commitçš„logï¼Œå­˜åœ¨å°†æ¥æ°¸è¿œä¸ä¼šè¢«commitçš„æƒ…å†µï¼Œéœ€è¦ä»raftDBä¸­åˆ é™¤</li>
<li>logå­˜å‚¨å®Œæˆåï¼Œéœ€è¦æ›´æ–°<code>PeerStorage.raftState</code>ï¼Œå› ä¸ºæ­¤æ—¶<code>raftState</code>çš„logç´¢å¼•å’Œtermå‡å·²å‘ç”Ÿæ”¹å˜</li>
</ol>
<p><code>PeerStorage.SaveReadyState</code>æ˜¯å¯¹æŒä¹…åŒ–Stateã€æ—¥å¿—å’Œå¿«ç…§çš„ä¸€ä¸ªå°è£…ã€‚æ—¥å¿—çš„æŒä¹…åŒ–è°ƒç”¨<code>PeerStorage.Append</code>æ–¹æ³•ã€‚æŒä¹…åŒ–Stateå‰ï¼Œéœ€è¦ä¾æ®<code>raft.Ready</code>æ›´æ–°<code>PeerStorage.raftState</code>ï¼Œç„¶åå°†<code>PeerStorage.raftState</code>å†™å…¥raftDBä¸­ã€‚å¿«ç…§çš„æŒä¹…åŒ–åœ¨åç»­å®éªŒå®Œæˆã€‚</p>
<p>æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¸»è¦ç”±<code>peerMsgHandler</code>å¤„ç†ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªåŠŸèƒ½ï¼šä¸€ä¸ªæ˜¯<code>HandleMsgs</code>ï¼Œå¦ä¸€ä¸ªæ˜¯<code>HandleRaftReady</code>ã€‚</p>
<p><code>HandleMsgs</code>å¤„ç†ä» raftCh æ¥æ”¶åˆ°çš„æ‰€æœ‰æ¶ˆæ¯ï¼Œæœ¬å®éªŒæˆ‘ä»¬åªéœ€è¦å…³æ³¨<code>message.MsgTypeRaftCmd</code>ï¼Œå°†æ­¤ç±»æ¶ˆæ¯ç”±<code>proposeRaftCommand</code>æ–¹æ³•å¤„ç†åï¼Œå†å‘é€åˆ°rafté›†ç¾¤å†…ã€‚</p>
<p>å®ç°<code>proposeRaftCommand</code>æ—¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹è¦ç‚¹ï¼š</p>
<ol>
<li>åˆ¤æ–­æ¶ˆæ¯åˆæ³•æ€§ï¼Œå¦‚æœkeyä¸å±äºå½“å‰raftRegionï¼Œ<code>message.Callback</code>è¿”å›<code>ErrResp</code></li>
<li>å¯¹æ¶ˆæ¯æ‰€åŒ…å«çš„æ•°æ®åºåˆ—åŒ–</li>
<li>å°†æ­¤æ¶ˆæ¯çš„ProposalIndexå’ŒTermï¼Œä»¥åŠ<code>message.Callback</code>ä»¥<code>proposal</code>ç»“æ„ä½“çš„å½¢å¼è®°å½•ä¸‹æ¥</li>
<li>æŠŠåºåˆ—åŒ–åçš„æ•°æ®ï¼Œç”±<code>propose</code>å‡½æ•°å°è£…ä¸ºæ—¥å¿—</li>
</ol>
<p>æ¶ˆæ¯å¤„ç†å®Œåï¼ŒRaftèŠ‚ç‚¹ä¼šæœ‰ä¸€äº›çŠ¶æ€æ›´æ–°ï¼Œ<code>HandleRaftReady</code><br>ä»Raftæ¨¡å—å‡†å¤‡å¥½å¹¶æ‰§è¡Œç›¸åº”çš„æ“ä½œï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p>
<ol>
<li>è‹¥raftèŠ‚ç‚¹çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œè°ƒç”¨<code>PeerStorage.SaveReadyState</code>è¿›è¡ŒæŒä¹…åŒ–</li>
<li>å°†æ¶ˆæ¯è½¬å‘ç»™raftï¼Œç„¶åå¯¹raftä¸­å·²ç»commitçš„logï¼Œå¤„ç†å¹¶æŒ‰ç…§logç±»å‹ï¼Œåœ¨æ•°æ®åº“ä¸­æ‰§è¡Œç›¸åº”æ“ä½œ</li>
<li>æ¯ä¸€æ¡logéƒ½å¯¹åº”ä¸€æ¡<code>proposal</code>ï¼Œè¿›è¡Œ<code>proposal</code>çš„æ¶ˆè´¹æ—¶ï¼Œéœ€è¦å¯¹entry.Index, entry.Termä¸proposal.Index, proposal.Termè¿›è¡Œåˆ†ç±»æƒ…å†µè®¨è®º:</li>
</ol>
<p>å¦‚æœé‡åˆ°entry.Index &gt; proposal.Indexï¼Œè¡¨é¢proposalä¸­æœ‰è¢«æŠ›å¼ƒçš„æ¶ˆæ¯ï¼Œå› æ­¤éœ€è¦ç›´æ¥å¯¹è¿™äº›æ¶ˆæ¯è¿”å›Errï¼Œç›´åˆ°indexç›¸ç­‰</p>
<p>å¦‚æœentry.Index == proposal.Index &amp;&amp; entry.Term == proposal.Term,ç›´æ¥å›åº”proposalä¸­çš„æ¶ˆæ¯;</p>
<p>å¦‚æœentry.Index == proposal.Index &amp;&amp; entry.Term != proposal.Term,è¯´æ˜æ­¤æ¡proposalå¯¹åº”çš„æ¶ˆæ¯æœªèƒ½è¾¾æˆåŒæ­¥ï¼Œä½†ä¸èƒ½ç›´æ¥è¿”å›errï¼Œè€Œåº”è¯¥ç»§ç»­å‘åæœç´¢proposalï¼Œç›´åˆ°å°†è¯¥Indexçš„æ¶ˆæ¯å…¨éƒ¨å¤„ç†æˆ–è€…å¤„ç†åˆ°entry.Index == proposal.Index &amp;&amp; entry.Term == proposal.Term;</p>
<ol>
<li>å¯¹logåœ¨æ•°æ®åº“ä¸­æ‰§è¡Œç»“æŸåï¼ŒæŒ‰ç…§æ“ä½œç±»å‹ï¼Œcallbackç›¸åº”çš„resp</li>
<li>åœ¨è¿”å›<code>get</code>/<code>snap</code>è¯·æ±‚æ—¶ï¼Œåº”è¯¥å°†<code>writebatch</code>å†™å…¥DBå†è¿”å›ã€‚</li>
</ol>
<h2 id="Project2c"><a href="#Project2c" class="headerlink" title="Project2c"></a>Project2c</h2><h3 id="å®éªŒç›®çš„-4"><a href="#å®éªŒç›®çš„-4" class="headerlink" title="å®éªŒç›®çš„"></a>å®éªŒç›®çš„</h3><ol>
<li>å®ç°æ—¥å¿—å‹ç¼©ï¼Œåˆ é™¤è¿‡æœŸçš„æ—¥å¿—</li>
<li>å®ç°å¿«ç…§</li>
<li>é€šè¿‡æµ‹è¯•project2c</li>
</ol>
<h3 id="å®éªŒç»†èŠ‚-1"><a href="#å®éªŒç»†èŠ‚-1" class="headerlink" title="å®éªŒç»†èŠ‚"></a>å®éªŒç»†èŠ‚</h3><p>Raftstoreä¼šä¸æ—¶æ£€æŸ¥æ—¥å¿—æ•°é‡æ˜¯å¦è¶…å‡ºé˜ˆå€¼ï¼Œå¦‚æœæ˜¯ï¼Œå®ƒä¼šæå‡º<code>AdminRequest.CompactLogRequest</code>å‘½ä»¤ã€‚è¿™ä¸ªå‘½ä»¤çš„å¤„ç†æ–¹å¼ä¸2bä¸€è‡´ï¼Œè‹¥èŠ‚ç‚¹çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œå³<code>HasReady()</code>è¿”å›trueï¼ŒèŠ‚ç‚¹è°ƒç”¨<code>HandleRaftReady</code>å¤„ç†æ—¥å¿—ï¼Œå°†æ—¥å¿—ä¸­çš„å‘½ä»¤åŠ ä»¥å®ç°ã€‚æ—¥å¿—å‹ç¼©å¤„ç†æ—¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹è¦ç‚¹ï¼š</p>
<ol>
<li>æ›´æ–°<code>RaftApplyState.TruncatedState</code></li>
<li>è°ƒç”¨<code>ScheduleCompactLog</code>å‡½æ•°ï¼Œè®©raftlog-gc workerå¼‚æ­¥æ‰§è¡Œå®é™…çš„æ—¥å¿—åˆ é™¤å·¥ä½œ</li>
<li>å¯¹<code>RaftApplyState</code>çš„ä¿å­˜ï¼Œè¦å…ˆäºæ—¥å¿—åˆ é™¤æ“ä½œã€‚å¦åˆ™å½“èŠ‚ç‚¹å®•æœºï¼Œä¼šå‡ºç°<code>RaftApplyState</code>ä¸DBä¸­æ—¥å¿—ä¸ä¸€è‡´çš„çŠ¶å†µ</li>
</ol>
<p>å½“æ—¥å¿—è¢«å‹ç¼©åï¼ŒRaftå¯èƒ½éœ€è¦å‘é€å¿«ç…§ã€‚å‘é€æˆåŠŸåï¼Œé‚£ä¹ˆå¿«ç…§ä¼šåæ˜ åœ¨ä¸‹ä¸€æ¬¡ Raft readyä¸­ï¼Œ<code>hasReady()</code>è¿”å›trueã€‚ç„¶åå¼€å§‹<code>SaveReadyState</code>ï¼Œå…¶ä¸­æ—¥å¿—çš„æŒä¹…åŒ–å·²ç»åœ¨2abå®Œæˆï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦å®Œæˆå¯¹å¿«ç…§çš„æŒä¹…åŒ–ï¼Œä¸»è¦æ“ä½œæœ‰ï¼š</p>
<ol>
<li>è°ƒç”¨<code>clearMeta()</code>å’Œ<code>clearExtraData()</code>æ¸…é™¤è€æ—§çš„å…ƒæ•°æ®</li>
<li>ä¿®æ”¹ç›¸åº”çš„<code>raftState</code>å’Œ<code>applyState</code></li>
<li>ä¿®æ”¹<code>snapState.StateType</code>çŠ¶æ€ä¸º<code>SnapState_Applying</code></li>
<li>å‘é€<code>RegionTaskApply</code>ä»»åŠ¡ç»™<code>regionSched</code></li>
</ol>
<p>å½“èŠ‚ç‚¹æ”¶åˆ°å¿«ç…§åï¼Œéœ€è¦è°ƒç”¨handleSnapshotå¤„ç†ï¼Œå…¶ä¸­åŒ…å«æ—¥å¿—çš„åˆ é™¤ï¼Œè¿™é‡Œé‡‡ç”¨è®ºæ–‡ä¸­çš„æ—¥å¿—åˆ é™¤æ–¹æ³•ã€‚å¦‚æœåœ¨æ—¥å¿—æ‰¾åˆ°ä¸€ä¸ªindexå’Œtermä¸snapshotä¸­çš„æœ€ååŒ¹é…çš„ï¼Œé‚£ä¹ˆåˆ é™¤è¯¥æ—¥å¿—ä¹‹å‰(åŒ…å«)ï¼Œå¦åˆ™å…¨éƒ¨åˆ é™¤ã€‚åŒæ—¶æ›´æ–°å„ç±»å±æ€§ã€‚æ³¨æ„æ¥å—snapshotçš„èŠ‚ç‚¹ï¼Œéƒ½è¦è°ƒç”¨<code>becameFollower</code>ï¼Œæ„å‘³ç€åªæœ‰leaderèƒ½å¤Ÿå‘é€snapshotã€‚åŒæ—¶leaderåœ¨è°ƒç”¨<code>sendAppend</code>æ—¶è¦æŸ¥çœ‹è¿™ä¸ªpeerçš„NextIndexæ˜¯å¦è½ålogçš„å¼€å§‹indexï¼Œè½ååˆ™éœ€è¦å‘é€snapshotã€‚</p>
<h2 id="é™„åŠ åŠŸèƒ½ï¼š"><a href="#é™„åŠ åŠŸèƒ½ï¼š" class="headerlink" title="é™„åŠ åŠŸèƒ½ï¼š"></a>é™„åŠ åŠŸèƒ½ï¼š</h2><h3 id="snapshoté™é€Ÿ"><a href="#snapshoté™é€Ÿ" class="headerlink" title="snapshoté™é€Ÿ"></a>snapshoté™é€Ÿ</h3><p>snapshotå‘é€æ¯”è¾ƒè€—è´¹èµ„æºï¼Œé˜²æ­¢é‡å¤å‘é€å¤§é‡å æ®ç³»ç»Ÿèµ„æºï¼Œå¯ä»¥å¯¹snapshotçš„å‘é€åšé™åˆ¶ã€‚</p>
<p>æ‰€ä»¥æˆ‘åœ¨leaderå‡ºåŠ å…¥ä¸€ä¸ªæ–°çš„åŠŸèƒ½</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">haveSendedSnapShot <span class="keyword">map</span>[<span class="keyword">uint64</span>]<span class="keyword">int</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªè®°å½•äº†å·²å‘é€æ¯ä¸€ä¸ªsnapshotå¯¹è±¡ï¼Œä»¥åŠå‘é€æ—¶é•¿ã€‚<br>å³</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>peer</th>
<th>ticktime</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
</tr>
</tbody>
</table>
</div>
<p>ticktime éšé€»è¾‘æ—¶é’Ÿå‘¨æœŸå¢é•¿</p>
<p>å½“æœ‰æ–°çš„snapshotæ—¶æ’å…¥å®ƒï¼Œticktimeè¶…è¿‡pendingSnapShotTimeoutæˆ–è€…æ¥å—åˆ°appendEntriesResponseæ—¶, ä¾¿å¯ä»¥åˆ é™¤è¿™ä¸ªè®°å½•ã€‚</p>
<p>å‘é€snapshotæ—¶ï¼Œå°±å¯æŸ¥è¿™ä¸ªè¡¨ã€‚</p>
<h3 id="å¤±æ•ˆleader"><a href="#å¤±æ•ˆleader" class="headerlink" title="å¤±æ•ˆleader"></a>å¤±æ•ˆleader</h3><p>å½“ä¸€ä¸ªleaderè¢«åˆ†åŒºå°‘æ•°partitionæ—¶ï¼Œå®ƒè™½ç„¶ä¸èƒ½ç»§ç»­commitå’Œapplyï¼Œä½†æ˜¯å®ƒä»ç„¶æ¥å—clientè¯·æ±‚ï¼Œæ¥å—å¤§é‡proposalï¼Œæ‰€ä»¥é‰´äºæ­¤ï¼Œæˆ‘ä»¬å¸Œæœ›leaderæ²¡æ”¶é›†åˆ°è¶³å¤Ÿçš„heartbeatæ—¶ï¼Œå˜æˆfollower</p>
<p>æ‰€ä»¥é€‰æ‹©åœ¨ProgressåŠ å…¥ä¸€ä¸ª<code>LastHeartBeatElapsed</code>ï¼Œå®ƒè®°å½•äº†ä¸Šä¸€æ¬¡heartbeatåˆ°ç°åœ¨çš„é€»è¾‘æ—¶é’Ÿæ—¶é—´ã€‚</p>
<ul>
<li>åˆ©ç”¨é€»è¾‘æ—¶é’Ÿæœºåˆ¶, åŠ å…¥ <code>tickLeaderLeaseCheck()</code></li>
<li>å¦‚æœè¶…è¿‡äº†ä¸€ä¸ªæ—¶é—´ç•Œé™ <code>leaderAliveTimeout</code>, åˆ™å¼€å§‹æ£€æµ‹ leader çš„æœ‰æ•ˆæ€§, æ£€æµ‹æ–¹æ³•:<ul>
<li>éå†ä¸€éæ‰€æœ‰çš„ follower, <code>LastHeartBeatElapsed</code> å°äº leaderLeaseTimeoutï¼Œå¦‚æœåŠæ•°ä»¥ä¸Šéƒ½æ»¡è¶³, é‚£ä¹ˆè¯¥ leader ä»ç„¶æ˜¯æœ‰æ•ˆçš„ã€‚å¦åˆ™è½¬åŒ–ä¸ºfollower</li>
</ul>
</li>
<li><code>leaderAliveTimeout</code> çš„è®¾ç½®: å¯ä»¥è®¾ç½®ä¸º <code>electionTimeout</code> çš„ä¸¤å€æˆ–è€…ä¸‰å€, å»ºè®®ä¸¤å€</li>
<li><code>leaderLeaseTimeout</code> çš„è®¾ç½®: å¯ä»¥è®¾ç½®ä¸º 90% * <code>electionTimeout</code> , ä¹Ÿå³åœ¨è¿™æ®µæ—¶é—´å†…, å¯ä»¥ä¿è¯ leader æ˜¯æœ‰æ•ˆçš„</li>
</ul>
]]></content>
      <categories>
        <category>åˆ†å¸ƒå¼</category>
      </categories>
      <tags>
        <tag>tinykv</tag>
        <tag>raft</tag>
      </tags>
  </entry>
  <entry>
    <title>Talent plan Tinykv | project3 | Multi-raft KV</title>
    <url>/talent-plan-tinykv-project3/</url>
    <content><![CDATA[<h1 id="project3"><a href="#project3" class="headerlink" title="project3"></a>project3</h1><h2 id="project3a"><a href="#project3a" class="headerlink" title="project3a"></a>project3a</h2><h3 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><ol>
<li>å®ç°leaderçš„è½¬ç§»</li>
<li>å®ç°confçš„åˆ‡æ¢</li>
<li>é€šè¿‡project3a</li>
</ol>
<h3 id="å®ç°ç»†èŠ‚"><a href="#å®ç°ç»†èŠ‚" class="headerlink" title="å®ç°ç»†èŠ‚"></a>å®ç°ç»†èŠ‚</h3><ol>
<li><p>åœ¨<code>stepLeader</code>ä¸­å®ç°<code>MsgTransferLeader</code>çš„ç±»å‹å¤„ç†è°ƒç”¨<code>handleTransferLeader</code>å‡½æ•°ï¼Œåœ¨è¯¥å‡½æ•°ä¸­ï¼šé¦–å…ˆå¯¹é‡å¤è¯·æ±‚è¿›è¡Œæå‰è¿”å›ï¼›æ£€æŸ¥ç›®æ ‡èŠ‚ç‚¹çš„å¯ç”¨æ€§ï¼›é‡ç½®é€‰ä¸¾æ—¶é—´ï¼Œå³å¸Œæœ›è¯¥èŠ‚ç‚¹èƒ½åœ¨é€‰ä¸¾æ—¶é—´èŒƒå›´å†…å®Œæˆé€‰ä¸¾ï¼Œå¦åˆ™è®¤ä¸ºæ­¤æ¬¡é€‰ä¸¾å¤±è´¥ï¼›å¦‚æœèŠ‚ç‚¹çš„æ—¥å¿—ä¸å¤Ÿæ–°ï¼Œåˆ™å°†æ—¥å¿—åŒæ­¥è‡³æœ€æ–°ï¼Œå¦‚æœèŠ‚ç‚¹æ—¥å¿—è¶³å¤Ÿæ–°ï¼Œåˆ™å‘é€<code>MsgTimeoutNow</code>è‡³ç›®æ ‡èŠ‚ç‚¹ï¼Œç›®æ ‡èŠ‚ç‚¹æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ï¼Œåˆ™é©¬ä¸Šå¼€å§‹é€‰ä¸¾ã€‚<code>leader</code>åœ¨å¤„ç†<code>MsgTransferLeader</code>æ—¶ï¼Œç›´åˆ°é€‰ä¸¾è¶…æ—¶ä¹‹å‰ï¼Œä¸èƒ½å¤„ç†æ–°çš„<code>Propose</code>è¯·æ±‚ã€‚</p>
</li>
<li><p>ç”±<code>rawnode</code>çš„<code>ProposeConfChange</code>å‡½æ•°å‘èµ·<code>EntryConfChange</code>ç±»å‹çš„<code>Propose</code>è¯·æ±‚ï¼Œéœ€è¦ç»è¿‡raftå†…è¾¾æˆä¸€è‡´æ‰èƒ½å¯ç”¨ã€‚å…¶ä¸­çš„<code>PendingConfIndex</code>å˜é‡ç”¨æ¥æ ‡è¯†åœ¨logä¸­ä½†è¿˜æœªappliedçš„confï¼Œå®ƒéœ€è¦åœ¨å‘èµ·<code>Propose</code>æ—¶è¿›è¡Œè®°å½•ï¼ŒåŒæ—¶å½“å‰æ—¥å¿—çš„applied indexéœ€è¦å°äºè¿™ä¸ªæ—¥å¿—çš„indexï¼Œå¦åˆ™ä¿®æ”¹ç±»å‹ä¸º<code>EntryType_EntryNormal</code>ã€‚åŒæ—¶è¿™é‡Œè¿˜éœ€è¦ä¸€äº›ç®€å•çš„å‡½æ•°<code>addNode</code>å’Œ<code>deleteNode</code>ã€‚å…¶ä¸­ï¼Œå½“èŠ‚ç‚¹ä¸å­˜åœ¨æ—¶ï¼Œæ˜¯ä¸èƒ½å˜æˆleaderï¼Œéœ€è¦åšé€‰ä¸¾åˆ¤æ–­ã€‚</p>
</li>
</ol>
<h2 id="project3b"><a href="#project3b" class="headerlink" title="project3b"></a>project3b</h2><h3 id="ç›®æ ‡-1"><a href="#ç›®æ ‡-1" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><ol>
<li>Leaderæ”¹å˜ä¸confæ”¹å˜</li>
<li>ä¿®æ”¹Peer</li>
<li>regionçš„split</li>
</ol>
<h3 id="å®ç°ç»†èŠ‚-1"><a href="#å®ç°ç»†èŠ‚-1" class="headerlink" title="å®ç°ç»†èŠ‚"></a>å®ç°ç»†èŠ‚</h3><ol>
<li><p><code>TransferLeader</code>åªéœ€è¦åœ¨<code>Propose</code>çš„ç›´æ¥å¤„ç†å°±å¥½äº†ï¼Œä¸éœ€è¦è¿›å…¥ Raft Group è¾¾åˆ°ä¸€è‡´æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´æ”¹å‘½ä»¤åªè¦ç›´æ¥é€šè¿‡<code>RawNode</code>çš„<code>TransferLeader</code>å‘ç»™Leaderå°±å¥½äº†ï¼Œç„¶åè¿”å›callbackã€‚</p>
</li>
<li><p>å¯¹äº<code>ChangePeer</code>å‘½ä»¤çš„è¯é¦–å…ˆéœ€è¦åœ¨<code>Propose</code>ä¸­äº§ç”Ÿ<code>ConfChange</code>ï¼Œ</p>
<ul>
<li>ç›¸å¯¹äºæ™®é€šçš„<code>Propose</code>æ¥è¯´ï¼Œéœ€è¦åˆ¤æ–­å½“å‰åˆ é™¤çš„peeræ˜¯å¦æ˜¯leader, å¦‚æœä¸ºå½“å‰leaderåˆ™éœ€è¦é€šè¿‡<code>transferleader</code>ç»™regionå†…çš„ä»»æ„æˆå‘˜ï¼Œå¹¶ç›´æ¥è¿”å›ï¼›å¦‚æœä¸æ˜¯ï¼Œåªéœ€è¦æ›´æ”¹æœ€åçš„<code>Propose</code>ä¸º<code>ProposeConfChange</code>ï¼Œå…¶ä»–å’Œæ™®é€šproposeç›¸åŒã€‚</li>
<li><code>AddNode</code>ï¼šè®²peeråŠ å…¥åˆ°regionçš„Peersä¸­ï¼ŒåŒæ—¶åŠ å…¥åˆ°peerCacheä¸­ï¼›</li>
<li><code>RemoveNode</code>ï¼šå¦‚æœå½“å‰çš„peerå°±æ˜¯æ‰€åˆ é™¤çš„peerï¼Œå¯ä»¥è°ƒç”¨maybedestroyï¼Œç»§ç»­destoryï¼Œç„¶åè¿”å›ã€‚å¦‚æœä¸æ˜¯ï¼Œåˆ™éœ€è¦åœ¨regionä¸­çš„peerså’ŒPeerCacheåˆ é™¤ç›¸å…³æ•°æ®ã€‚</li>
<li>åˆ†åˆ«å¤„ç†ä¹‹åï¼Œéœ€è¦ä¸ºregionEpochä¸­çš„confverå˜æ›´å…¶ç‰ˆæœ¬ï¼Œå°†regionæŒä¹…åŒ–ï¼ŒåŒæ—¶è¿˜éœ€è¦ä¿®æ”¹storeMetaä¸­çš„regionsä¿¡æ¯ã€‚</li>
<li>éœ€è¦åœ¨peer applied snapshotçš„æ—¶å€™æ›´æ–°å…¶storeMetaä¸­çš„regionså’ŒregionRages</li>
<li>ä¹‹åå†è°ƒç”¨<code>ApplyConfChange</code>apply æ­¤æ¬¡conf change</li>
<li>å› ä¸ºå­˜åœ¨peerçš„æ·»åŠ ï¼Œä½†æ˜¯peerçš„createæ˜¯é€šè¿‡<code>maybeCreatePeer</code>ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡HeartBeatæ¥è§¦å‘<code>peer</code>çš„create</li>
<li>è¿”å›callback</li>
</ul>
</li>
<li><p>å¯¹äº<code>Split</code>å‘½ä»¤ï¼Œå®ƒçš„Proposeå’Œéadminçš„ç›¸åŒï¼Œä¸»è¦æ˜¯åˆ¤æ–­ä¸€ä¸‹SplitKeyæ˜¯å¦å­˜åœ¨å½“å‰çš„regionä¸­ã€‚å®ƒä¹Ÿéœ€è¦æ‰€æœ‰çš„raftè¾¾æˆä¸€è‡´åï¼Œåœ¨è¿›è¡Œå¤„ç†ã€‚å®ƒéœ€è¦å°†å½“å‰çš„region splitæ‰ï¼Œç»´æŒä¸¤ä¸ªregionï¼Œä¸€ä¸ªè€regionï¼ŒstartKeyä¸å˜ï¼ŒendKeyå˜æˆsplitKeyã€‚ä¸€ä¸ªæ–°regionï¼ŒstartKeyä¸ºsplitKeyï¼ŒendKeyä¸ºåŸè€regionçš„endKeyã€‚åŒæ—¶ï¼Œå¤§é‡æ¶‰åŠstoreMetaçš„ä¿®æ”¹ï¼š</p>
<ul>
<li>å¦‚æœåŸregionå†…çš„peeræ•°é‡å’ŒnewPeerIdsæ•°é‡ä¸åŒ¹é…ï¼Œåˆ™ç›´æ¥è¿”å›StaleCommand</li>
<li>storeMetaåˆ é™¤åŸæœ‰çš„regionå’ŒregionRangesç›¸å…³ä¿¡æ¯</li>
<li>æ„å»ºä¸€ä¸ªæ–°regionï¼šRegionEpochåˆå§‹åŒ–ä¸º(InitEpochConfVer,InitEpochVer), æœ¬èº«splitä»…æœ‰newPeerIdï¼Œæ‰€ä»¥éœ€è¦å’Œstoreè¿›è¡Œç»‘å®šï¼Œéœ€è¦ç»‘å®šå¯¹åº”storeä¸Šçš„db store id</li>
<li>åˆ›å»ºæ–°peeræ—¶éœ€è¦æ³¨æ„ï¼Œæœ¬regionçš„peerå¯èƒ½å·²ç»ç”±å…¶ä»–store sendçš„æ¶ˆæ¯æ¿€æ´»åˆ›å»ºï¼Œæ‰€ä»¥éœ€è¦åˆ¤æ–­peeræ˜¯å¦å­˜åœ¨ã€‚è‹¥ä¸å­˜åœ¨ï¼Œé€šè¿‡<code>CreatePeer</code>åˆ›å»ºæ–°peer,åŒæ—¶æ³¨å†Œåˆ°routerä¸­ï¼Œåˆå§‹åŒ–Peer</li>
<li>æ›´æ–°è€regionçš„EndKeyï¼ŒRegionEpochçš„Version</li>
<li>å°†Storemetaä¸­çš„regionsä¸regionRangesè¿›è¡Œæ›´æ–°</li>
<li>æŒä¹…åŒ–regionä¿¡æ¯</li>
<li>è¿”å›callback</li>
</ul>
</li>
</ol>
<h2 id="project3c"><a href="#project3c" class="headerlink" title="project3c"></a>project3c</h2><h3 id="ç›®æ ‡-2"><a href="#ç›®æ ‡-2" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><ol>
<li>é€šè¿‡heartbeatçš„ä¿¡æ¯ï¼Œæ›´æ–°schedulerä¸­çš„çŠ¶æ€</li>
<li>å®ç°region balance scheduler</li>
</ol>
<h3 id="ç»†èŠ‚"><a href="#ç»†èŠ‚" class="headerlink" title="ç»†èŠ‚"></a>ç»†èŠ‚</h3><ol>
<li><p>å¯¹äºèƒ½å¤Ÿåœ¨clusteræ‰¾åˆ°çš„regionï¼Œå…ˆæŸ¥çœ‹æ”¶åˆ°çš„regionä¿¡æ¯ä¸­çš„confverå’Œversionæ˜¯å¦æœ‰è½åï¼Œå¦‚æœè½åç›´æ¥è¿”å›Staleã€‚ä¸æ˜¯æ‰€æœ‰çš„æƒ…å†µéƒ½éœ€è¦æ›´æ–°regionä¿¡æ¯ï¼Œå½“ä¸€ä¸‹5ç§æƒ…å†µéƒ½æ»¡è¶³æ—¶å¯ä»¥è·³è¿‡ï¼š confverå’Œversionæ²¡æœ‰å˜åŒ–ï¼Œleaderæœªå˜åŒ–ï¼Œpendingpeerä¸ºç©ºï¼ŒApproximateSizeæ²¡æœ‰å˜åŒ–ï¼Œpeeræ²¡æœ‰å˜åŒ–ã€‚å¯¹äºä¸èƒ½å¤Ÿæ‰¾åˆ°çš„regionï¼ŒæŸ¥è¯¢å…¶åŒ…å«å…¶keyèŒƒå›´çš„regionï¼Œéå†æ‰€æœ‰çš„regionï¼Œå¦‚æœregionä¿¡æ¯ä¸­çš„confverå’Œversionæœ‰è½åï¼Œåˆ™ç›´æ¥è¿”å›staleã€‚å…¶ä»–æƒ…å†µæ­£å¸¸æ›´æ–°regionå’Œstore</p>
</li>
<li><p>å…ˆæŸ¥æ‰¾éœ€è¦ä¸”åˆé€‚çš„storeæ¥ç§»åŠ¨regionï¼Œéœ€è¦store ä¸º<code>up</code>ä¸”<code>DonwTime</code>ä¸èƒ½è¶…è¿‡<code>MaxStoreDownTime</code>ï¼›ç„¶åæ ¹æ®ä»–ä»¬çš„reigon size ä»å¤§åˆ°å°è¿›è¡Œæ’åºï¼›æŒ‰é¡ºåºä»storeä¸­æŸ¥æ‰¾åˆé€‚çš„regionï¼ŒæŒ‰é¡ºåºä»<code>GetPendingRegionsWithLock</code><br><code>GetFollowersWithLock</code> å’Œ <code>GetLeadersWithLock</code> è‹¥æ‰¾åˆ°ä¸€ä¸ªç›´æ¥è·³æŸ¥æ‰¾ï¼›æ£€æŸ¥regionå½“å‰çš„çŠ¶æ€æ˜¯å¦ç¬¦åˆç§»åŠ¨ï¼›ç„¶åä»æ‰€æœ‰æœªåœ¨è¯¥regionä¸­çš„storeä¸­æŸ¥æ‰¾æœ€å°region sizeçš„storeï¼›æ£€æŸ¥ä¸¤ä¸ªstore region sizeæ˜¯å¦æ»¡è¶³ç§»åŠ¨ï¼›ç”Ÿæˆæ–°peer,åˆ›å»ºop</p>
</li>
</ol>
]]></content>
      <categories>
        <category>åˆ†å¸ƒå¼</category>
      </categories>
      <tags>
        <tag>tinykv</tag>
        <tag>raft</tag>
      </tags>
  </entry>
  <entry>
    <title>Talent plan Tinykv | project4 | Transaction</title>
    <url>/talent-plan-tinykv-project4/</url>
    <content><![CDATA[<h1 id="Project4"><a href="#Project4" class="headerlink" title="Project4"></a>Project4</h1><h2 id="Project4a"><a href="#Project4a" class="headerlink" title="Project4a"></a>Project4a</h2><h4 id="å®éªŒç›®çš„"><a href="#å®éªŒç›®çš„" class="headerlink" title="å®éªŒç›®çš„"></a>å®éªŒç›®çš„</h4><p>å®ç°å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶</p>
<h4 id="å®éªŒæ€è·¯"><a href="#å®éªŒæ€è·¯" class="headerlink" title="å®éªŒæ€è·¯"></a>å®éªŒæ€è·¯</h4><p>æœ¬éƒ¨åˆ†å®ç°ä¸€ä¸ªå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶(MVCC)ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯åœ¨åº•å±‚DBå­˜å‚¨å¤šä¸ªç‰ˆæœ¬çš„KVã€‚</p>
<p>åœ¨æœ¬æ¬¡å®éªŒä¸­ï¼Œåº•å±‚æœ‰ä¸‰ä¸ªåˆ—æ—ï¼Œ<code>default</code>ä¿å­˜æ•°æ®ï¼Œ<code>lock</code>å­˜å‚¨é”ï¼Œ<code>write</code>è®°å½•æ›´æ”¹çš„æ“ä½œã€‚<code>lock</code>ä½¿ç”¨keyè®¿é—®ï¼Œ<code>default</code>åˆ©ç”¨keyå’Œè¢«å†™å…¥çš„äº‹åŠ¡çš„æ—¶é—´æˆ³è®¿é—®ï¼Œ<code>write</code>åˆ©ç”¨keyå’Œäº‹åŠ¡è¢«æäº¤æ—¶å†™å…¥çš„æ—¶é—´æˆ³è®¿é—®ã€‚</p>
<p>åœ¨æœ¬æ¬¡å®éªŒä¸­ï¼Œæˆ‘ä»¬éœ€è¦å®Œæˆgetã€deleteã€writeæ•°æ®å’Œé”çš„å‡½æ•°ï¼Œä»¥åŠ<code>CurrentWrite()</code>è¿”å›å½“å‰äº‹åŠ¡commitçš„å†™å…¥ï¼Œ<code>MostRecentWrite()</code>è¿”å›ç»™å®škeyçš„æœ€è¿‘ä¸€æ¬¡commitã€‚</p>
<p>éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹;</p>
<ol>
<li><p>deleteå’Œwriteæ“ä½œï¼Œéœ€è¦å°†æ“ä½œå°è£…ä¸º<code>storage.Modify</code>ï¼Œç„¶åé™„åŠ åˆ°<code>txn.writes</code>æ•°ç»„ä¸­</p>
</li>
<li><p><code>GetValue</code>é¦–å…ˆä»<code>write</code>åˆ—æ—ä¸­ï¼Œå¯»æ‰¾å‡ºè·ç¦»æ­¤äº‹åŠ¡æœ€è¿‘çš„ç‰ˆæœ¬çš„commitï¼Œç„¶åä»DBä¸­è¯»å–åˆ°æ­¤å†™å…¥çš„å¼€å§‹æ—¶é—´æˆ³ï¼Œå†ä»<code>default</code>åˆ—æ—è¯»å–æ•°æ®</p>
</li>
</ol>
<h2 id="Project4b"><a href="#Project4b" class="headerlink" title="Project4b"></a>Project4b</h2><h4 id="å®éªŒç›®çš„-1"><a href="#å®éªŒç›®çš„-1" class="headerlink" title="å®éªŒç›®çš„"></a>å®éªŒç›®çš„</h4><p>åˆ©ç”¨project4aå®ç°çš„mvccï¼Œå®Œæˆ<code>KvGet</code>ï¼Œ<code>KvPrewrite</code>å’Œ<code>KvCommit</code>å‡½æ•°ã€‚</p>
<h4 id="å®éªŒæ€è·¯-1"><a href="#å®éªŒæ€è·¯-1" class="headerlink" title="å®éªŒæ€è·¯"></a>å®éªŒæ€è·¯</h4><p><code>KvGet</code>é¦–å…ˆåˆ©ç”¨è¯·æ±‚ä¿¡æ¯ï¼Œåˆ›å»ºä¸€ä¸ª<code>mvccTxn</code>å¯¹è±¡ï¼Œå†åˆ¤æ–­keyæœ‰æ²¡æœ‰ä¸Šé”ï¼Œå¦‚æœæ£€æµ‹åˆ°keyè¢«å…¶ä»–äº‹åŠ¡é”ä½ï¼Œåˆ™è¿”å›<code>KeyError</code>ã€‚ç„¶åå†åˆ©ç”¨<code>GetValue</code>è·å–å€¼ã€‚</p>
<p><code>KvPrewrite</code>æ—¶ï¼Œéœ€è¦å¯¹è¯·æ±‚ä¸­çš„keyï¼Œè·³è¿‡é‚£äº›å·²ç»è¢«lockå’Œå·²ç»è¢«æ›´æ™šçš„äº‹åŠ¡commitçš„keyã€‚ç„¶ååˆ©ç”¨mvccä¸­çš„å‡½æ•°ï¼Œå†™å…¥æ•°æ®å¹¶ä¸Šé”ã€‚</p>
<p><code>KvCommit</code>éœ€è¦åˆ¤æ–­<code>lock</code>åˆ—æ—çš„é”æ—¶é—´æˆ³æ˜¯å¦ä¸å½“å‰äº‹åŠ¡çš„å†™å…¥æ—¶é—´ä¸€è‡´ï¼Œä¸€è‡´çš„æƒ…å†µä¸‹ï¼Œä»DBä¸­åˆ é™¤æ­¤é”ï¼Œå¹¶å†<code>write</code>åˆ—æ—è®°å½•commitã€‚</p>
<h2 id="Project4c"><a href="#Project4c" class="headerlink" title="Project4c"></a>Project4c</h2><h4 id="å®éªŒç›®çš„-2"><a href="#å®éªŒç›®çš„-2" class="headerlink" title="å®éªŒç›®çš„"></a>å®éªŒç›®çš„</h4><p>å®ç°<code>KvScan</code>ï¼Œ<code>KvCheckTxnStatus</code>ï¼Œ<code>KvBatchRollback</code>å’Œ<code>KvResolveLock</code>ï¼Œä»¥åŠ<code>scanner.go</code>ã€‚</p>
<h4 id="å®éªŒæ€è·¯-2"><a href="#å®éªŒæ€è·¯-2" class="headerlink" title="å®éªŒæ€è·¯"></a>å®éªŒæ€è·¯</h4><p><code>scanner.go</code>æ˜¯<code>KvScan</code>çš„ä¸€ä¸ªåº•å±‚ï¼Œå®ƒç”¨æ¥è¿­ä»£DBï¼Œè¿”å›å¯¹åº”çš„keyå’Œvalueã€‚<code>KvScan</code>åˆ©ç”¨<code>scanner</code>å¯¹è±¡ï¼Œä»DBä¸­Scanæ•°æ®ã€‚</p>
<p><code>KvCheckTxnStatus</code> æ£€æŸ¥è¶…æ—¶ï¼Œåˆ é™¤è¿‡æœŸçš„é”å¹¶å›æ»šï¼Œä½†æ˜¯å¦‚æœå‘ç°<code>MostRecentWrite</code>çš„äº‹åŠ¡ä¸ºå›æ»šäº‹åŠ¡æˆ–commitæ—¶é—´å¤§äºå½“å‰lockçš„æ—¶é—´ï¼Œé‚£ä¹ˆè¯´æ˜ç°æœ‰çš„é”ä¸ºæ–°äº‹åŠ¡çš„é”ï¼Œç›´æ¥è¿”å›ã€‚</p>
<p><code>KvBatchRollback</code>å¯¹æ‰€æœ‰éœ€è¦å›æ»šçš„keyï¼Œå¦‚æœå‘ç°<code>MostRecentWrite</code>çš„äº‹åŠ¡ä¸ºå›æ»šäº‹åŠ¡æˆ–commitæ—¶é—´å¤§äºå½“å‰æ—¶é—´æˆ³ï¼Œè¯´æ˜å·²ç»å›æ»šã€‚å›æ»šæ—¶éœ€è¦ä»<code>lock</code>åˆ—æ—åˆ é™¤é”ï¼Œä»<code>default</code>åˆ é™¤keyçš„valueï¼Œè¿˜éœ€è¦ä»<code>write</code>åˆ—æ—å†™å…¥å›æ»šæ“ä½œã€‚</p>
<p><code>KvResolveLock</code>é¦–å…ˆæ£€æŸ¥keyçš„lockæ˜¯å¦å­˜åœ¨ï¼Œç„¶åæŒ‰ç…§è¯·æ±‚ï¼Œè°ƒç”¨<code>KvBatchRollback</code>æˆ–<code>KvCommit</code>å‡½æ•°å®Œæˆå›æ»šæˆ–commitæ“ä½œã€‚</p>
]]></content>
      <categories>
        <category>åˆ†å¸ƒå¼</category>
      </categories>
      <tags>
        <tag>tinykv</tag>
        <tag>raft</tag>
      </tags>
  </entry>
  <entry>
    <title>virtualenvwarpperå®‰è£…ä¸é…ç½®</title>
    <url>/virtualenvwrapper/</url>
    <content><![CDATA[<h1 id="Virtualenvwrapper"><a href="#Virtualenvwrapper" class="headerlink" title="Virtualenvwrapper"></a>Virtualenvwrapper</h1><p><code>virtualenvwarpper</code>ä¸€èˆ¬ç”¨ä½œ<code>python</code>ç®¡ç†ä¸åŒçš„envã€‚æŠŠ<code>virtualenv</code>æ‹“å±•ä¹‹åï¼Œç”¨èµ·æ¥æ›´åŠ ç®€å•æ–¹ä¾¿</p>
<ol>
<li>å¯ä»¥å°†æ‰€æœ‰è™šæ‹Ÿç¯å¢ƒç¯å¢ƒæ”¾åœ¨ä¸€ä¸ªç›®å½•ä¸‹ï¼Œæ–¹ä¾¿ç®¡ç†</li>
<li>åˆ‡æ¢è™šæ‹Ÿç¯å¢ƒè¾ƒä¸ºæ–¹ä¾¿</li>
<li>ç®¡ç†è™šæ‹Ÿç¯å¢ƒæ¯”è¾ƒæ–¹ä¾¿</li>
</ol>
<h1 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip3 install virtualenvwrapper</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç›®å½•ç”¨æ¥å­˜æ”¾è™šæ‹Ÿç¯å¢ƒ</span></span><br><span class="line">mkdir ~/.virtualenvs</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨.bashrcä¸­æ·»åŠ </span></span><br><span class="line"><span class="comment">## æŒ‡å®šPYTHON ç‰ˆæœ¬</span></span><br><span class="line">VIRTUALENVWRAPPER_PYTHON=/usr/bin/python3</span><br><span class="line"><span class="built_in">export</span> WORKON_HOME=~/.virtualenvs</span><br><span class="line"><span class="built_in">source</span> /usr/<span class="built_in">local</span>/bin/virtualenvwrapper.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡Œ</span></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>
<ul>
<li>workon [è™šæ‹Ÿç¯å¢ƒåç§°]:åˆ‡æ¢è™šæ‹Ÿç¯å¢ƒ</li>
<li>lsvirtualenv:åˆ—å‡ºå·²æœ‰çš„è™šæ‹Ÿç¯å¢ƒåˆ—è¡¨</li>
<li>mkvirtualenv :æ–°å»ºè™šæ‹Ÿç¯å¢ƒ</li>
<li>rmvirtualenv :åˆ é™¤è™šæ‹Ÿç¯å¢ƒ</li>
<li>deactivate: ç¦»å¼€å·²è¿›å…¥çš„è™šæ‹Ÿç¯å¢ƒ</li>
</ul>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>virtualenv</tag>
      </tags>
  </entry>
  <entry>
    <title>wsl2ç¯å¢ƒé…ç½®+docker+wt+vscode</title>
    <url>/wsl2-wt-zsh-docker/</url>
    <content><![CDATA[<h2 id="åºè¨€"><a href="#åºè¨€" class="headerlink" title="åºè¨€"></a>åºè¨€</h2><p>æœ€è¿‘æ–°æ¢çš„ç”µè„‘åˆåäº†ï¼Œæ‹¿å›æ¥è¿˜å¾—é‡æ–°é…ç½®ç¯å¢ƒï¼Œè¿˜å¾—æŒ¨ä¸ªæ‰¾æ•™ç¨‹è¿›è¡Œé…ç½®ã€‚è¿™æ¬¡å°±ç®€å•åœ°å…¨å†™ä¸€èµ·å§ã€‚</p>
<p>ä½œä¸º<code>wsl</code>çš„å¿ å®çˆ±å¥½è€…ï¼Œæˆ‘å·²ç»ä½¿ç”¨äº†<code>wsl</code>ä¸¤å¹´äº†ï¼Œç›¸æ¯”è™šæ‹Ÿæœºæ¥è¯´ï¼Œå®åœ¨æ˜¯ä¸è¦æ–¹ä¾¿å¤ªå¤šäº†ï¼Œè€Œä¸”é…ç½®è¦æ±‚ä¹Ÿæ²¡è¿™ä¹ˆé«˜ã€‚</p>
<p>ä¹‹å‰<code>windows</code> å•†åº—ä¹Ÿå‘å¸ƒäº†<code>wt</code>(<code>windows terminal</code>)ï¼Œç›¸æ¯”<code>cmd</code>å’Œ<code>powershell</code>ä»¥åŠåŸæœ¬<code>bash</code>æ¼‚äº®å¤ªå¤šäº†ï¼Œè€Œä¸”é›†æˆäº†å¤šä¸ªçª—å£ï¼Œåˆ‡æ¢å¾ˆæ–¹ä¾¿ã€‚</p>
<p>è¿™æ˜¯æˆ‘ç°åœ¨çš„ç•Œé¢ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±å®šä¹‰å…¶ä»–çš„å¤–è§‚ç­‰ç­‰ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/wsl2-wt-zsh-docker-overview.png" alt="overview"></p>
<p>æœ€è¿‘çœ‹äº†ä¸€ä¸‹ï¼Œå±…ç„¶<code>wsl2</code>å·²ç»å‡ºå¥½ä¹…äº†ï¼Œè¿˜æ”¯æŒ<code>docker</code>ã€‚æˆ‘å±…ç„¶æ‰çŸ¥é“ï¼Œæˆ‘æƒ³äº†æƒ³é‚£æ—¶æˆ‘åº”è¯¥åœ¨å‡†å¤‡è€ƒç ”ï¼Œemmm ã€‚å¥½äº†ï¼ŒåºŸè¯ä¸å¤šè¯´æˆ‘ä»¬å¼€å§‹é…ç½®ã€‚</p>
<p>å¦å¤–è¯´ä¸€å¥ï¼Œ<code>wsl2</code>è¿˜æ²¡æœ‰æ¨é€åˆ°æ­£å¼ç‰ˆçš„<code>windows 10</code>ä¸­ï¼Œç›®å‰è¿˜æ˜¯åœ¨<code>windows</code>çš„æµ‹è¯•ç‰ˆä¸­ã€‚</p>
<a id="more"></a>
<h3 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="headerlink" title="å¯¹æ¯”"></a>å¯¹æ¯”</h3><p><a href="https://docs.microsoft.com/zh-cn/windows/wsl/compare-versions" target="_blank" rel="noopener">æ¯”è¾ƒ WSL 2 å’Œ WSL 1</a></p>
<p><code>wsl1</code>å’Œ<code>wsl2</code>åº•å±‚æ¶æ„ä¸åŒï¼Œæ‰€ä»¥<code>wsl2</code>èƒ½ç›¸æ¯”<code>wsl1</code>æ›´å¤šçš„å®ç°ä¸€äº›<code>linux</code>å†…çš„åŠŸèƒ½ã€‚åŒ…æ‹¬è¿™æ¬¡çš„<code>docker</code>ï¼ŒåŒæ—¶åœ¨<code>windows 10</code>æœ€æ–°çš„æµ‹è¯•ç‰ˆä¸­å·²ç»æä¾›äº†GPUè®¡ç®—ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªå·±å‡åˆ°æœ€æ–°çš„ç‰ˆæœ¬ä½¿ç”¨ã€‚</p>
<h2 id="å¼€å§‹é…ç½®"><a href="#å¼€å§‹é…ç½®" class="headerlink" title="å¼€å§‹é…ç½®"></a>å¼€å§‹é…ç½®</h2><h3 id="æ›´æ–°windows-10"><a href="#æ›´æ–°windows-10" class="headerlink" title="æ›´æ–°windows 10"></a>æ›´æ–°windows 10</h3><p><code>wsl2</code>åªæœ‰åœ¨<code>windows 10</code>ç‰ˆæœ¬2004çš„å†…éƒ¨ç‰ˆæœ¬19041æˆ–è€…æ›´é«˜çš„ç‰ˆæœ¬ä¸­æœ‰æä¾› </p>
<ul>
<li>ä½ å¯ä»¥<code>win+R</code>ä¸­è¾“å…¥<code>winver</code>ä¸­æŸ¥çœ‹windowsçš„ç‰ˆæœ¬<ul>
<li><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/wsl2-wt-zsh-docker-winver.png" alt="winver"></li>
</ul>
</li>
<li>å¦‚æœä½ çš„ç‰ˆæœ¬æ²¡æœ‰è¾¾åˆ°è¦æ±‚çš„è¯ï¼Œä½ å¯ä»¥å…ˆè¯•å›¾é€šè¿‡windows 10çš„ç³»ç»Ÿæ›´æ–°ã€‚</li>
<li>å¦‚æœä¾æ—§æ²¡è¾¾åˆ°ç‰ˆæœ¬è¦æ±‚çš„è¯ï¼š<ul>
<li>åŠ å…¥å¾®è½¯çš„<code>windows é¢„è§ˆä½“é™¢è®¡åˆ’</code>ï¼Œå¹¶é€‰æ‹©Betaæ¸ é“</li>
<li><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/wsl2-wt-zsh-docker-preview.png" alt="preview"></li>
<li>è¿›è¡Œwindows 10çš„ç³»ç»Ÿæ›´æ–°</li>
</ul>
</li>
</ul>
<h3 id="ç³»ç»Ÿè®¾ç½®"><a href="#ç³»ç»Ÿè®¾ç½®" class="headerlink" title="ç³»ç»Ÿè®¾ç½®"></a>ç³»ç»Ÿè®¾ç½®</h3><h4 id="å¦‚æœä½ æ²¡æœ‰å®‰è£…è¿‡wsl"><a href="#å¦‚æœä½ æ²¡æœ‰å®‰è£…è¿‡wsl" class="headerlink" title="å¦‚æœä½ æ²¡æœ‰å®‰è£…è¿‡wsl"></a>å¦‚æœä½ æ²¡æœ‰å®‰è£…è¿‡wsl</h4><p>é‚£ä¹ˆï¼Œä½ å¿…é¡»å…ˆå¯ç”¨<code>é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿ</code>åŠŸèƒ½ã€‚</p>
<p>ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€ PowerShell å¹¶è¿è¡Œï¼š</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">dism.exe /online /<span class="built_in">enable-feature</span> /featurename:Microsoft<span class="literal">-Windows</span><span class="literal">-Subsystem</span><span class="literal">-Linux</span> /all /norestart</span><br></pre></td></tr></table></figure>
<p>å¹¶é‡å¯ç”µè„‘</p>
<h4 id="å¦‚æœä½ å®‰è£…è¿‡wsl"><a href="#å¦‚æœä½ å®‰è£…è¿‡wsl" class="headerlink" title="å¦‚æœä½ å®‰è£…è¿‡wsl"></a>å¦‚æœä½ å®‰è£…è¿‡wsl</h4><p>å®‰è£… WSL 2 ä¹‹å‰ï¼Œå¿…é¡»å¯ç”¨<code>è™šæ‹Ÿæœºå¹³å°</code>åŠŸèƒ½ã€‚</p>
<p>ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€ PowerShell å¹¶è¿è¡Œï¼š</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">dism.exe /online /<span class="built_in">enable-feature</span> /featurename:VirtualMachinePlatform /all /norestart</span><br></pre></td></tr></table></figure>
<p>é‡æ–°å¯åŠ¨è®¡ç®—æœºï¼Œä»¥å®Œæˆ WSL å®‰è£…å¹¶æ›´æ–°åˆ° WSL 2ã€‚</p>
<h4 id="å°†wsl2è®¾ç½®ä¸ºé»˜è®¤ç‰ˆæœ¬"><a href="#å°†wsl2è®¾ç½®ä¸ºé»˜è®¤ç‰ˆæœ¬" class="headerlink" title="å°†wsl2è®¾ç½®ä¸ºé»˜è®¤ç‰ˆæœ¬"></a>å°†wsl2è®¾ç½®ä¸ºé»˜è®¤ç‰ˆæœ¬</h4><p>åœ¨powershellä¸­è¾“å…¥ï¼š<br><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">wsl -<span class="literal">-set</span><span class="literal">-default</span><span class="literal">-version</span> <span class="number">2</span></span><br></pre></td></tr></table></figure></p>
<p>ä½ å¯èƒ½ä¼šé‡åˆ°é”™è¯¯ä¿¡æ¯ï¼š<code>WSL 2 requires an update to its kernel component. For information please visit https://aka.ms/wsl2kernel</code><br>è¯·å®‰è£…<a href="https://aka.ms/wsl2kernel" target="_blank" rel="noopener">wsl2kernel</a>ã€‚</p>
<h4 id="wsl1-to-wsl2"><a href="#wsl1-to-wsl2" class="headerlink" title="wsl1 to wsl2"></a>wsl1 to wsl2</h4><p>å…ˆæŸ¥çœ‹wslçš„ç‰ˆæœ¬ä¿¡æ¯<br><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">wsl -<span class="literal">-list</span> -<span class="literal">-verbose</span></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">wsl <span class="literal">-l</span> <span class="literal">-v</span></span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœä½ æ˜¯ç‰ˆæœ¬1çš„è¯ï¼Œåˆ‡æ¢è‡³ç‰ˆæœ¬2<br><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">wsl -<span class="literal">-set</span><span class="literal">-version</span> &lt;distro<span class="literal">-name</span>&gt; <span class="number">2</span></span><br><span class="line"><span class="comment"># in my case</span></span><br><span class="line">wsl -<span class="literal">-set</span><span class="literal">-version</span> Ubuntu <span class="number">2</span></span><br></pre></td></tr></table></figure></p>
<p>ä»wsl1åˆ‡æ¢åˆ°wsl2å¯èƒ½ä¼šæœ‰é”™è¯¯ï¼Œå¯èƒ½è¿™èƒ½å¤Ÿè§£å†³<a href="https://docs.microsoft.com/zh-cn/windows/wsl/install-legacy#uninstallingremoving-the-legacy-distro" target="_blank" rel="noopener">å¸è½½å¹¶åˆ é™¤ä»»ä½•æ—§åˆ†å‘</a></p>
<h3 id="å®‰è£…-linux-å‘è¡Œç‰ˆä¸-windows-terminal"><a href="#å®‰è£…-linux-å‘è¡Œç‰ˆä¸-windows-terminal" class="headerlink" title="å®‰è£… linux å‘è¡Œç‰ˆä¸ windows terminal"></a>å®‰è£… linux å‘è¡Œç‰ˆä¸ windows terminal</h3><p>åœ¨<code>Microsoft Store</code>æœç´¢<code>windows terminal</code>ä¸æƒ³è¦çš„<code>linux</code> å‘è¡Œç‰ˆ</p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/wsl2-wt-zsh-docker-windows-terminal.png" alt="windows-ternimal"></p>
<p>ä½ å¯ä»¥æœç´¢ä½ æƒ³è¦çš„ linux å‘è¡Œç‰ˆï¼ŒåŸºæœ¬ä¸Šéƒ½æœ‰<br><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/wsl2-wt-zsh-docker-disto.png" alt="disto"></p>
<ul>
<li>Ubuntu 16.04 LTS</li>
<li>Ubuntu 18.04 LTS</li>
<li>Ubuntu 20.04 LTS</li>
<li>openSUSE Leap 15.1</li>
<li>SUSE Linux Enterprise Server 12 SP5</li>
<li>SUSE Linux Enterprise Server 15 SP1</li>
<li>Kali Linux</li>
<li>Debian GNU/Linux</li>
<li>Fedora Remix for WSL</li>
<li>Pengwin</li>
<li>Pengwin Enterprise</li>
<li>Alpine WSL</li>
</ul>
<h3 id="linuxç¯å¢ƒé…ç½®"><a href="#linuxç¯å¢ƒé…ç½®" class="headerlink" title="linuxç¯å¢ƒé…ç½®"></a>linuxç¯å¢ƒé…ç½®</h3><p>æˆ‘å®‰è£…çš„æ˜¯<code>ubuntu18.04</code>ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥çš„æµç¨‹éƒ½åœ¨è¯¥å‘è¡Œç‰ˆä¸‹è¿›è¡Œã€‚</p>
<p>åœ¨ä½¿ç”¨<code>wt</code>ä¸­ä½¿ç”¨å‘è¡Œç‰ˆæ—¶ï¼Œå…ˆå¯åŠ¨è¯¥å‘è¡Œç‰ˆå®Œæˆé¢„å®‰è£…å’Œé¢„é…ç½®ã€‚å®Œæˆå®‰è£…ä¹‹åä¾¿å¯ä»¥é€šè¿‡<code>win+r</code>è¾“å…¥<code>wt</code>ï¼Œæ‰“å¼€<code>windows ternimal</code>ç‚¹å‡»<code>+</code>å·é€‰æ‹©ä½ å®‰è£…çš„å‘è¡Œç‰ˆï¼Œå°±å¯ä»¥äº†ï¼Œ<code>wt</code>çš„é…ç½®æˆ‘ä¼šåœ¨åé¢è´´å‡ºã€‚</p>
<h4 id="æ¢æº"><a href="#æ¢æº" class="headerlink" title="æ¢æº"></a>æ¢æº</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class="line">sudo vim /etc/apt/sources.list</span><br></pre></td></tr></table></figure>
<p>æ¸…ç©ºé‡Œé¢æ‰€æœ‰å†…å®¹ï¼Œæ¢å…¥å›½å†…æºã€‚</p>
<p>ä¾‹å¦‚é˜¿é‡Œæºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic main restricted universe multiverse</span><br><span class="line">deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-security main restricted universe multiverse</span><br><span class="line">deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-updates main restricted universe multiverse</span><br><span class="line">deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-proposed main restricted universe multiverse</span><br><span class="line">deb http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-backports main restricted universe multiverse</span><br><span class="line">deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic main restricted universe multiverse</span><br><span class="line">deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-security main restricted universe multiverse</span><br><span class="line">deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-updates main restricted universe multiverse</span><br><span class="line">deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-proposed main restricted universe multiverse</span><br><span class="line">deb-src http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu&#x2F; bionic-backports main restricted universe multiverse</span><br></pre></td></tr></table></figure>
<p>æ›´æ–°sourceåŒ…ï¼Œå®‰è£…æ›´æ–°ï¼Œå¼€å‘åŸºç¡€å†…å®¹åŒ…<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br><span class="line">sudo apt-get install build-essential</span><br></pre></td></tr></table></figure></p>
<h4 id="zsh"><a href="#zsh" class="headerlink" title="zsh"></a>zsh</h4><p>å°†zshæ›¿ä»£bash<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install zsh <span class="comment"># å®‰è£…zsh</span></span><br></pre></td></tr></table></figure></p>
<p>æ›´æ”¹é»˜è®¤çš„shell<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chsh -s $(<span class="built_in">which</span> zsh)</span><br></pre></td></tr></table></figure></p>
<p>ä¸‹æ¬¡å†æ‰“å¼€åˆ†å‘ç‰ˆæ—¶é»˜è®¤å°±æ˜¯zsh</p>
<h4 id="Oh-My-ZSH"><a href="#Oh-My-ZSH" class="headerlink" title="Oh My ZSH"></a>Oh My ZSH</h4><p><code>oh my zsh</code>æ˜¯ä¸€ä¸ªå¼€æºçš„ç¤¾åŒºé©±åŠ¨çš„æ¡†æ¶ï¼Œç”¨äºç®¡ç†zshé…ç½®ã€‚</p>
<p>ä¸‹è½½å®‰è£…ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sh -c &quot;$(curl -fsSL https:&#x2F;&#x2F;raw.github.com&#x2F;ohmyzsh&#x2F;ohmyzsh&#x2F;master&#x2F;tools&#x2F;install.sh)&quot;</span><br></pre></td></tr></table></figure></p>
<p>zshçš„é…ç½®æ–‡ä»¶åœ¨<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim ~&#x2F;.zshrc</span><br></pre></td></tr></table></figure></p>
<p>å¯ä»¥æ›´æ”¹ä¸»é¢˜</p>
<figure class="highlight zsh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤ä¸»é¢˜</span></span><br><span class="line">ZSH_THEME=<span class="string">"robbyrussell"</span></span><br><span class="line"><span class="comment"># æ–°ä¸»é¢˜</span></span><br><span class="line">ZSH_THEME=<span class="string">"agnoster"</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å®‰è£…æ’ä»¶<code>Syntax Highlighting</code>, <code>Auto Suggestions</code><br>åˆ†åˆ«æ˜¯è¯­æ³•é«˜äº®å’Œè‡ªåŠ¨è¡¥é½</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir ~/.zsh</span><br><span class="line"><span class="built_in">cd</span> ~/.zsh</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-syntax-highlighting.git</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions.git</span><br></pre></td></tr></table></figure>
<p>åŒæ—¶<code>wt</code>é‡Œé¢æ–‡ä»¶å¤¹åæ¯”è¾ƒä¸‘ï¼Œä¸‹è½½<code>dircolors</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">curl https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;seebi&#x2F;dircolors-solarized&#x2F;master&#x2F;dircolors.ansi-dark --output ~&#x2F;.dircolors</span><br></pre></td></tr></table></figure>
<p>ç„¶å<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim ~/.zshrc</span><br></pre></td></tr></table></figure></p>
<p>åœ¨æœ«å°¾åŠ ä¸Š<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.zsh/zsh-autosuggestions/zsh-autosuggestions.zsh</span><br><span class="line"><span class="built_in">source</span> ~/.zsh/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh </span><br><span class="line"><span class="built_in">eval</span> `dircolors ~/.dircolors`</span><br></pre></td></tr></table></figure><br>è¿™æ ·çš„è¯åœ¨æ¯ä¸€æ¬¡å¼€å¯ç»ˆç«¯ï¼Œéƒ½ä¼šå¯ç”¨æ’ä»¶</p>
<h4 id="proxychains"><a href="#proxychains" class="headerlink" title="proxychains"></a>proxychains</h4><p>åœ¨wsl2ä¸­çš„ç½‘ç»œæœ‰äº†æ–°çš„å˜åŒ–ï¼Œç³»ç»Ÿä¼šç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿç½‘å¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨windowsä¸Šä¼šå¤šä¸€ä¸ªç½‘å¡ï¼Œä¸”Ipæ˜¯å˜åŒ–çš„ã€‚</p>
<p>æ‰€ä»¥åœ¨linuxä¸­å®ƒçš„<code>hosts</code>æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ã€æ²¿è¢­åŸæœ¬windowså†…å®¹çš„<code>hosts</code>ï¼Œ<code>nameserver</code>ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p>
<p>æ‰€ä»¥windowä¸Šçš„å°é£æœºæ˜¯æ— æ³•ç›´æ¥ç»™<code>wsl2</code>ä½¿ç”¨çš„ï¼Œä½†æ˜¯å°é£æœºå¯ä»¥èµ°æœ¬åœ°ç«¯å£ä»£ç†ã€‚</p>
<p>è€Œproxychainså°±æ˜¯è¿™æ ·ä»¥ä¸€ä¸ªå·¥å…·å¯ä»¥åˆ©ç”¨httpåè®®ï¼Œèµ°1080ç«¯å£æœ¬åœ°ä»£ç†ã€‚</p>
<figure class="highlight zsh"><table><tr><td class="code"><pre><span class="line">sudo apt-get install proxychains</span><br></pre></td></tr></table></figure>
<p>å®ƒçš„é…ç½®æ–‡ä»¶åœ¨<br><figure class="highlight zsh"><table><tr><td class="code"><pre><span class="line">cat /etc/proxychains.conf</span><br></pre></td></tr></table></figure></p>
<p>å› ä¸ºwsl2çš„ipæ˜¯å˜åŒ–çš„ï¼Œhostçš„ipä¹Ÿæ˜¯å˜åŒ–çš„<br>æ‰€ä»¥è¦è®©<code>proxychains.conf</code>çš„ä»£ç†ä¿¡æ¯è‡ªåŠ¨å˜åŒ–</p>
<figure class="highlight zsh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/.zsh</span><br><span class="line">mkdir proxy</span><br><span class="line"><span class="built_in">cd</span> proxy</span><br><span class="line">vim proxy.sh</span><br></pre></td></tr></table></figure>
<p>è¾“å…¥ä»¥ä¸‹å†…å®¹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">export</span> HOSTIP=$(cat /etc/resolv.conf | grep <span class="string">'nameserver'</span> | cut -f 2 -d <span class="string">' '</span>)</span><br><span class="line"><span class="built_in">export</span> WSLIP=$(ip addr show eth0 | grep <span class="string">'inet '</span> | cut -f 6 -d <span class="string">' '</span> | cut -f 1 -d <span class="string">'/'</span>)</span><br><span class="line"><span class="built_in">echo</span> HOSTIP <span class="variable">$HOSTIP</span></span><br><span class="line"><span class="built_in">echo</span> WSLIP <span class="variable">$WSLIP</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Your password | sudo -S sed -i <span class="string">"/http/c http\t<span class="variable">$HOSTIP</span> 1080"</span> /etc/proxychains.conf</span><br></pre></td></tr></table></figure>
<p>ä¿å­˜é€€å‡ºå</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>è¾“å…¥<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.zsh/proxy/proxy.sh</span><br></pre></td></tr></table></figure></p>
<p>ä»¥ååªè¦æƒ³è¦ä¸‹è½½æŸäº›å¤–ç½‘å†…å®¹å°±å¯ä»¥ç›´æ¥åœ¨å‰é¢åŠ <code>proxychains</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¾‹å¦‚</span></span><br><span class="line">sudo proxychains apt-get update</span><br><span class="line">sudo proxychains apt-get upgrade </span><br><span class="line">proxychian git <span class="built_in">clone</span> ......</span><br></pre></td></tr></table></figure>
<h4 id="Nodejs"><a href="#Nodejs" class="headerlink" title="Nodejs"></a>Nodejs</h4><p>æ–¹æ³•ä¸€ï¼šåˆ©ç”¨nå®‰è£…nodejs<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install nodejs</span><br><span class="line">sudo apt-get install npm</span><br><span class="line">sudo npm install -g npm</span><br><span class="line">sudo npm install -g n</span><br><span class="line">sudo n stable //ç¨³å®šç‰ˆ</span><br></pre></td></tr></table></figure></p>
<p>æ–¹æ³•äºŒï¼šåˆ©ç”¨nvmç®¡ç†nodejs</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">curl -o- https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;nvm-sh&#x2F;nvm&#x2F;v0.34.0&#x2F;install.sh | bash</span><br></pre></td></tr></table></figure>
<p>ä¹‹åé‡å¯<code>wt</code></p>
<p>è¾“å…¥<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">command</span> -v nvm</span><br><span class="line"><span class="comment"># return nvm</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…node</span></span><br><span class="line">nvm install node <span class="comment"># æœ€æ–°ç‰ˆæœ¬</span></span><br><span class="line">nvm use node</span><br></pre></td></tr></table></figure></p>
<h4 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ›´æ–°ç´¢å¼•åŒ…ä¾èµ–</span></span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install apt-transport-https ca-certificates curl software-properties-common</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ å®˜æ–¹çš„GPG-key</span></span><br><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># éªŒè¯</span></span><br><span class="line">sudo apt-key fingerprint 0EBFCD88</span><br><span class="line"><span class="comment"># ç­”æ¡ˆ 9DC8 5822 9FC7 DD38 854A E2D8 8D81 803C 0EBF CD88</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ  Docker repository </span></span><br><span class="line">sudo add-apt-repository <span class="string">"deb [arch=amd64] https://download.docker.com/linux/ubuntu <span class="variable">$(lsb_release -cs)</span> stable"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…</span></span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install docker-ce</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨docker</span></span><br><span class="line">sudo service docker start</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•docker</span></span><br><span class="line">sudo docker run hello-world</span><br></pre></td></tr></table></figure>
<h4 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker Compose"></a>Docker Compose</h4><p>dockerå®¹å™¨çš„ç®¡ç†å·¥å…·ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½å½“å‰çš„ç¨³å®šå‘è¡Œç‰ˆå¹¶å°†å…¶æ”¾åœ¨/usr/local/binä¸‹ã€‚</span></span><br><span class="line">sudo curl -L <span class="string">"https://github.com/docker/compose/releases/download/1.24.0/docker-compose-<span class="variable">$(uname -s)</span>-<span class="variable">$(uname -m)</span>"</span> -o /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹æƒé™</span></span><br><span class="line">sudo chmod +x /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•</span></span><br><span class="line">docker-compose --version</span><br></pre></td></tr></table></figure>
<h4 id="Docker-Desktop"><a href="#Docker-Desktop" class="headerlink" title="Docker Desktop"></a>Docker Desktop</h4><p>åœ¨windowsä¸Šä¸‹è½½<br><a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="noopener">Docker Desktop</a></p>
<p>æä¾›äº†dockerçš„gui</p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/wsl2-wt-zsh-docker-docker-desktop.png" alt="docker-desktop"></p>
<h3 id="è¿æ¥vscode"><a href="#è¿æ¥vscode" class="headerlink" title="è¿æ¥vscode"></a>è¿æ¥vscode</h3><p>è¯·å…ˆä¸‹è½½vscodeå®‰è£…æ’ä»¶ï¼š<code>remote-wsl</code>å’Œ<code>terminal</code>ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/wsl2-wt-zsh-docker-remote-wsl.png" alt="remote-wsl"><br><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/wsl2-wt-zsh-docker-terminal-plugin.png" alt="terminal-plugin"></p>
<p>è¿™æ ·ä½ å°±å¯ä»¥é€šè¿‡ç‚¹å‡»<img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/wsl2-wt-zsh-docker-connection.png" alt="">è¿æ¥wsl</p>
<p>é€šè¿‡<code>ctrl+p</code>è¾“å…¥terminalï¼Œé€‰æ‹©æ‰“å¼€ä¸€ä¸ªå†…éƒ¨çš„teriminalã€‚å°±å¯ä»¥äº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/charstal/images/hexo/wsl2-wt-zsh-docker-vscode-shell.png" alt=""></p>
<p>ä¿®æ”¹é»˜è®¤çš„shellä¸ºzshã€‚</p>
<h4 id="å­—ä½“é—®é¢˜"><a href="#å­—ä½“é—®é¢˜" class="headerlink" title="å­—ä½“é—®é¢˜"></a>å­—ä½“é—®é¢˜</h4><p>ä½ å¯èƒ½ä¼šé‡åˆ°æŸäº›å­—æ— æ³•æ­£å¸¸æ˜¾ç¤ºã€‚</p>
<p>ä¸‹è½½<a href="https://github.com/powerline/fonts/blob/master/DejaVuSansMono/DejaVu%20Sans%20Mono%20for%20Powerline.ttf" target="_blank" rel="noopener">DejaVuSansMono</a>ï¼Œå¹¶å®‰è£…ã€‚</p>
<p>åŒæ—¶åœ¨vscodeçš„è®¾ç½®ä¸­ï¼Œå°†terminalçš„å­—ä½“é€‰æ‹©ä¸ºè¿™ä¸ªåå­—ã€‚</p>
<h3 id="windows-terminal"><a href="#windows-terminal" class="headerlink" title="windows terminal"></a>windows terminal</h3><p>è¿™ä¸ªæ˜¯æˆ‘çš„é…ç½®ï¼Œä¸åšè¿‡å¤šä»‹ç»äº†<br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// This file was initially generated by Windows Terminal 1.0.1401.0</span></span><br><span class="line"><span class="comment">// It should still be usable in newer versions, but newer versions might have additional</span></span><br><span class="line"><span class="comment">// settings, help text, or changes that you will not see unless you clear this file</span></span><br><span class="line"><span class="comment">// and let us generate a new one for you.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// To view the default settings, hold "alt" while clicking on the "Settings" button.</span></span><br><span class="line"><span class="comment">// For documentation on these settings, see: https://aka.ms/terminal-documentation</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"$schema"</span>: <span class="string">"https://aka.ms/terminal-profiles-schema"</span>,</span><br><span class="line">    </span><br><span class="line">    <span class="attr">"defaultProfile"</span>: <span class="string">"&#123;c6eaf9f4-32a7-5fdc-b5cf-066e8a4b1e40&#125;"</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// You can add more global application settings here.</span></span><br><span class="line">    <span class="comment">// To learn more about global settings, visit https://aka.ms/terminal-global-settings</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// If enabled, selections are automatically copied to your clipboard.</span></span><br><span class="line">    <span class="attr">"copyOnSelect"</span>: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If enabled, formatted data is also copied to your clipboard</span></span><br><span class="line">    <span class="attr">"copyFormatting"</span>: <span class="literal">false</span>,</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// A profile specifies a command to execute paired with information about how it should look and feel.</span></span><br><span class="line">    <span class="comment">// Each one of them will appear in the 'New Tab' dropdown,</span></span><br><span class="line">    <span class="comment">//   and can be invoked from the commandline with `wt.exe -p xxx`</span></span><br><span class="line">    <span class="comment">// To learn more about profiles, visit https://aka.ms/terminal-profile-settings</span></span><br><span class="line">    <span class="attr">"profiles"</span>:</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"defaults"</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"fontFace"</span>: <span class="string">"DejaVu Sans Mono for Powerline"</span>,</span><br><span class="line">            <span class="attr">"acrylicOpacity"</span>: <span class="number">0.8</span>, <span class="comment">//èƒŒæ™¯é€æ˜åº¦</span></span><br><span class="line">            <span class="attr">"useAcrylic"</span>: <span class="literal">true</span>, <span class="comment">// å¯ç”¨æ¯›ç»ç’ƒ</span></span><br><span class="line">            <span class="comment">// "backgroundImage": "D:\\OneDrive\\å›¾ç‰‡\\stack.jpg", //èƒŒæ™¯å›¾ç‰‡</span></span><br><span class="line">            <span class="comment">// "backgroundImageOpacity": 0.5, //å›¾ç‰‡é€æ˜åº¦</span></span><br><span class="line">            <span class="comment">// "backgroundImageStretchMode": "fill", //å¡«å……æ¨¡å¼</span></span><br><span class="line">            <span class="comment">// "icon": "ms-appx:///ProfileIcons/&#123;9acb9455-ca41-5af7-950f-6bca1bc9722f&#125;.png", //å›¾æ ‡</span></span><br><span class="line">            <span class="attr">"fontSize"</span>: <span class="number">10</span>, <span class="comment">//æ–‡å­—å¤§å°</span></span><br><span class="line">            <span class="attr">"colorScheme"</span>: <span class="string">"Solarized Dark"</span>, <span class="comment">//ä¸»é¢˜</span></span><br><span class="line">            <span class="attr">"cursorColor"</span>: <span class="string">"#FFFFFF"</span>, <span class="comment">//å…‰æ ‡é¢œè‰²</span></span><br><span class="line">            <span class="attr">"cursorShape"</span>: <span class="string">"bar"</span> <span class="comment">//å…‰æ ‡å½¢çŠ¶</span></span><br><span class="line">            <span class="comment">// "startingDirectory":"D://Projects//" //èµ·å§‹ç›®å½•</span></span><br><span class="line">            <span class="comment">// Put settings here that you want to apply to all profiles.</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"list"</span>:</span><br><span class="line">        [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// Make changes here to the powershell.exe profile.</span></span><br><span class="line">                <span class="attr">"guid"</span>: <span class="string">"&#123;61c54bbd-c2c6-5271-96e7-009a87ff44bf&#125;"</span>,</span><br><span class="line">                <span class="attr">"name"</span>: <span class="string">"Windows PowerShell"</span>,</span><br><span class="line">                <span class="attr">"commandline"</span>: <span class="string">"powershell.exe"</span>,</span><br><span class="line">                <span class="attr">"hidden"</span>: <span class="literal">false</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// Make changes here to the cmd.exe profile.</span></span><br><span class="line">                <span class="attr">"guid"</span>: <span class="string">"&#123;0caa0dad-35be-5f56-a8ff-afceeeaa6101&#125;"</span>,</span><br><span class="line">                <span class="attr">"name"</span>: <span class="string">"å‘½ä»¤æç¤ºç¬¦"</span>,</span><br><span class="line">                <span class="attr">"commandline"</span>: <span class="string">"cmd.exe"</span>,</span><br><span class="line">                <span class="attr">"hidden"</span>: <span class="literal">false</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"guid"</span>: <span class="string">"&#123;c6eaf9f4-32a7-5fdc-b5cf-066e8a4b1e40&#125;"</span>,</span><br><span class="line">                <span class="attr">"hidden"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"name"</span>: <span class="string">"Ubuntu-18.04"</span>,</span><br><span class="line">                <span class="attr">"source"</span>: <span class="string">"Windows.Terminal.Wsl"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"guid"</span>: <span class="string">"&#123;b453ae62-4e3d-5e58-b989-0a998ec441b8&#125;"</span>,</span><br><span class="line">                <span class="attr">"hidden"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"name"</span>: <span class="string">"Azure Cloud Shell"</span>,</span><br><span class="line">                <span class="attr">"source"</span>: <span class="string">"Windows.Terminal.Azure"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"guid"</span>: <span class="string">"&#123;07b52e3e-de2c-5db4-bd2d-ba144ed6c273&#125;"</span>,</span><br><span class="line">                <span class="attr">"hidden"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"name"</span>: <span class="string">"Ubuntu-20.04"</span>,</span><br><span class="line">                <span class="attr">"source"</span>: <span class="string">"Windows.Terminal.Wsl"</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add custom color schemes to this array.</span></span><br><span class="line">    <span class="comment">// To learn more about color schemes, visit https://aka.ms/terminal-color-schemes</span></span><br><span class="line">    <span class="attr">"schemes"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"Solarized Dark"</span>,</span><br><span class="line">            <span class="attr">"black"</span>: <span class="string">"#002831"</span>,</span><br><span class="line">            <span class="attr">"red"</span>: <span class="string">"#d11c24"</span>,</span><br><span class="line">            <span class="attr">"green"</span>: <span class="string">"#738a05"</span>,</span><br><span class="line">            <span class="attr">"yellow"</span>: <span class="string">"#a57706"</span>,</span><br><span class="line">            <span class="attr">"blue"</span>: <span class="string">"#2176c7"</span>,</span><br><span class="line">            <span class="attr">"purple"</span>: <span class="string">"#c61c6f"</span>,</span><br><span class="line">            <span class="attr">"cyan"</span>: <span class="string">"#259286"</span>,</span><br><span class="line">            <span class="attr">"white"</span>: <span class="string">"#eae3cb"</span>,</span><br><span class="line">            <span class="attr">"brightBlack"</span>: <span class="string">"#475b62"</span>,</span><br><span class="line">            <span class="attr">"brightRed"</span>: <span class="string">"#bd3613"</span>,</span><br><span class="line">            <span class="attr">"brightGreen"</span>: <span class="string">"#475b62"</span>,</span><br><span class="line">            <span class="attr">"brightYellow"</span>: <span class="string">"#536870"</span>,</span><br><span class="line">            <span class="attr">"brightBlue"</span>: <span class="string">"#708284"</span>,</span><br><span class="line">            <span class="attr">"brightPurple"</span>: <span class="string">"#5956ba"</span>,</span><br><span class="line">            <span class="attr">"brightCyan"</span>: <span class="string">"#819090"</span>,</span><br><span class="line">            <span class="attr">"brightWhite"</span>: <span class="string">"#fcf4dc"</span>,</span><br><span class="line">            <span class="attr">"background"</span>: <span class="string">"#001e27"</span>,</span><br><span class="line">            <span class="attr">"foreground"</span>: <span class="string">"#708284"</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"Solarized Darcula"</span>,</span><br><span class="line">            <span class="attr">"black"</span>: <span class="string">"#25292a"</span>,</span><br><span class="line">            <span class="attr">"red"</span>: <span class="string">"#f24840"</span>,</span><br><span class="line">            <span class="attr">"green"</span>: <span class="string">"#629655"</span>,</span><br><span class="line">            <span class="attr">"yellow"</span>: <span class="string">"#b68800"</span>,</span><br><span class="line">            <span class="attr">"blue"</span>: <span class="string">"#2075c7"</span>,</span><br><span class="line">            <span class="attr">"purple"</span>: <span class="string">"#797fd4"</span>,</span><br><span class="line">            <span class="attr">"cyan"</span>: <span class="string">"#15968d"</span>,</span><br><span class="line">            <span class="attr">"white"</span>: <span class="string">"#d2d8d9"</span>,</span><br><span class="line">            <span class="attr">"brightBlack"</span>: <span class="string">"#25292a"</span>,</span><br><span class="line">            <span class="attr">"brightRed"</span>: <span class="string">"#f24840"</span>,</span><br><span class="line">            <span class="attr">"brightGreen"</span>: <span class="string">"#629655"</span>,</span><br><span class="line">            <span class="attr">"brightYellow"</span>: <span class="string">"#b68800"</span>,</span><br><span class="line">            <span class="attr">"brightBlue"</span>: <span class="string">"#2075c7"</span>,</span><br><span class="line">            <span class="attr">"brightPurple"</span>: <span class="string">"#797fd4"</span>,</span><br><span class="line">            <span class="attr">"brightCyan"</span>: <span class="string">"#15968d"</span>,</span><br><span class="line">            <span class="attr">"brightWhite"</span>: <span class="string">"#d2d8d9"</span>,</span><br><span class="line">            <span class="attr">"background"</span>: <span class="string">"#3d3f41"</span>,</span><br><span class="line">            <span class="attr">"foreground"</span>: <span class="string">"#d2d8d9"</span></span><br><span class="line">          &#125;        </span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add custom keybindings to this array.</span></span><br><span class="line">    <span class="comment">// To unbind a key combination from your defaults.json, set the command to "unbound".</span></span><br><span class="line">    <span class="comment">// To learn more about keybindings, visit https://aka.ms/terminal-keybindings</span></span><br><span class="line">    <span class="attr">"keybindings"</span>:</span><br><span class="line">    [</span><br><span class="line">        <span class="comment">// Copy and paste are bound to Ctrl+Shift+C and Ctrl+Shift+V in your defaults.json.</span></span><br><span class="line">        <span class="comment">// These two lines additionally bind them to Ctrl+C and Ctrl+V.</span></span><br><span class="line">        <span class="comment">// To learn more about selection, visit https://aka.ms/terminal-selection</span></span><br><span class="line">        &#123; <span class="attr">"command"</span>: &#123;<span class="attr">"action"</span>: <span class="string">"copy"</span>, <span class="attr">"singleLine"</span>: <span class="literal">false</span> &#125;, <span class="attr">"keys"</span>: <span class="string">"ctrl+c"</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">"command"</span>: <span class="string">"paste"</span>, <span class="attr">"keys"</span>: <span class="string">"ctrl+v"</span> &#125;,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Press Ctrl+Shift+F to open the search box</span></span><br><span class="line">        &#123; <span class="attr">"command"</span>: <span class="string">"find"</span>, <span class="attr">"keys"</span>: <span class="string">"ctrl+shift+f"</span> &#125;,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Press Alt+Shift+D to open a new pane.</span></span><br><span class="line">        <span class="comment">// - "split": "auto" makes this pane open in the direction that provides the most surface area.</span></span><br><span class="line">        <span class="comment">// - "splitMode": "duplicate" makes the new pane use the focused pane's profile.</span></span><br><span class="line">        <span class="comment">// To learn more about panes, visit https://aka.ms/terminal-panes</span></span><br><span class="line">        &#123; <span class="attr">"command"</span>: &#123; <span class="attr">"action"</span>: <span class="string">"splitPane"</span>, <span class="attr">"split"</span>: <span class="string">"auto"</span>, <span class="attr">"splitMode"</span>: <span class="string">"duplicate"</span> &#125;, <span class="attr">"keys"</span>: <span class="string">"alt+shift+d"</span> &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://nickymeuleman.netlify.app/blog/linux-on-windows-wsl2-zsh-docker#powerline-fonts" target="_blank" rel="noopener">WSL2, zsh, and docker. Linux through Windows.</a><br><a href="https://www.oyohyee.com/post/note_wsl2_net" target="_blank" rel="noopener">WSL2ä¸­è‡ªåŠ¨é…ç½®Windows IPåœ°å€</a><br><a href="https://docs.microsoft.com/zh-cn/windows/wsl/install-win10#update-to-wsl-2" target="_blank" rel="noopener">é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿå®‰è£…æŒ‡å— (Windows 10)</a></p>
]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>wsl2</tag>
        <tag>zsh</tag>
        <tag>wt</tag>
      </tags>
  </entry>
</search>
